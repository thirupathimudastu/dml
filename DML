					FACT TABLES
FACT_ORDER_LINE_CHRG_SQL_IN1563
SELECT * FROM FACT_ORDER_LINE_CHRG_SQL_IN1563

INSERT INTO FACT_ORDER_LINE_CHRG_SQL_IN1563
SELECT
IIF(SALES_ORDER_NUM is null or SALES_ORDER_NUM =  'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM))AS BIGINT)) as SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM is null or SALES_ORDER_LINE_NUM =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) as SALES_ORDER_LINE_NUM,
IIF(a.TENANT_ORG_ID is null or a.TENANT_ORG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.TENANT_ORG_ID)))) as TENANT_ORG_ID,
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) as CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID is null or CHRG_CATEG_MAP_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(CHRG_CATEG_MAP_ID)))) as CHRG_CATEG_MAP_ID,
IIF(CHARGE_NM is null or CHARGE_NM =  'NULL','N/A',LTRIM(RTRIM(CHARGE_NM))) as CHARGE_NM,
IIF(CHARGE_AMT is null or CHARGE_AMT =  'NULL',0,CONVERT(DECIMAL(19,6),LTRIM(RTRIM(CHARGE_AMT)))) as CHARGE_AMT,
IIF(CHRG_CRE_DT is null or CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(CHRG_CRE_DT)))) as CHRG_CRE_DT,
IIF(CHRG_QTY is null or CHRG_QTY =  'NULL',0,CONVERT(INT,LTRIM(RTRIM(CHRG_QTY)))) as CHRG_QTY,
d.Day_key as CHRG_CRE_DT_KEY,
c.Charge_categ_key as Charge_categ_key 
from BCMPWMT.ORDER_LINE_CHRG a 
left join Dim_Day_SQL_IN1563 d on IIF(a.CHRG_CRE_DT is null or a.CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(a.CHRG_CRE_DT))))=d.Date_id
left join DIM_CHARGE_CATEG_SQL_IN1563 c on 
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) = c.CHARGE_CATEG_ID


SELECT * FROM Dim_Day_SQL_IN1563 WHERE DAY_KEY = 20096

SELECT * FROM [BCMPWMT].[ORDER_LINE_CHRG]
SELECT * FROM Dim_Day_SQL_IN1563
SELECT * FROM DIM_CHARGE_CATEG_SQL_IN1563

SELECT * FROM FACT_ORDER_LINE_CHRG_SQL_IN1563

Fact_sales_order_adj_SQL_IN1563
SELECT * FROM Fact_sales_order_adj_SQL_IN1563

INSERT INTO Fact_sales_order_adj_SQL_IN1563
SELECT 
IIF(ADJ_ID IS NULL OR ADJ_ID = 'NULL','N/A',CAST(LTRIM(RTRIM(ADJ_ID)) AS VARCHAR)),
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM)) AS BIGINT)) ADJ_ID,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_LINE_NUM)) AS INT)) SALES_ORDER_LINE_NUM,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) AS INT)) TENANT_ORG_ID ,
IIF(CHARGE_CATEG_ID IS NULL OR CHARGE_CATEG_ID = 'NULL',101,CAST(LTRIM(RTRIM(CHARGE_CATEG_ID)) AS INT)) CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID IS NULL OR CHRG_CATEG_MAP_ID = 'NULL' OR CHRG_CATEG_MAP_ID like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(CHRG_CATEG_MAP_ID)) AS INT)) CHRG_CATEG_MAP_ID,
IIF(CHRG_NM IS NULL OR CHRG_NM = 'NULL','N/A',CAST(LTRIM(RTRIM(CHRG_NM)) AS VARCHAR)) CHRG_NM,
IIF(RSN_CD IS NULL OR RSN_CD = 'NULL' OR RSN_CD like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RSN_CD)) AS INT)) RSN_CD ,
IIF(QTY IS NULL OR QTY = 'NULL' OR QTY like '%[a-zA-Z]%',0,CAST(LTRIM(RTRIM(QTY)) AS INT)) QTY,
IIF(ADJUSMENT_AMT is null OR ADJUSMENT_AMT =  'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(ADJUSMENT_AMT)))) as ADJUSMENT_AMT,
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS)))) ADJ_RPT_TS,
IIF(RTN_IND IS NULL OR RTN_IND = 'NULL' OR RTN_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RTN_IND)) AS INT)) RTN_IND,
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS)))) RTN_TS,
IIF(XCHNG_IND IS NULL OR XCHNG_IND = 'NULL' OR XCHNG_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(XCHNG_IND)) AS INT)) XCHNG_IND,
IIF(d.Day_Key IS NULL,-1,d.Day_Key)  AS  ADJ_RPT_TS_KEY,
IIF(d1.Day_Key IS NULL,-1,d1.Day_Key) AS RTN_TS_KEY,
IIF(d2.Day_Key IS NULL,-1,d2.Day_Key)  AS RFND_TS_KEY,
IIF(RFND_TS IS NULL OR RFND_TS LIKE 'NULL','01/01/1900 00:00:00',CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS)))) RFND_TS 
FROM [BCMPWMT].[SALES_ORDER_ADJ] A LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D
ON IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ADJ_RPT_TS)))) = D.DATE_ID AND
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS))))) = D.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D1 ON IIF(RTN_TS IS NULL OR RTN_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RTN_TS)))) = D1.DATE_ID AND
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS))))) = D1.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D2 ON IIF(RFND_TS IS NULL OR RFND_TS = 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RFND_TS)))) = D2.DATE_ID AND
IIF(RFND_TS IS NULL OR RFND_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS))))) = D2.HOUR_ID

SELECT * FROM [BCMPWMT].[SALES_ORDER_ADJ]
SELECT * FROM Dim_Day_SQL_IN1563
SELECT * FROM DIM_DAY_HOUR_SQL_IN1563
SELECT * FROM Fact_sales_order_adj_SQL_IN1563
SELECT * FROM DIM_CHARGE_CATEG_SQL_IN1563

alter TABLE Fact_sales_order_adj_SQL_IN1563 add charge_categ_key INT
alter TABLE Fact_sales_order_adj_SQL_IN1563 add Rsn_cd_KEY INT

UPDATE Fact_sales_order_adj_SQL_IN1563 SET charge_categ_key=D.[CHARGE_CATEG_KEY]
FROM Fact_sales_order_adj_SQL_IN1563 F LEFT JOIN DIM_CHARGE_CATEG_SQL_IN1563 D ON
D.CHARGE_CATEG_ID=F.CHARGE_CATEG_ID

UPDATE Fact_sales_order_adj_SQL_IN1563 SET RSN_CD_KEY=D.RSN_KEY
FROM Fact_sales_order_adj_SQL_IN1563 F LEFT JOIN dim_RSN_LKP_SQL_IN1563 D ON
D.RSN_CD=F.RSN_CD

Fact_sales_order_SQL_IN1563


INSERT INTO Fact_sales_order_SQL_IN1563
SELECT
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(ORDER_REL_TS IS NULL OR ORDER_REL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_REL_TS)))) ORDER_REL_TS,
IIF(ORDER_REL_DT IS NULL OR ORDER_REL_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_REL_DT)))) ORDER_REL_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(TOT_AMT IS NULL OR TOT_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TOT_AMT)))) TOT_AMT,
IIF(TAX_AMT IS NULL OR TAX_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TAX_AMT)))) TAX_AMT,
IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) CURR_STS_ID,
IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) BILL_TO_ADDR_ID,
IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) BILL_TO_CUST_ID,
IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) CUST_CNTCT_ID,
IIF(GUEST_ORDER_IND IS NULL OR GUEST_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GUEST_ORDER_IND)))) GUEST_ORDER_IND,
IIF(CORP_ORDER_IND IS NULL OR CORP_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CORP_ORDER_IND)))) CORP_ORDER_IND,
IIF(DEVICE_TYPE IS NULL OR DEVICE_TYPE LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEVICE_TYPE)))) DEVICE_TYPE,
IIF(IP_ADDR IS NULL OR IP_ADDR LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(IP_ADDR)))) IP_ADDR,
IIF(FRAUD_CHECK_REQD_IND IS NULL OR FRAUD_CHECK_REQD_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(FRAUD_CHECK_REQD_IND)))) FRAUD_CHECK_REQD_IND,
IIF(ORIG_SALES_ORDER_NUM IS NULL OR ORIG_SALES_ORDER_NUM LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ORIG_SALES_ORDER_NUM)))) ORIG_SALES_ORDER_NUM,
IIF(HOLD_FLAG IS NULL OR HOLD_FLAG LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(HOLD_FLAG)))) HOLD_FLAG,
IIF(XCHNG_TYPE_ID IS NULL OR XCHNG_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(XCHNG_TYPE_ID)))) XCHNG_TYPE_ID,
IIF(ORDER_TYPE_ID IS NULL OR ORDER_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORDER_TYPE_ID)))) ORDER_TYPE_ID,
IIF(WM_STORE_ORG_ID IS NULL OR WM_STORE_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(WM_STORE_ORG_ID)))) WM_STORE_ORG_ID,
-1 AS ORDER_REL_TS_KEY,
-1 AS ORDER_REL_DT_KEY,
-1 AS ORDER_PLACED_TS_KEY,
-1 AS ORDER_PLACED_DT_KEY,
ISNULL(B.STS_ID,-1) CURR_STS_ID_KEY,
ISNULL(C.ADDR_ID, -1) BILL_TO_ADDR_ID_KEY,
ISNULL(D.ADDR_ID,-1) BILL_TO_CUST_ID_KEY,
ISNULL(E.CNTCT_ID,-1) CUST_CNTCT_ID_KEY
FROM [BCMPWMT].[SALES_ORDER] A
LEFT JOIN [IN1563].[DIM_STS_LKP_SQL_IN1563]	B ON IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) = CONVERT(INT,B.STS_ID)
LEFT JOIN [IN1563].[dim_cust_address_SQL_IN1563] C ON IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) = CONVERT(VARCHAR,C.ADDR_ID)
LEFT JOIN [IN1563].[dim_cust_addr1_SQL_IN1563] D ON IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) = CONVERT(VARCHAR,D.ADDR_ID)
LEFT JOIN [IN1563].[DIM_CUST_CNTCT_SQL_IN1563] E ON IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) = CONVERT(VARCHAR,E.CNTCT_ID)

SELECT * FROM Fact_sales_order_SQL_IN1563		
SELECT * FROM [BCMPWMT].[SALES_ORDER]
SELECT * FROM [IN1563].[DIM_STS_LKP_SQL_IN1563]	
SELECT * FROM [IN1563].[dim_cust_address_SQL_IN1563]	
SELECT * FROM [IN1563].[dim_cust_addr1_SQL_IN1563]
SELECT * FROM [IN1563].[DIM_CUST_CNTCT_SQL_IN1563]
SELECT * FROM Dim_Day_SQL_IN1563
SELECT * FROM DIM_DAY_HOUR_SQL_IN1563


UPDATE Fact_sales_order_SQL_IN1563 SET ORDER_REL_TS_KEY = DH.Day_hour_key 
FROM Fact_sales_order_SQL_IN1563 F JOIN DIM_DAY_HOUR_SQL_IN1563 DH ON
CONVERT(DATE,F.ORDER_REL_TS)=DH.DATE_ID
 AND
DH.hour_id = DATEPART(HOUR,F.ORDER_REL_TS)


UPDATE Fact_sales_order_SQL_IN1563 SET ORDER_PLACED_TS_KEY= DH.Day_hour_key 
FROM Fact_sales_order_SQL_IN1563 F JOIN DIM_DAY_HOUR_SQL_IN1563 DH ON
CONVERT(DATE,F.ORDER_PLACED_TS)=DH.DATE_ID
AND
DH.hour_id = DATEPART(HOUR,F.ORDER_PLACED_TS)

UPDATE Fact_sales_order_SQL_IN1563 SET [ORDER_REL_DT_KEY]= DH.DAY_KEY
FROM Fact_sales_order_SQL_IN1563 F JOIN Dim_Day_SQL_IN1563 DH ON
CONVERT(DATE,F.[ORDER_REL_DT])=DH.DATE_ID


UPDATE Fact_sales_order_SQL_IN1563 SET [ORDER_PLACED_DT_KEY]= DH.DAY_KEY
FROM Fact_sales_order_SQL_IN1563 F JOIN Dim_Day_SQL_IN1563 DH ON
CONVERT(DATE,F.[ORDER_PLACED_DT])=DH.DATE_ID


FACT_sales_order_line_SQL_IN1563

INSERT INTO FACT_sales_order_line_SQL_IN1563
SELECT 
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) SALES_ORDER_LINE_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(SHIP_NODE_ORG_ID IS NULL OR SHIP_NODE_ORG_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_NODE_ORG_ID)))) SHIP_NODE_ORG_ID,
IIF(GIFT_IND IS NULL OR GIFT_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GIFT_IND)))) GIFT_IND,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(SVC_NM IS NULL OR SVC_NM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SVC_NM)))) SVC_NM,
IIF(UNIT_PRICE IS NULL OR UNIT_PRICE  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_PRICE)))) UNIT_PRICE,
IIF(UNIT_COST IS NULL OR UNIT_COST  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_COST)))) UNIT_COST,
IIF(QTY IS NULL OR QTY  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(QTY)))) QTY,
IIF(SHPD_QTY IS NULL OR SHPD_QTY LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHPD_QTY)))) SHPD_QTY,
IIF(SHIP_TO_ADDR_ID IS NULL OR SHIP_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_TO_ADDR_ID)))) SHIP_TO_ADDR_ID,
IIF(A.WM_ITEM_NUM IS NULL OR A.WM_ITEM_NUM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.WM_ITEM_NUM)))) WM_ITEM_NUM,
IIF(A.UPC IS NULL OR A.UPC LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.UPC)))) UPC,
IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID)))) CATLG_ITEM_ID,
IIF(PROD_OFFR_ID IS NULL OR PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_OFFR_ID)))) PROD_OFFR_ID,
IIF(RQ_CANCEL_TS IS NULL OR RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_CANCEL_TS)))) RQ_CANCEL_TS,
IIF(RQ_SHIP_TS IS NULL OR RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_SHIP_TS)))) RQ_SHIP_TS,
IIF(SLR_ORG_ID IS NULL OR SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SLR_ORG_ID)))) SLR_ORG_ID,
IIF(SHIP_TO_STORE_ORG_ID IS NULL OR SHIP_TO_STORE_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SHIP_TO_STORE_ORG_ID)))) SHIP_TO_STORE_ORG_ID,
IIF(ORDER_STS_ID IS NULL OR ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_STS_ID)))) ORDER_STS_ID,
IIF(PROD_CLASS_ID IS NULL OR PROD_CLASS_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_CLASS_ID)))) PROD_CLASS_ID,
IIF(MAX_DAYS_TO_SHIP IS NULL OR MAX_DAYS_TO_SHIP LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(MAX_DAYS_TO_SHIP)))) MAX_DAYS_TO_SHIP,
IIF(EARLIEST_DLVR_TS IS NULL OR EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(EARLIEST_DLVR_TS)))) EARLIEST_DLVR_TS,
IIF(ORIG_EXPC_DLVR_TS IS NULL OR ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORIG_EXPC_DLVR_TS)))) ORIG_EXPC_DLVR_TS,
IIF(CARRIER_EXPC_DLVR_TS IS NULL OR CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CARRIER_EXPC_DLVR_TS)))) CARRIER_EXPC_DLVR_TS,
IIF(PROMO_ID IS NULL OR PROMO_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROMO_ID)))) PROMO_ID,
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(FULFMT_TYPE_ID)))) FULFMT_TYPE_ID,
IIF(ORDER_LINE_TYPE_ID IS NULL OR ORDER_LINE_TYPE_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_LINE_TYPE_ID)))) ORDER_LINE_TYPE_ID,
IIF(LINE_TOT_AMT IS NULL OR LINE_TOT_AMT  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(LINE_TOT_AMT)))) LINE_TOT_AMT,
IIF(ORIG_SALES_ORDER_LINE_NUM IS NULL OR ORIG_SALES_ORDER_LINE_NUM  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORIG_SALES_ORDER_LINE_NUM)))) ORIG_SALES_ORDER_LINE_NUM,
IIF(PERISHABLE_IND IS NULL OR PERISHABLE_IND  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(PERISHABLE_IND)))) PERISHABLE_IND,
IIF(ITEM_CLASS_ID IS NULL OR ITEM_CLASS_ID  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ITEM_CLASS_ID)))) ITEM_CLASS_ID,
ISNULL(P.PROD_KEY,-1) CATLG_ITEM_KEY,
ISNULL(O.OFFR_KEY, -1) PROD_OFFR_KEY,
ISNULL(D.DAY_HOUR_KEY,-1) AS RQ_CANCEL_TS_KEY,
ISNULL(D1.DAY_HOUR_KEY,-1) AS RQ_SHIP_TS_KEY,
ISNULL(S.ORDER_STS_MASTER_ID,-1) AS ORDER_STS_KEY,
ISNULL(D2.DAY_HOUR_KEY, -1) AS EARLIEST_DLVR_TS_KEY,
ISNULL(D3.DAY_HOUR_KEY,-1) AS ORIG_EXPC_DLVR_TS_KEY,
ISNULL(D4.DAY_HOUR_KEY,-1) AS CARRIER_EXPC_DLVR_TS_KEY,
ISNULL(ORG.ORG_BUSINESS_UNIT_KEY,-1) AS SLR_ORG_KEY,
ISNULL(AD.CUST_AADR1_KEY,-1) AS SHIP_TO_STORE_KEY
FROM  [BCMPWMT].[SALES_ORDER_LINE] A
LEFT JOIN dim_prod_SQL_IN1563 P ON IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID))))  = P.CATLG_ITEM_ID
LEFT JOIN Dim_OFFR_SQL_IN1563 O ON IIF(A.PROD_OFFR_ID IS NULL OR A.PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.PROD_OFFR_ID)))) = O.OFFER_PK
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D ON IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))) = D.DATE_ID AND
D.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D1 ON  IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))) = D1.DATE_ID AND
D1.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))))
LEFT JOIN Dim_ORDER_STS_MASTER_LKP_SQL_IN1563 S ON IIF(A.ORDER_STS_ID IS NULL OR A.ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.ORDER_STS_ID)))) = S.ORDER_STS_MASTER_ID
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D2 ON CONVERT(DATE,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS))))) = D2.DATE_ID AND
D2.HOUR_ID = DATEPART(HOUR,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D3 ON CONVERT(DATE,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS))))) = D3.DATE_ID AND
D3.HOUR_ID = DATEPART(HOUR,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D4 ON CONVERT(DATE,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS))))) = D4.DATE_ID AND
D4.HOUR_ID = DATEPART(HOUR,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS)))))
LEFT JOIN DIM_ORG_BUSINESS_UNIT_SQL_IN1563 ORG ON IIF(A.SLR_ORG_ID IS NULL OR A.SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.SLR_ORG_ID)))) = ORG.ORG_ID
LEFT JOIN dim_cust_addr1_SQL_IN1563 AD ON IIF(A.SHIP_TO_STORE_ORG_ID IS NULL OR A.SHIP_TO_STORE_ORG_ID  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(A.SHIP_TO_STORE_ORG_ID)))) = AD.ADDR_ID

SELECT * FROM dim_prod_SQL_IN1563
SELECT * FROM Dim_OFFR_SQL_IN1563
SELECT * FROM DIM_DAY_HOUR_SQL_IN1563
SELECT * FROM Dim_ORDER_STS_MASTER_LKP_SQL_IN1563
SELECT * FROM DIM_ORG_BUSINESS_UNIT_SQL_IN1563
SELECT * FROM dim_cust_addr1_SQL_IN1563

FACT_RTN_ORDER_LINE_SQL_IN1563
insert into FACT_RTN_ORDER_LINE_SQL_IN1563
select 
IIF((r.RTN_ORDER_NUM IS NULL OR r.RTN_ORDER_NUM='NULL' OR r.RTN_ORDER_NUM LIKE '%[A-Za-z]%'),'N/A',ltrim(rtrim(r.RTN_ORDER_NUM))) RTN_ORDER_NUM,
IIF((r.RTN_LINE_NUM IS NULL OR r.RTN_LINE_NUM='NULL'  OR r.RTN_LINE_NUM LIKE '%[A-Za-z]%'),'N/A',ltrim(rtrim(r.RTN_LINE_NUM))) RTN_LINE_NUM,
IIF((r.TENANT_ORG_ID IS NULL OR r.TENANT_ORG_ID='NULL' or r.TENANT_ORG_ID like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF((r.SALES_ORDER_NUM IS NULL OR r.SALES_ORDER_NUM='NULL' or r.SALES_ORDER_NUM like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.SALES_ORDER_NUM))as bigint))  SALES_ORDER_NUM,
IIF((r.SALES_ORDER_LINE_NUM IS NULL OR r.SALES_ORDER_LINE_NUM='NULL'  or r.SALES_ORDER_NUM like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.SALES_ORDER_LINE_NUM ))as int)) SALES_ORDER_LINE_NUM,
IIF((r.RCV_STORE_ORG_CD IS NULL OR r.RCV_STORE_ORG_CD='NULL' or RCV_STORE_ORG_CD='?'),'N/A',ltrim(rtrim(r.RCV_STORE_ORG_CD))) RCV_STORE_ORG_CD,
IIF((r.RTN_QTY IS NULL or r.RTN_QTY like '%[a-zA-Z]%'),0.00,cast(ltrim(rtrim(r.RTN_QTY))as float)) RTN_QTY,
IIF((r.VIRT_RTN_IND IS NULL OR r.VIRT_RTN_IND='NULL' OR r.VIRT_RTN_IND like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.VIRT_RTN_IND))as int)) VIRT_RTN_IND,
case 
when r.AFFIDAVIT_SIGNUP_TS like '%M%' and r.AFFIDAVIT_SIGNUP_TS != 'AFFIDAVIT_SIGNUP_TS' then cast(substring(r.AFFIDAVIT_SIGNUP_TS,1,len(r.AFFIDAVIT_SIGNUP_TS)-7) as datetime)
when r.AFFIDAVIT_SIGNUP_TS is null or r.AFFIDAVIT_SIGNUP_TS = 'AFFIDAVIT_SIGNUP_TS' or r.AFFIDAVIT_SIGNUP_TS='null' or r.AFFIDAVIT_SIGNUP_TS='?' then cast('1/1/1900' as datetime)
else cast(r.AFFIDAVIT_SIGNUP_TS as datetime)
end AFFIDAVIT_SIGNUP_TS,
IIF((r.ITEM_EXPC_BACK_FLAG IS NULL OR r.ITEM_EXPC_BACK_FLAG='NULL' OR r.ITEM_EXPC_BACK_FLAG like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.ITEM_EXPC_BACK_FLAG))as int)) ITEM_EXPC_BACK_FLAG,
case 
when r.RTN_LINE_MODFD_TS like '%M%' and r.RTN_LINE_MODFD_TS != 'RTN_LINE_MODFD_TS' then cast(substring(r.RTN_LINE_MODFD_TS,1,len(r.RTN_LINE_MODFD_TS)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_MODFD_TS = 'RTN_LINE_MODFD_TS' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_MODFD_TS as datetime)
end RTN_LINE_MODFD_TS,
case 
when r.RTN_LINE_CRE_DT like '%M%' and r.RTN_LINE_CRE_DT != 'RTN_LINE_CRE_DT' then cast(substring(r.RTN_LINE_CRE_DT,1,len(r.RTN_LINE_CRE_DT)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_CRE_DT = 'RTN_LINE_CRE_DT' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_DT as datetime)
end RTN_LINE_CRE_DT,
IIF((r.RFND_FLAG IS NULL OR r.RFND_FLAG='NULL' or r.RFND_FLAG like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.RFND_FLAG)))) RFND_FLAG,
IIF((r.RTN_RSN_CD IS NULL OR r.RTN_RSN_CD='NULL'),'N/A',ltrim(rtrim(r.RTN_RSN_CD))) RTN_RSN_CD,
IIF((r.LINE_TOT_AMT IS NULL OR r.LINE_TOT_AMT='NULL' or r.LINE_TOT_AMT like '%[a-zA-Z]%'),0.00,CONVERT(float,LTRIM(RTRIM(r.LINE_TOT_AMT)))) LINE_TOT_AMT,
IIF((r.OTHR_CHRG_AMT IS NULL OR r.OTHR_CHRG_AMT='NULL' or r.OTHR_CHRG_AMT like '%[a-zA-Z]%' or r.OTHR_CHRG_AMT='?'),0.00,CONVERT(float,LTRIM(RTRIM(r.OTHR_CHRG_AMT)))) OTHR_CHRG_AMT,
IIF((r.RTN_CENTER_ORG_CD IS NULL OR r.RTN_CENTER_ORG_CD='NULL' or  r.RTN_CENTER_ORG_CD like '%[a-zA-Z]%' or r.RTN_CENTER_ORG_CD='?'),101,CONVERT(int,LTRIM(RTRIM(r.RTN_CENTER_ORG_CD)))) RTN_CENTER_ORG_CD,
case 
when r.SRC_CRE_TS like '%M%' then cast(substring(r.SRC_CRE_TS,1,len(r.SRC_CRE_TS)-6) as datetime)
when r.SRC_CRE_TS is null or r.SRC_CRE_TS like 'SRC_CRE_TS' then '1/1/1900'
else cast(r.SRC_CRE_TS as datetime)
end SRC_CRE_TS,
case 
when r.SRC_UPD_TS like '%M%' then cast(substring(r.SRC_UPD_TS,1,len(r.SRC_UPD_TS)-7) as datetime)
when r.SRC_UPD_TS is null or r.SRC_UPD_TS like 'SRC_UPD_TS' then '1/1/1900'
else cast(r.SRC_UPD_TS as datetime)
end SRC_UPD_TS,
case 
when r.RTN_LINE_CRE_DT like '%M%' and r.RTN_LINE_CRE_DT != 'RTN_LINE_CRE_DT' then cast(substring(r.RTN_LINE_CRE_DT,1,len(r.RTN_LINE_CRE_DT)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_CRE_DT = 'RTN_LINE_CRE_DT' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_DT as datetime)
end RTN_LINE_CRE_DT,
IIF((r.CATLG_ITEM_ID IS NULL OR r.CATLG_ITEM_ID='NULL' or r.CATLG_ITEM_ID like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.CATLG_ITEM_ID)))) CATLG_ITEM_ID,
IIF((r.UNIT_PRICE IS NULL OR r.UNIT_PRICE='NULL' or r.UNIT_PRICE like '%[a-zA-Z]%'),0.00,CONVERT(float,LTRIM(RTRIM(r.UNIT_PRICE)))) UNIT_PRICE,
IIF((r.RTN_RSN_BUCKET IS NULL OR r.RTN_RSN_BUCKET='NULL'),'N/A',ltrim(rtrim(r.RTN_RSN_BUCKET))) RTN_RSN_BUCKET,
IIF((r.RDC_ORG_ID IS NULL OR r.RDC_ORG_ID='NULL' or r.RDC_ORG_ID like '%[a-zA-Z]%' or RDC_ORG_ID='?'),101.00,CONVERT(float,LTRIM(RTRIM(r.RDC_ORG_ID)))) RDC_ORG_ID,
IIF((r.ORDER_STS_ID IS NULL OR r.ORDER_STS_ID='NULL'  or r.ORDER_STS_ID like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.ORDER_STS_ID)))) ORDER_STS_ID,
IIF((s.STS_LKP_key IS NULL),-1,s.STS_LKP_key) STS_LKP_KEY,
IIF((p.PROD_KEY IS NULL),-1,p.PROD_KEY) PROD_KEY,
IIF((rl.rsn_key IS NULL),-1,rl.rsn_key) RSN_KEY,
IIF((d1.hour_key IS NULL ),-1,d1.hour_key) AFFIDAVIT_SIGNUP_TS_KEY,
IIF((d2.hour_key IS NULL),-1,d2.hour_key) RTN_LINE_MODFD_TS_KEY,
IIF((d3.hour_key IS NULL ),-1, d3.hour_key) RTN_LINE_CRE_TS_KEY,
IIF((d4.hour_key IS NULL),-1,d4.hour_key) RTN_LINE_CRE_DT_KEY
from [BCMPWMT].[RTN_ORDER_LINE] r
left join DIM_STS_LKP_SQL_IN1563 s
on IIF((r.ORDER_STS_ID IS NULL OR r.ORDER_STS_ID='NULL'  or r.ORDER_STS_ID like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.ORDER_STS_ID))))=s.sts_id
LEFT JOIN dim_prod_SQL_IN1563 P
on IIF((r.CATLG_ITEM_ID IS NULL OR r.CATLG_ITEM_ID='NULL' or r.CATLG_ITEM_ID like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.CATLG_ITEM_ID))))=P.CATLG_ITEM_ID
LEFT JOIN dim_RSN_LKP_SQL_IN1563 rl
on rl.rsn_id=IIF((r.RTN_RSN_CD IS NULL or RTN_RSN_CD like '%[a-zA-Z?]%' or RDC_ORG_ID='null'),101,ltrim(rtrim(r.RTN_RSN_CD)))
left join 
 DIM_DAY_HOUR_SQL_IN1563 d1
on convert(date,case 
when r.AFFIDAVIT_SIGNUP_TS like '%M%' and r.AFFIDAVIT_SIGNUP_TS != 'AFFIDAVIT_SIGNUP_TS' then cast(substring(r.AFFIDAVIT_SIGNUP_TS,1,len(r.AFFIDAVIT_SIGNUP_TS)-7) as datetime)
when r.AFFIDAVIT_SIGNUP_TS is null or r.AFFIDAVIT_SIGNUP_TS = 'AFFIDAVIT_SIGNUP_TS' or r.AFFIDAVIT_SIGNUP_TS='null' or r.AFFIDAVIT_SIGNUP_TS='?' then cast('1/1/1900' as datetime)
else cast(r.AFFIDAVIT_SIGNUP_TS as datetime)
end)=d1.DATE_ID
AND
d1.HOUR_ID = DATEPART(HOUR,case 
when r.AFFIDAVIT_SIGNUP_TS like '%M%' and r.AFFIDAVIT_SIGNUP_TS != 'AFFIDAVIT_SIGNUP_TS' then cast(substring(r.AFFIDAVIT_SIGNUP_TS,1,len(r.AFFIDAVIT_SIGNUP_TS)-7) as datetime)
when r.AFFIDAVIT_SIGNUP_TS is null or r.AFFIDAVIT_SIGNUP_TS = 'AFFIDAVIT_SIGNUP_TS' or r.AFFIDAVIT_SIGNUP_TS='null' or r.AFFIDAVIT_SIGNUP_TS='?' then cast('1/1/1900' as datetime)
else cast(r.AFFIDAVIT_SIGNUP_TS as datetime)
end)
left join 
 DIM_DAY_HOUR_SQL_IN1563 d2
on convert(date,case 
when r.RTN_LINE_MODFD_TS like '%M%' and r.RTN_LINE_MODFD_TS != 'RTN_LINE_MODFD_TS' then cast(substring(r.RTN_LINE_MODFD_TS,1,len(r.RTN_LINE_MODFD_TS)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_MODFD_TS = 'RTN_LINE_MODFD_TS' or r.RTN_LINE_MODFD_TS='null' or r.RTN_LINE_MODFD_TS='?' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_MODFD_TS as datetime)
end)=d2.DATE_ID
AND
d2.HOUR_ID = DATEPART(HOUR,case 
when r.RTN_LINE_MODFD_TS like '%M%' and r.RTN_LINE_MODFD_TS != 'RTN_LINE_MODFD_TS' then cast(substring(r.RTN_LINE_MODFD_TS,1,len(r.RTN_LINE_MODFD_TS)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_MODFD_TS = 'RTN_LINE_MODFD_TS' or r.RTN_LINE_MODFD_TS='null' or r.RTN_LINE_MODFD_TS='?' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_MODFD_TS as datetime)end)
left join DIM_DAY_HOUR_SQL_IN1563 d3
on convert(date,case 
when r.RTN_LINE_CRE_TS like '%M%' and r.RTN_LINE_CRE_TS != 'RTN_LINE_CRE_TS' then cast(substring(r.RTN_LINE_CRE_TS,1,len(r.RTN_LINE_CRE_TS)-7) as datetime)
when r.RTN_LINE_CRE_TS is null or r.RTN_LINE_CRE_TS = 'RTN_LINE_CRE_TS' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_TS as datetime)end)=d3.DATE_ID
AND
d3.HOUR_ID = DATEPART(HOUR,case 
when r.RTN_LINE_CRE_TS like '%M%' and r.RTN_LINE_CRE_TS != 'RTN_LINE_CRE_TS' then cast(substring(r.RTN_LINE_CRE_TS,1,len(r.RTN_LINE_CRE_TS)-7) as datetime)
when r.RTN_LINE_CRE_TS is null or r.RTN_LINE_CRE_TS = 'RTN_LINE_CRE_TS' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_TS as datetime)end)
left join 
DIM_DAY_HOUR_SQL_IN1563 d4
on convert(date,case 
when r.RTN_LINE_CRE_DT like '%M%' and r.RTN_LINE_CRE_DT != 'RTN_LINE_CRE_DT' then cast(substring(r.RTN_LINE_CRE_DT,1,len(r.RTN_LINE_CRE_DT)-7) as datetime)
when r.RTN_LINE_CRE_DT is null or r.RTN_LINE_CRE_DT = 'RTN_LINE_CRE_DT' or r.RTN_LINE_CRE_DT='null' or r.RTN_LINE_CRE_DT='?' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_DT as datetime)
end)=d4.DATE_ID
AND
d4.HOUR_ID = DATEPART(HOUR,case 
when r.RTN_LINE_CRE_DT like '%M%' and r.RTN_LINE_CRE_DT != 'RTN_LINE_CRE_DT' then cast(substring(r.RTN_LINE_CRE_DT,1,len(r.RTN_LINE_CRE_DT)-7) as datetime)
when r.RTN_LINE_CRE_DT is null or r.RTN_LINE_CRE_DT = 'RTN_LINE_CRE_DT' or r.RTN_LINE_CRE_DT='null' or r.RTN_LINE_CRE_DT='?' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_DT as datetime)
end)

select * from FACT_RTN_ORDER_LINE_SQL_IN1563



					DML
DIM_CHARGE_CATEG_SQL_IN1563
select * from [BCMPWMT].[CHARGE_CATEG_LKP]

insert into DIM_CHARGE_CATEG_SQL_IN1563
select 
IIF(CHARGE_CATEG_ID IS NULL,101,CAST(LTRIM(RTRIM(CHARGE_CATEG_ID))AS INT)),
IIF(TENANT_ORG_ID IS NULL, 101, cast(ltrim(rtrim(TENANT_ORG_ID))as int)),
IIF(charge_categ IS NULL,'N/A',IIF(LEN(ltrim(rtrim(charge_categ))) > 5, ltrim(rtrim(charge_categ)), UPPER(ltrim(rtrim(charge_categ))))),
IIF(charge_categ_desc IS NULL, 'N/A', ltrim(rtrim(charge_categ_desc))),
IIF(TAX_IND IS NULL,-1,CAST(TAX_IND AS INT)),
1 AS Version
from [BCMPWMT].[CHARGE_CATEG_LKP]


select * from DIM_CHARGE_CATEG_SQL_IN1563

dim_cust_SQL_IN1563
SELECT * FROM [BCMPWMT].[CUST]

INSERT INTO dim_cust_SQL_IN1563 
SELECT
IIF(cust_id IS NULL OR cust_id = 'NULL', 101,cast(ltrim(rtrim(cust_id)) as int)),
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(TENANT_ORG_ID))as int)),
IIF(cust_type_id IS NULL OR cust_type_id = 'NULL', 101, cast(ltrim(rtrim(cust_type_id)) as int)),
IIF(nickname IS NULL OR nickname = 'NULL', 'N/A', ltrim(rtrim(nickname))),
IIF(SALUTE IS NULL OR SALUTE = 'NULL','N/A', LTRIM(RTRIM(SUBSTRING(SRC_CUST_ID,1,4)))),
IIF(MIDDLE_NM IS NULL OR MIDDLE_NM = 'NULL','N/A',ltrim(rtrim(middle_nm))),
IIF(CUST_TITLE IS NULL OR CUST_TITLE = 'NULL','N/A',REPLACE(ltrim(rtrim(cust_title)),'#',' ')),
IIF(SUFFIX IS NULL OR SUFFIX = 'NULL','N/A', CONCAT(SUBSTRING(LOWER(SUFFIX),1,1),SUBSTRING(UPPER(SUFFIX),2,1),SUBSTRING(LOWER(SUFFIX),3,LEN(SUFFIX)))),
IIF(WM_EMPLOYEE_ID IS NULL OR WM_EMPLOYEE_ID = 'NULL','N/A', cast(ltrim(rtrim(wm_employee_id))as int)),
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1990',cast(ltrim(rtrim(cre_dt))as Date)),
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_user))),
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1990',cast(ltrim(rtrim(upd_ts))as datetime)), 
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',ltrim(rtrim(upd_user))),
GETDATE() AS StartDate,
NULL as EndDate,
IIF(SIGNUP_TS IS NULL OR SIGNUP_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(signup_ts))as datetime)),
IIF(REALM_ID IS NULL OR REALM_ID = 'NULL','N/A',ltrim(rtrim(realm_id))),
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL','N/A', ltrim(rtrim(valid_cust_ind))),
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL','N/A',ltrim(rtrim(deltd_yn)))
FROM [BCMPWMT].[CUST]

SELECT * FROM dim_cust_SQL_IN1563


dim_CUST_ACCT_SQL_IN1563

SELECT * FROM [BCMPWMT].[CUST_ACCT]

 INSERT INTO dim_CUST_ACCT_SQL_IN1563
 SELECT 
 IIF(ACCT_ID IS NULL OR ACCT_ID = 'NULL',101,cast(ltrim(rtrim(acct_id)) as bigint)),
IIF(CUST_ID IS NULL OR CUST_ID = 'NULL',101,cast(ltrim(rtrim(cust_id))as int)),
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,cast(ltrim(rtrim(tenant_org_id))as int)),
IIF(ACCT_STS_ID IS NULL OR ACCT_STS_ID = 'NULL',101,cast(ltrim(rtrim(acct_sts_id))as int)),
IIF(ACCT_TYPE_ID IS NULL OR ACCT_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(acct_type_id))as int)),
IIF(EMAIL IS NULL OR EMAIL = 'NULL','N/A',IIF(EMAIL LIKE '%@%',LTRIM(RTRIM(EMAIL)),'N/A')),
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL', 101,cast(ltrim(rtrim(valid_cust_ind))as int)),
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT)) as DATE)),
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_USER))),
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)),
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL', 'N/A' , ltrim(rtrim(upd_user))),
getdate() as StartDate,
NULL AS EndDate,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A',cast(ltrim(rtrim(DELTD_YN)) as char))
FROM [BCMPWMT].[CUST_ACCT]

SELECT * FROM dim_CUST_ACCT_SQL_IN1563

dim_cust_addr_zone_SQL_IN1563
select * from [BCMPWMT].[CUST_ADDR_ZONE]

insert into dim_cust_addr_zone_SQL_IN1563
select 
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID = 'NULL',101,cast(ltrim(rtrim(addr_zone_id))as int)),
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(tenant_org_id))as int)),
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',  101 , cast(ltrim(rtrim(data_src_id))as int)),
IIF(CITY IS NULL OR CITY = 'NULL', 'N/A'  , ltrim(rtrim(city))),
IIF(POSTAL_CD IS NULL OR POSTAL_CD = 'NULL', 'N/A', ltrim(rtrim(postal_cd))),
IIF(STATE IS NULL OR STATE = 'NULL', 'N/A'  ,ltrim(rtrim(state))),
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A'  , cast(ltrim(rtrim(deltd_yn))as varchar)),
IIF(CRE_USER IS NULL OR CRE_USER  = 'NULL', 'N/A'  , ltrim(rtrim(cre_user))),
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(cre_dt))as date)),
IIF(UPD_USER IS NULL OR UPD_USER= 'NULL', 'N/A'  ,ltrim(rtrim(upd_user)) ),
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(upd_ts))as datetime))
from [BCMPWMT].[CUST_ADDR_ZONE]


select * from dim_cust_addr_zone_SQL_IN1563


DIM_CUST_EMAIL_SQL_IN1563

select * from [BCMPWMT].[CUST_EMAIL]

insert into DIM_CUST_EMAIL_SQL_IN1563
select 
IIF(EMAIL_ID IS NULL OR EMAIL_ID = 'NULL',101 , cast(ltrim(rtrim(EMAIL_ID)) as bigint)),
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101 , cast(ltrim(rtrim(Tenant_Org_id)) as int)),
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101 , cast(ltrim(rtrim(cntct_type_id)) as int)),
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101 , cast(ltrim(rtrim(Data_src_id)) as int)),
IIF(DELTD_YN IS NULL OR DELTD_YN  = 'NULL','N/A', cast(ltrim(rtrim(Deltd_yn)) as varchar)),
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900' , cast(ltrim(rtrim(Cre_Dt))as Date)),
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900', cast(ltrim(rtrim(Upd_ts))as Date))
FROM [BCMPWMT].[CUST_EMAIL]

SELECT * FROM DIM_CUST_EMAIL_SQL_IN1563

DIM_CUST_PHONE_SQL_IN1563

SELECT * FROM [BCMPWMT].[CUST_PHONE]

INSERT INTO DIM_CUST_PHONE_SQL_IN1563
SELECT 
IIF(PHONE_ID IS NULL OR PHONE_ID = 'NULL',101, CAST(ltrim(rtrim(PHONE_ID)) as bigint)),
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CAST(ltrim(rtrim(TENANT_ORG_ID)) as int)),
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101, CAST(ltrim(rtrim(CNTCT_TYPE_ID)) as bigint)),
IIF(SRC_PHONE_ID IS NULL OR SRC_PHONE_ID = 'NULL','N/A', ltrim(rtrim(Src_phone_id))),
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101,cast(ltrim(rtrim(Data_src_id)) as int)),
IIF(AREA_CD IS NULL OR AREA_CD = 'NULL','N/A', ltrim(rtrim(AREA_CD))),
IIF(CNTRY_CD IS NULL OR CNTRY_CD = 'NULL','N/A', ltrim(rtrim(CNTRY_CD))),
IIF(EXTN IS NULL OR  EXTN = 'NULL','N/A', ltrim(rtrim(EXTN))),
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900', cast(ltrim(rtrim(CRE_DT))as Date)),
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A', cast(ltrim(rtrim(Deltd_yn)) as char)),
IIF(Upd_ts IS NULL OR Upd_ts = 'NULL', '01/01/1900', cast(ltrim(rtrim(Upd_ts))as Datetime))
FROM [BCMPWMT].[CUST_PHONE]

select * from DIM_CUST_PHONE_SQL_IN1563


Dim_FULFMT_TYPE_LKP_SQL_IN1563

SELECT * FROM [BCMPWMT].[FULFMT_TYPE_LKP]

INSERT INTO Dim_FULFMT_TYPE_LKP_SQL_IN1563
SELECT DISTINCT
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID = 'NULL',101,cast(ltrim(rtrim(FULFMT_TYPE_ID)) AS INT)),
IIF(FULFMT_TYPE_CD IS NULL OR  FULFMT_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_CD))),
IIF(FULFMT_TYPE_DESC IS NULL OR FULFMT_TYPE_DESC = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_DESC))),
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT ))AS DATE)),
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL',CAST('01/01/1900' AS NVARCHAR),CAST(FORMAT(CAST(UPD_TS AS DATETIME),'ddMMyyyy')AS NVARCHAR))
FROM [BCMPWMT].[FULFMT_TYPE_LKP]

SELECT * FROM Dim_FULFMT_TYPE_LKP_SQL_IN1563

Dim_ORG_TYPE_LKP_SQL_IN1563

SELECT * FROM [BCMPWMT].[ORG_TYPE_LKP]

INSERT INTO Dim_ORG_TYPE_LKP_SQL_IN1563
SELECT 
IIF(ORG_TYPE_ID IS NULL OR ORG_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORG_TYPE_ID)))),
IIF(ORG_TYPE_CD IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_CD))),
IIF(ORG_TYPE_DESC IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_DESC))),
IIF(ORG_TYPE_NM IS NULL OR ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(ORG_TYPE_NM))),
IIF(PARENT_ORG_TYPE_NM IS NULL OR PARENT_ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_NM))),
IIF(PARENT_ORG_TYPE_CD IS NULL OR PARENT_ORG_TYPE_CD ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_CD))),
IIF(CRE_DT IS NULL OR CRE_DT ='NULL','01/01/1900', CONVERT(DATE,LTRIM(RTRIM(CRE_DT)))),
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',LTRIM(RTRIM(CRE_USER))),
NULL AS History_1,
NULL AS History_2
FROM [BCMPWMT].[ORG_TYPE_LKP]


SELECT * FROM Dim_ORG_TYPE_LKP_SQL_IN1563


Dim_RSN_TYPE_LKP_SQL_IN1563

SELECT * FROM [BCMPWMT].[RSN_TYPE_LKP]

INSERT INTO Dim_RSN_TYPE_LKP_SQL_IN1563
SELECT
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(RSN_TYPE_ID)))),
IIF(RSN_TYPE_CD IS NULL OR RSN_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(RSN_TYPE_CD))),
IIF(RSN_TYPE_DESC IS NULL OR RSN_TYPE_DESC = 'NULL','N/A',  LTRIM(RTRIM(RSN_TYPE_DESC))),
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CRE_TS)))),
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A', LTRIM(RTRIM(CRE_USER)))
FROM [BCMPWMT].[RSN_TYPE_LKP]

SELECT * FROM Dim_RSN_TYPE_LKP_SQL_IN1563

dim_RSN_LKP_SQL_IN1563
select * from [BCMPWMT].[RSN_LKP]

INSERT INTO dim_RSN_LKP_SQL_IN1563
SELECT
IIF(RSN_ID IS NULL OR RSN_ID = 'NULL',101, cast(ltrim(rtrim(rsn_id)) as INT)),
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, cast(ltrim(rtrim(tenant_org_id))as INT)),
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id)) as INT)),
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id))as INT)),
IIF(RSN_CD IS NULL OR  RSN_CD = 'NULL' OR RSN_CD LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(rsn_cd))as int)),
IIF(SRC_RSN_ID IS NULL OR SRC_RSN_ID = 'NULL' OR SRC_RSN_ID LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(src_rsn_id))as INT)),
IIF(RSN_DESC IS NULL OR RSN_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_desc))),
IIF(RSN_LONG_DESC IS NULL OR RSN_LONG_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_long_desc))),
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_ts))as datetime)),
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CRE_USER),
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)),
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',UPD_USER)
FROM [BCMPWMT].[RSN_LKP]

SELECT * FROM dim_RSN_LKP_SQL_IN1563

dim_prod_SQL_IN1563

select * from [BCMPWMT].[PROD]

insert into dim_prod_SQL_IN1563
select 
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID)) as int)),
IIF(PRMRY_DSTRBTR_NM IS NULL OR PRMRY_DSTRBTR_NM = 'NULL','N/A',ltrim(rtrim(PRMRY_DSTRBTR_NM))),
IIF(PRMRY_VEND_NUM IS NULL OR  PRMRY_VEND_NUM = 'NULL',101,CAST(ltrim(rtrim(PRMRY_VEND_NUM)) AS INT)),
IIF(SRC_IMS_CRE_TS IS NULL OR SRC_IMS_CRE_TS = 'NULL','N/A',SRC_IMS_CRE_TS),
IIF(SRC_IMS_MODFD_TS IS NULL OR SRC_IMS_MODFD_TS = 'NULL','N/A',SRC_IMS_MODFD_TS),
IIF(VEND_PACK_QTY IS NULL OR VEND_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(VEND_PACK_QTY)) as int)),
IIF(WHSE_PACK_QTY IS NULL OR WHSE_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(WHSE_PACK_QTY)) as int)),
IIF(CURR_PRICE_MODFD_TS IS NULL OR CURR_PRICE_MODFD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(CURR_PRICE_MODFD_TS))as datetime)),
IIF(AMT_ITEM_COST IS NULL OR AMT_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(AMT_ITEM_COST))as decimal)),
IIF(AMT_BASE_ITEM_PRICE IS NULL OR AMT_BASE_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_ITEM_PRICE))as decimal)),
IIF(AMT_BASE_SUGG_PRICE IS NULL OR AMT_BASE_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_SUGG_PRICE))as decimal)),
IIF(AMT_SUGG_PRICE IS NULL OR AMT_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_SUGG_PRICE))as decimal)),
IIF(MIN_ITEM_COST IS NULL OR MIN_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(MIN_ITEM_COST))as decimal)),
IIF(ORIG_PRICE IS NULL OR ORIG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_PRICE))as decimal)),
IIF(ORIG_ITEM_PRICE IS NULL OR ORIG_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_ITEM_PRICE))as decimal)),
IIF(PROD_NM IS NULL OR PROD_NM = 'NULL','N/A',LTRIM(RTRIM(PROD_NM))),
IIF(PROD_HT IS NULL OR PROD_HT = 'NULL' OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_HT))as decimal)),
IIF(PROD_WT IS NULL OR PROD_WT = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WT))as decimal)),
IIF(PROD_LEN IS NULL OR PROD_LEN = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_LEN))as decimal)),
IIF(PROD_WDTH IS NULL OR PROD_WDTH = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WDTH))as decimal)),
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_dt))as date)),
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',cast(ltrim(rtrim(CRE_USER))as VARCHAR)),
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%','01/01/1900',cast(ltrim(rtrim(UPD_TS))as datetime)),
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',cast(ltrim(rtrim(UPD_USER))as VARCHAR))
FROM [BCMPWMT].[PROD]

SELECT * FROM dim_prod_SQL_IN1563

Dim_ORDER_STS_MASTER_LKP_SQL_IN1563

SELECT * FROM [BCMPWMT].[ORDER_STS_MASTER_LKP]

INSERT INTO Dim_ORDER_STS_MASTER_LKP_SQL_IN1563
SELECT 
IIF(ORDER_STS_MASTER_ID IS NULL OR ORDER_STS_MASTER_ID = 'NULL',101,cast(ltrim(rtrim(ORDER_STS_MASTER_ID)) AS bigint)) ORDER_STS_MASTER_ID,
IIF(ORDER_STS_MASTER_CD IS NULL OR ORDER_STS_MASTER_CD = 'NULL','N/A',LTRIM(RTRIM(ORDER_STS_MASTER_CD))) ORDER_STS_MASTER_CD,
IIF(ORDER_STS_SHORT_DESC IS NULL OR ORDER_STS_SHORT_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_SHORT_DESC))) ORDER_STS_SHORT_DESC,
IIF(ORDER_STS_LONG_DESC IS NULL OR ORDER_STS_LONG_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_LONG_DESC))) ORDER_STS_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(CRE_TS,1,CHARINDEX(' P',CRE_TS))))AS DATETIME)) CRE_TS,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(UPD_TS,1,CHARINDEX(' P',UPD_TS))))AS DATETIME)) UPD_TS
FROM [BCMPWMT].[ORDER_STS_MASTER_LKP]

SELECT * FROM Dim_ORDER_STS_MASTER_LKP_SQL_IN1563



Dim_OFFR_SQL_IN1563


select WM_ITEM_NUM from [BCMPWMT].[OFFR]

insert into Dim_OFFR_SQL_IN1563
select
	IIF(OFFER_PK IS NULL OR OFFER_PK = 'NULL','N/A',LTRIM(RTRIM(OFFER_PK))) OFFER_PK,
	IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,CAST(LTRIM(RTRIM(CATLG_ITEM_ID)) as bigint)) CATLG_ITEM_ID,
	IIF(SRC_ORG_CD IS NULL OR SRC_ORG_CD = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ORG_CD)) as bigint)) SRC_ORG_CD,
	IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) as bigint)) TENANT_ORG_ID,
	IIF(SRC_ITEM_KEY IS NULL OR SRC_ITEM_KEY = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ITEM_KEY)) as bigint)) SRC_ITEM_KEY,
	IIF(UPC IS NULL OR UPC = 'NULL','N/A',LTRIM(RTRIM(UPC))) UPC,
	IIF(WM_ITEM_NUM IS NULL OR WM_ITEM_NUM = 'NULL',101,CAST(LTRIM(RTRIM(WM_ITEM_NUM)) as bigint)) WM_ITEM_NUM,
	IIF(WM_UPC IS NULL OR WM_UPC = 'NULL','N/A',LTRIM(RTRIM(WM_UPC))) WM_UPC,
	IIF(OFFR_NM IS NULL OR OFFR_NM = 'NULL','N/A',LTRIM(RTRIM(OFFR_NM))) OFFR_NM,
	IIF(OFFR_START_TS IS NULL OR OFFR_START_TS = 'NULL' OR OFFR_START_TS LIKE '%[a-zA-Z]%','N/A',CAST(FORMAT(cast(OFFR_START_TS as datetime),'yyMMdd') AS NVARCHAR)) OFFR_START_TS,
	IIF(OFFR_START_DT IS NULL OR OFFR_START_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_START_DT))AS DATETIME)) OFFR_START_DT,
	IIF(OFFR_END_TS IS NULL OR OFFR_END_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_END_TS))AS DATETIME)) OFFR_END_TS,
	IIF(OFFR_TYPE_ID IS NULL OR OFFR_TYPE_ID = 'NULL','N/A',LTRIM(RTRIM(OFFR_TYPE_ID))) OFFR_TYPE_ID,
	IIF(COMM_PCT IS NULL OR COMM_PCT = 'NULL',101.00,cast(ltrim(rtrim(COMM_PCT))as decimal)) COMM_PCT,
	IIF(SLR_OFFR_ID IS NULL OR SLR_OFFR_ID = 'NULL','N/A',LTRIM(RTRIM(SLR_OFFR_ID))) SLR_OFFR_ID,
	IIF(PRTNR_ID IS NULL OR PRTNR_ID = 'NULL','N/A',LTRIM(RTRIM(PRTNR_ID))) PRTNR_ID,
	IIF(START_PRICE IS NULL OR START_PRICE = 'NULL' OR START_PRICE LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(START_PRICE))as decimal)) START_PRICE,
	IIF(LAST_PRICE_UPD_TS IS NULL OR LAST_PRICE_UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(LAST_PRICE_UPD_TS))AS DATETIME)) LAST_PRICE_UPD_TS,
	IIF(CURR_PRICE IS NULL OR CURR_PRICE = 'NULL' OR CURR_PRICE LIKE '%[a-zA-Z/]%',101.00,cast(ltrim(rtrim(CURR_PRICE))as decimal)) CURR_PRICE,
	IIF(CURR_SUGG_PRICE IS NULL OR CURR_SUGG_PRICE = 'NULL' OR CURR_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(CURR_SUGG_PRICE))as decimal)) CURR_SUGG_PRICE,
	IIF(BASE_ITEM_PRICE IS NULL OR BASE_ITEM_PRICE = 'NULL' OR BASE_ITEM_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_ITEM_PRICE))as decimal)) BASE_ITEM_PRICE,
	IIF(BASE_SUGG_PRICE IS NULL OR BASE_SUGG_PRICE = 'NULL' OR BASE_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_SUGG_PRICE))as decimal)) BASE_SUGG_PRICE,
	IIF(UOM IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(UOM))) UOM,
	IIF(TAXABLE_IND IS NULL OR TAXABLE_IND = 'NULL',101,CAST(CONVERT(FLOAT,LTRIM(RTRIM(TAXABLE_IND))) as int)) TAXABLE_IND,
	IIF(GIFT_WRAP_IND IS NULL OR GIFT_WRAP_IND = 'NULL',101,CAST(LTRIM(RTRIM(GIFT_WRAP_IND)) as int)) GIFT_WRAP_IND,
	IIF(SHIP_ALONE_IND IS NULL OR SHIP_ALONE_IND = 'NULL',101,CAST(LTRIM(RTRIM(SHIP_ALONE_IND)) as int)) SHIP_ALONE_IND,
	IIF(FREE_RETURNS_IND IS NULL OR FREE_RETURNS_IND = 'NULL',101,CAST(LTRIM(RTRIM(FREE_RETURNS_IND)) as int)) FREE_RETURNS_IND,
	IIF(SLR_UPC IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(SLR_UPC))) SLR_UPC,
	IIF(SHIPTOSTORE_IND IS NULL OR SHIPTOSTORE_IND = 'NULL' OR SHIPTOSTORE_IND LIKE '%[a-zA-Z/]%',101,CAST(LTRIM(RTRIM(SHIPTOSTORE_IND)) as bigint)) SHIPTOSTORE_IND,
	IIF(PIP_IND IS NULL OR PIP_IND = 'NULL',101,CAST(LTRIM(RTRIM(PIP_IND)) as int)) PIP_IND,
	IIF(PRE_ORDER_IND IS NULL OR PRE_ORDER_IND = 'NULL',101,CAST(LTRIM(RTRIM(PRE_ORDER_IND)) as int)) PRE_ORDER_IND,
	IIF(CRE_DT IS NULL OR CRE_DT = 'NULL' OR CRE_DT LIKE '%[a-zA-Z]%' OR CRE_DT = '0' ,'01/01/1900',cast(ltrim(rtrim(CRE_DT))AS DATE)) CRE_DT,
	IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%' ,'01/01/1900',cast(ltrim(rtrim(UPD_TS))AS DATETIME)) UPD_TS
from [BCMPWMT].[OFFR]

ALTER TABLE Dim_OFFR_SQL_IN1563 ADD [prod_key] INT
UPDATE Dim_OFFR_SQL_IN1563 SET PROD_KEY=P.PROD_KEY
FROM Dim_OFFR_SQL_IN1563 D LEFT JOIN dim_prod_SQL_IN1563 P ON
D.CATLG_ITEM_ID=P.CATLG_ITEM_ID


select * from Dim_OFFR_SQL_IN1563

DIM_STS_LKP_SQL_IN1563
select * from [BCMPWMT].[STS_LKP]

insert into DIM_STS_LKP_SQL_IN1563
select 
IIF(STS_ID IS NULL OR STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_ID)))),
IIF(STS_MASTER_ID IS NULL OR STS_MASTER_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_MASTER_ID)))),
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(TENANT_ORG_ID)))),
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(DATA_SRC_ID)))),
IIF(STS_CD IS NULL OR STS_CD = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_CD)))),
IIF(SRC_STS_ID IS NULL OR SRC_STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(SRC_STS_ID)))),
IIF(STS_DESC IS NULL OR STS_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_DESC)))),
IIF(STS_LONG_DESC IS NULL OR STS_LONG_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_LONG_DESC)))),
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,CRE_TS)),'-',format(convert(datetime,CRE_TS),'yyyy'))),
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,UPD_TS)),'-',format(convert(datetime,UPD_TS),'yyyy')))
from [BCMPWMT].[STS_LKP]

SELECT * FROM DIM_STS_LKP_SQL_IN1563

dim_rpt_hrchy_SQL_IN1563

SELECT * FROM [BCMPWMT].[RPT_HRCHY]

INSERT INTO dim_rpt_hrchy_SQL_IN1563
SELECT
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID LIKE 'NULL' OR RPT_HRCHY_ID LIKE '?',101.00,cast(RPT_HRCHY_ID as FLOAT)) RPT_HRCHY_ID,
IIF(SRC_RPT_HRCHY_ID IS NULL OR SRC_RPT_HRCHY_ID LIKE 'NULL' OR SRC_RPT_HRCHY_ID LIKE '?',101.00,cast(SRC_RPT_HRCHY_ID as FLOAT)) SRC_RPT_HRCHY_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(tenant_org_id)))) tenant_org_id,
IIF(RPT_HRCHY_PATH IS NULL OR RPT_HRCHY_PATH LIKE 'NULL' OR RPT_HRCHY_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_PATH)))) RPT_HRCHY_PATH,
IIF(DIV_ID IS NULL OR DIV_ID LIKE 'NULL' OR DIV_ID LIKE '?',101.00,cast(DIV_ID as FLOAT)) DIV_ID,
IIF(DIV_NM IS NULL OR DIV_NM LIKE 'NULL' OR DIV_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DIV_NM)))) DIV_NM,
IIF(SUPER_DEPT_ID IS NULL OR SUPER_DEPT_ID LIKE 'NULL' OR SUPER_DEPT_ID LIKE '?',101.00,cast(SUPER_DEPT_ID as FLOAT)) SUPER_DEPT_ID,
IIF(SUPER_DEPT_NM IS NULL OR SUPER_DEPT_NM LIKE 'NULL' OR SUPER_DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUPER_DEPT_NM)))) SUPER_DEPT_NM,
IIF(DEPT_ID IS NULL OR DEPT_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(DEPT_ID as FLOAT)) DEPT_ID,
IIF(DEPT_NM IS NULL OR DEPT_NM LIKE 'NULL' OR DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEPT_NM)))) DEPT_NM,
IIF(CATEG_NM IS NULL OR CATEG_NM LIKE 'NULL' OR CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_NM)))) CATEG_NM,
IIF(SUB_CATEG_ID IS NULL OR SUB_CATEG_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(SUB_CATEG_ID as FLOAT)) SUB_CATEG_ID,
IIF(SUB_CATEG_NM IS NULL OR SUB_CATEG_NM LIKE 'NULL' OR SUB_CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUB_CATEG_NM)))) SUB_CATEG_NM,
IIF(ITEM_CATEG_GROUPING_ID IS NULL OR ITEM_CATEG_GROUPING_ID LIKE 'NULL' OR ITEM_CATEG_GROUPING_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ITEM_CATEG_GROUPING_ID)))) ITEM_CATEG_GROUPING_ID,
IIF(SRC_CRE_TS IS NULL OR SRC_CRE_TS LIKE 'NULL' OR SRC_CRE_TS LIKE '?','N/A',SRC_CRE_TS) SRC_CRE_TS,
IIF(SRC_MODFD_TS IS NULL OR SRC_MODFD_TS LIKE 'NULL' OR SRC_MODFD_TS LIKE '?','N/A',SRC_MODFD_TS) SRC_MODFD_TS,
IIF(SRC_HRCHY_MODFD_TS IS NULL OR SRC_HRCHY_MODFD_TS LIKE 'NULL' OR SRC_HRCHY_MODFD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(SRC_HRCHY_MODFD_TS,1,CHARINDEX('.',SRC_HRCHY_MODFD_TS)-1))) SRC_HRCHY_MODFD_TS,
IIF(CATEG_MGR_NM IS NULL OR CATEG_MGR_NM LIKE 'NULL' OR CATEG_MGR_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_MGR_NM)))) CATEG_MGR_NM,
IIF(BUYER_NM IS NULL OR BUYER_NM LIKE 'NULL' OR BUYER_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BUYER_NM)))) BUYER_NM,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT LIKE 'NULL' OR EFF_BEGIN_DT LIKE '?' OR (EFF_BEGIN_DT LIKE '%[0-9]%' AND NOT EFF_BEGIN_DT LIKE '%[/]%'),'01/01/1900',cast(eff_begin_dt as date)) eff_begin_dt,
IIF(EFF_END_DT IS NULL OR EFF_END_DT LIKE 'NULL' OR EFF_END_DT LIKE '?' OR (EFF_END_DT LIKE '%[0-9]%' AND NOT EFF_END_DT LIKE '%[/]%'),'01/01/1900',cast(EFF_END_DT as date)) EFF_END_DT,
IIF(RPT_HRCHY_ID_PATH IS NULL OR RPT_HRCHY_ID_PATH LIKE 'NULL' OR RPT_HRCHY_ID_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_ID_PATH)))) RPT_HRCHY_ID_PATH,
IIF(CATEG_ID IS NULL OR CATEG_ID LIKE 'NULL' OR CATEG_ID LIKE '?',101.00,cast(CATEG_ID as FLOAT)) CATEG_ID,
IIF(CONSUMABLE_IND IS NULL OR CONSUMABLE_IND LIKE 'NULL' OR CONSUMABLE_IND LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CONSUMABLE_IND)))) CONSUMABLE_IND,
IIF(CURR_IND IS NULL OR CURR_IND LIKE 'NULL' OR CURR_IND LIKE '?',101.00,cast(CURR_IND as FLOAT)) CURR_IND,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?' OR (CRE_DT LIKE '%[0-9]%' AND NOT CRE_DT LIKE '%[/]%') ,'01/01/1900',cast(ltrim(rtrim(cre_dt))as date)) cre_dt,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(UPD_TS,1,CHARINDEX('.',UPD_TS)-1))) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?','N/A',UPD_USER) UPD_USER
FROM [BCMPWMT].[RPT_HRCHY]

SELECT * FROM dim_rpt_hrchy_SQL_IN1563

dim_prod_rpt_hrchy_SQL_IN1563

SELECT * FROM [BCMPWMT].[PROD_RPT_HRCHY]

INSERT INTO  dim_prod_rpt_hrchy_SQL_IN1563
SELECT
IIF(PROD_RPT_HRCHY_ASSOC_ID IS NULL OR PROD_RPT_HRCHY_ASSOC_ID = 'NULL',101,cast(ltrim(rtrim(PROD_RPT_HRCHY_ASSOC_ID))as int)) PROD_RPT_HRCHY_ASSOC_ID,
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID))as int)) CATLG_ITEM_ID,
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID = 'NULL',101,cast(ltrim(rtrim(RPT_HRCHY_ID))as int)) RPT_HRCHY_ID,
IIF(RH_SUB_CATEG_NM IS NULL OR RH_SUB_CATEG_NM = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_NM))as int)) RH_SUB_CATEG_NM,
IIF(CURR_IND IS NULL OR CURR_IND = 'NULL',101,cast(ltrim(rtrim(CURR_IND))as int)) CURR_IND,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_BEGIN_DT)) AS DATE)) EFF_BEGIN_DT,
IIF(EFF_END_DT IS NULL OR EFF_END_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_END_DT)) AS DATE)) EFF_END_DT,
IIF(PRMRY_CATEG_PATH IS NULL OR PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(PRMRY_CATEG_PATH))) PRMRY_CATEG_PATH,
IIF(CHAR_PRMRY_CATEG_PATH IS NULL OR CHAR_PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(CHAR_PRMRY_CATEG_PATH))) CHAR_PRMRY_CATEG_PATH,
IIF(RH_SUB_CATEG_ID IS NULL OR RH_SUB_CATEG_ID = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_ID))as int)) RH_SUB_CATEG_ID,
IIF(PRMRY_SHELF_ID IS NULL OR PRMRY_SHELF_ID = 'NULL',101,cast(ltrim(rtrim(PRMRY_SHELF_ID))as int)) PRMRY_SHELF_ID,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(UPD_TS)) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[PROD_RPT_HRCHY]

alter table dim_prod_rpt_hrchy_SQL_IN1563  add [RPT_HRCHY_KEY] int
update dim_prod_rpt_hrchy_SQL_IN1563 set [RPT_HRCHY_KEY]= pr.[RPT_HRCHY_KEY] from dim_prod_rpt_hrchy_SQL_IN1563 p 
join dim_rpt_hrchy_SQL_IN1563 pr on  
convert(varchar(50),p.[RPT_HRCHY_ID]) = convert(varchar(50),pr.[RPT_HRCHY_ID])

SELECT * FROM dim_prod_rpt_hrchy_SQL_IN1563


DIM_CUST_ACCT_DETAILS_SQL_IN1563
SELECT * FROM dim_cust_SQL_IN1563
SELECT * FROM dim_CUST_ACCT_SQL_IN1563

INSERT INTO DIM_CUST_ACCT_DETAILS_SQL_IN1563
SELECT 
A.CUST_ID AS CUST_ID,
A.TENANT_ORG_ID AS TENANT_ORG_ID,
A.CUST_TYPE_ID AS CUST_TYPE_ID,
A.NICKNAME AS NICKNAME,
A.SALUTE AS SALUTE,
A.MIDDLE_NM AS MIDDLE_NM,
A.CUST_TITLE AS CUST_TITLE,
A.SUFFIX AS SUFFIX,
A.WM_EMPLOYEE_ID AS WM_EMPLOYEE_ID,
A.CRE_DT AS CRE_DT,
A.CRE_USER AS CRE_USER,
A.UPD_TS AS UPD_TS,
A.UPD_USER AS UPD_USER,
A.SIGNUP_TS AS SIGNUP_TS,
A.REALM_ID AS REALM_ID,
A.VALID_CUST_IND AS VALID_CUST_IND,
A.DELTD_YN AS DELTD_YN,
B.ACCT_ID AS ACCT_ID,
B.CUST_ID AS CUST_ID_1,
B.TENANT_ORG_ID AS TENANT_ORG_ID_1,
B.ACCT_STS_ID AS ACCT_STS_ID,
B.ACCT_TYPE_ID AS ACCT_TYPE_ID,
B.EMAIL AS EMAIL,
B.VALID_CUST_IND AS VALID_CUST_IND_1,
B.CRE_DT AS CRE_DT_1,
B.CRE_USER AS CRE_USER_1,
B.UPD_TS AS UPD_TS_1,
B.UPD_USER AS UPD_USER_1,
B.StartDate AS StartDate,
B.EndDate AS EndDate,
B.DELTD_YN AS DELTD_YN_1
FROM dim_cust_SQL_IN1563 A LEFT JOIN dim_CUST_ACCT_SQL_IN1563 B
ON A.CUST_ID = B.CUST_ID

SELECT * FROM DIM_CUST_ACCT_DETAILS_SQL_IN1563

dim_cust_address_SQL_IN1563
SELECT * FROM [BCMPWMT].[CUST_ADDR]

INSERT INTO dim_cust_address_SQL_IN1563
SELECT
IIF(ADDR_ID IS NULL OR ADDR_ID like 'NULL' OR ADDR_ID LIKE '?', convert(float,101.00),ADDR_ID) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID like 'NULL' OR TENANT_ORG_ID LIKE '?', 101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID like 'NULL' OR DATA_SRC_ID LIKE '?', 101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(VALID_TS)) AS DATETIME)) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?', 'N/A', ltrim(rtrim(valid_sts))) valid_sts,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?', 'N/A', ltrim(rtrim(CITY))) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?', 'N/A', ltrim(rtrim(MUNICIPALITY))) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(POSTAL_CD))as int)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_EXTN))as int)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(char,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
getdate() as StartDate,
NULL AS EndDate ,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?', '01/01/1900',CAST(SUBSTRING(LTRIM(RTRIM(UPD_TS)),1,CHARINDEX('.',UPD_TS)-1) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[CUST_ADDR]

SELECT * FROM dim_cust_address_SQL_IN1563

dim_cust_addr1_SQL_IN1563

SELECT * FROM [BCMPWMT].[CUST_ADDR1]

INSERT INTO dim_cust_addr1_SQL_IN1563
SELECT 
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101,cast(ltrim(rtrim(addr_id))as bigint)) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?','N/A',convert(nvarchar,format(convert(date,VALID_TS),'dd-MM-yyyy'))) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?',101,cast(ltrim(rtrim(VALID_STS))as int)) VALID_STS,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?','N/A',cast(ltrim(rtrim(CITY))as nvarchar)) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?','N/A',IIF(LEN(MUNICIPALITY) > 2 OR LEN(MUNICIPALITY) < 9,LTRIM(RTRIM(MUNICIPALITY)),'N/A')) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(POSTAL_CD))as NVARCHAR)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(ZIP_EXTN))as NVARCHAR)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(NVARchar,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER
FROM [BCMPWMT].[CUST_ADDR1]

SELECT * FROM dim_cust_addr1_SQL_IN1563


DIM_CUST_CNTCT_SQL_IN1563

SELECT * FROM [BCMPWMT].[CUST_CNTCT]

INSERT INTO DIM_CUST_CNTCT_SQL_IN1563
SELECT
IIF(CNTCT_ID IS NULL OR CNTCT_ID LIKE 'NULL' OR CNTCT_ID LIKE '?',101, cast(ltrim(rtrim(Cntct_id)) as int))Cntct_id,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101, cast(ltrim(rtrim(TENANT_ORG_ID)) as int))TENANT_ORG_ID,
IIF(SRC_CNTCT_ID IS NULL OR SRC_CNTCT_ID LIKE 'NULL' OR SRC_CNTCT_ID LIKE '?','N/A', cast(ltrim(rtrim(SRC_CNTCT_ID)) as VARCHAR))SRC_CNTCT_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101, cast(ltrim(rtrim(DATA_SRC_ID)) as int))DATA_SRC_ID,
IIF(ACCT_ID IS NULL OR ACCT_ID LIKE 'NULL' OR ACCT_ID LIKE '?',101, cast(ltrim(rtrim(ACCT_ID)) as bigint))ACCT_ID,
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ID)) as bigint))ADDR_ID ,
IIF(PHONE_ID IS NULL OR PHONE_ID LIKE 'NULL' OR PHONE_ID LIKE '?',101, cast(ltrim(rtrim(PHONE_ID)) as bigint))PHONE_ID,
IIF(EMAIL_ID IS NULL OR EMAIL_ID LIKE 'NULL' OR EMAIL_ID LIKE '?','N/A', cast(ltrim(rtrim(EMAIL_ID)) as VARCHAR))EMAIL_ID,
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID LIKE 'NULL' OR ADDR_ZONE_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ZONE_ID)) as bigint))ADDR_ZONE_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?','N/A', cast(ltrim(rtrim(DELTD_YN)) as CHAR))EMAIL_ID,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?','01/01/1900',cast(ltrim(rtrim(Cre_Dt))as Date)) Cre_Dt,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?' OR UPD_TS LIKE '%[A-Za-z]%','N/A', cast(FORMAT(CONVERT(DATE,(ltrim(rtrim(UPD_TS)))),'dd/MMMM/yyyy') as NVARCHAR))UPD_TS
FROM [BCMPWMT].[CUST_CNTCT]

ALTER TABLE DIM_CUST_CNTCT_SQL_IN1563 ADD [CUST_PHONE_KEY] INT

UPDATE DIM_CUST_CNTCT_SQL_IN1563 SET DIM_CUST_CNTCT_SQL_IN1563.[CUST_PHONE_KEY]= DIM_CUST_PHONE_SQL_IN1563.[CUST_PHONE_KEY] 
FROM DIM_CUST_CNTCT_SQL_IN1563  JOIN DIM_CUST_PHONE_SQL_IN1563  ON
CONVERT(VARCHAR(50),DIM_CUST_CNTCT_SQL_IN1563.PHONE_ID)=CONVERT(VARCHAR(50),DIM_CUST_PHONE_SQL_IN1563.PHONE_ID)
SELECT * FROM DIM_CUST_CNTCT_SQL_IN1563

ALTER TABLE DIM_CUST_CNTCT_SQL_IN1563 ADD [CUST_ADDR_ZONE_KEY] INT

UPDATE DIM_CUST_CNTCT_SQL_IN1563 SET DIM_CUST_CNTCT_SQL_IN1563.[CUST_ADDR_ZONE_KEY]=AZ.[addr_zone_id_key] 
FROM DIM_CUST_CNTCT_SQL_IN1563 CC JOIN
dim_cust_addr_zone_SQL_IN1563 AZ
ON CONVERT(VARCHAR(50),CC.ADDR_ZONE_ID)= CONVERT(VARCHAR(50),AZ.ADDR_ZONE_ID)


ALTER TABLE DIM_CUST_CNTCT_SQL_IN1563 ADD [Cust_email_key] INT

UPDATE DIM_CUST_CNTCT_SQL_IN1563 SET DIM_CUST_CNTCT_SQL_IN1563.[Cust_email_key]=e.[Cust_email_key] 
FROM DIM_CUST_CNTCT_SQL_IN1563 CC JOIN
DIM_CUST_EMAIL_SQL_IN1563 e
ON CONVERT(VARCHAR(50),CC.EMAIL_ID)= CONVERT(VARCHAR(50),e.EMAIL_ID)

ALTER TABLE DIM_CUST_CNTCT_SQL_IN1563 ADD [Cust_acct_key] INT

UPDATE DIM_CUST_CNTCT_SQL_IN1563 SET DIM_CUST_CNTCT_SQL_IN1563.[Cust_acct_key]=e.[Cust_acct_key] 
FROM DIM_CUST_CNTCT_SQL_IN1563 CC JOIN
dim_CUST_ACCT_SQL_IN1563 e
ON CONVERT(VARCHAR(50),CC.ACCT_ID)= CONVERT(VARCHAR(50),e.ACCT_ID)


select * from  DIM_CUST_CNTCT_SQL_IN1563



select * from DIM_CHARGE_CATEG_SQL_IN1563
SELECT * FROM [BCMPWMT].[CHARGE_CATEG_LKP]


select tax_ind,count(*) from DIM_CHARGE_CATEG_SQL_IN1563
group by tax_ind

select tax_ind,count(*) from [BCMPWMT].[CHARGE_CATEG_LKP]
group by tax_ind

select count(*) from DIM_CHARGE_CATEG_SQL_IN1563
group by CHARGE_CATEG_ID
having COUNT(*) > 1

SELECT CHARGE_CATEG_ID,TENANT_ORG_ID,CHARGE_CATEG,CHARGE_CATEG_DESC,TAX_IND
FROM [BCMPWMT].[CHARGE_CATEG_LKP]
WHERE CHARGE_CATEG = 'MISC'

SELECT CHARGE_CATEG_ID,TENANT_ORG_ID,CHARGE_CATEG,CHARGE_CATEG_DESC,TAX_IND
FROM DIM_CHARGE_CATEG_SQL_IN1563
WHERE CHARGE_CATEG = 'MISC'

SELECT COUNT(*) FROM DIM_CHARGE_CATEG_SQL_IN1563 T LEFT JOIN 
(SELECT * FROM [BCMPWMT].[CHARGE_CATEG_LKP]) S  ON T.CHARGE_CATEG_ID = S.CHARGE_CATEG_ID
WHERE S.CHARGE_CATEG_ID IS NOT NULL AND 
(S.TENANT_ORG_ID <> T.TENANT_ORG_ID OR S.CHARGE_CATEG <> T.CHARGE_CATEG OR S.CHARGE_CATEG_DESC <> T.CHARGE_CATEG_DESC)

---------------------------------------------------------------------------------------------------------------
SELECT * FROM [BCMPWMT].[CUST]

SELECT * FROM dim_cust_SQL_IN1563 

select count(*) from dim_cust_SQL_IN1563 

select count(*) from 
(select IIF(cust_id IS NULL OR cust_id = 'NULL', 101,cast(ltrim(rtrim(cust_id)) as int)) as cust_id,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) as TENANT_ORG_ID,
IIF(cust_type_id IS NULL OR cust_type_id = 'NULL', 101, cast(ltrim(rtrim(cust_type_id)) as int))  as cust_type_id,
IIF(nickname IS NULL OR nickname = 'NULL', 'N/A', ltrim(rtrim(nickname)))  as nickname,
IIF(SALUTE IS NULL OR SALUTE = 'NULL','N/A', LTRIM(RTRIM(SUBSTRING(SALUTE,1,4))))  as SALUTE,
IIF(MIDDLE_NM IS NULL OR MIDDLE_NM = 'NULL','N/A',ltrim(rtrim(middle_nm)))  as MIDDLE_NM,
IIF(CUST_TITLE IS NULL OR CUST_TITLE = 'NULL','N/A',REPLACE(ltrim(rtrim(cust_title)),'#',' '))  as CUST_TITLE,
IIF(SUFFIX IS NULL OR SUFFIX = 'NULL','N/A', CONCAT(SUBSTRING(LOWER(SUFFIX),1,1),SUBSTRING(UPPER(SUFFIX),2,1),SUBSTRING(LOWER(SUFFIX),3,LEN(SUFFIX))))  as SUFFIX,
IIF(WM_EMPLOYEE_ID IS NULL OR WM_EMPLOYEE_ID = 'NULL','N/A', cast(ltrim(rtrim(wm_employee_id))as int))  as WM_EMPLOYEE_ID,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1990',cast(ltrim(rtrim(cre_dt))as Date))  as CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_user)))  as CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1990',cast(ltrim(rtrim(upd_ts))as datetime))  as UPD_TS, 
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',ltrim(rtrim(upd_user)))  as UPD_USER,
GETDATE() AS StartDate,
NULL as EndDate,
IIF(SIGNUP_TS IS NULL OR SIGNUP_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(signup_ts))as datetime))  as SIGNUP_TS,
IIF(REALM_ID IS NULL OR REALM_ID = 'NULL','N/A',ltrim(rtrim(realm_id)))  as REALM_ID,
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL','N/A', ltrim(rtrim(valid_cust_ind)))  as VALID_CUST_IND,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL','N/A',ltrim(rtrim(deltd_yn))) as DELTD_YN
FROM [BCMPWMT].[CUST]) s 

select cust_title,count(*) from dim_cust_SQL_IN1563 
group by cust_title

select CUST_TITLE,count(*) from 
(select IIF(cust_id IS NULL OR cust_id = 'NULL', 101,cast(ltrim(rtrim(cust_id)) as int)) as cust_id,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) as TENANT_ORG_ID,
IIF(cust_type_id IS NULL OR cust_type_id = 'NULL', 101, cast(ltrim(rtrim(cust_type_id)) as int))  as cust_type_id,
IIF(nickname IS NULL OR nickname = 'NULL', 'N/A', ltrim(rtrim(nickname)))  as nickname,
IIF(SALUTE IS NULL OR SALUTE = 'NULL','N/A', LTRIM(RTRIM(SUBSTRING(SALUTE,1,4))))  as SALUTE,
IIF(MIDDLE_NM IS NULL OR MIDDLE_NM = 'NULL','N/A',ltrim(rtrim(middle_nm)))  as MIDDLE_NM,
IIF(CUST_TITLE IS NULL OR CUST_TITLE = 'NULL','N/A',REPLACE(ltrim(rtrim(cust_title)),'#',' '))  as CUST_TITLE,
IIF(SUFFIX IS NULL OR SUFFIX = 'NULL','N/A', CONCAT(SUBSTRING(LOWER(SUFFIX),1,1),SUBSTRING(UPPER(SUFFIX),2,1),SUBSTRING(LOWER(SUFFIX),3,LEN(SUFFIX))))  as SUFFIX,
IIF(WM_EMPLOYEE_ID IS NULL OR WM_EMPLOYEE_ID = 'NULL','N/A', cast(ltrim(rtrim(wm_employee_id))as int))  as WM_EMPLOYEE_ID,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1990',cast(ltrim(rtrim(cre_dt))as Date))  as CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_user)))  as CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1990',cast(ltrim(rtrim(upd_ts))as datetime))  as UPD_TS, 
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',ltrim(rtrim(upd_user)))  as UPD_USER,
GETDATE() AS StartDate,
NULL as EndDate,
IIF(SIGNUP_TS IS NULL OR SIGNUP_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(signup_ts))as datetime))  as SIGNUP_TS,
IIF(REALM_ID IS NULL OR REALM_ID = 'NULL','N/A',ltrim(rtrim(realm_id)))  as REALM_ID,
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL','N/A', ltrim(rtrim(valid_cust_ind)))  as VALID_CUST_IND,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL','N/A',ltrim(rtrim(deltd_yn))) as DELTD_YN
FROM [BCMPWMT].[CUST]) s 
group by cust_title

select count(*) from dim_cust_SQL_IN1563 
group by CUST_ID
HAVING COUNT(*) > 1

SELECT CUST_ID,SALUTE,CUST_TITLE,CRE_DT,UPD_TS
FROM dim_cust_SQL_IN1563
WHERE CUST_ID = 51428720

SELECT CUST_ID,SALUTE,CUST_TITLE,CRE_DT,UPD_TS FROM 
(select IIF(cust_id IS NULL OR cust_id = 'NULL', 101,cast(ltrim(rtrim(cust_id)) as int)) as cust_id,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) as TENANT_ORG_ID,
IIF(cust_type_id IS NULL OR cust_type_id = 'NULL', 101, cast(ltrim(rtrim(cust_type_id)) as int))  as cust_type_id,
IIF(nickname IS NULL OR nickname = 'NULL', 'N/A', ltrim(rtrim(nickname)))  as nickname,
IIF(SALUTE IS NULL OR SALUTE = 'NULL','N/A', LTRIM(RTRIM(SUBSTRING(SALUTE,1,4))))  as SALUTE,
IIF(MIDDLE_NM IS NULL OR MIDDLE_NM = 'NULL','N/A',ltrim(rtrim(middle_nm)))  as MIDDLE_NM,
IIF(CUST_TITLE IS NULL OR CUST_TITLE = 'NULL','N/A',REPLACE(ltrim(rtrim(cust_title)),'#',' '))  as CUST_TITLE,
IIF(SUFFIX IS NULL OR SUFFIX = 'NULL','N/A', CONCAT(SUBSTRING(LOWER(SUFFIX),1,1),SUBSTRING(UPPER(SUFFIX),2,1),SUBSTRING(LOWER(SUFFIX),3,LEN(SUFFIX))))  as SUFFIX,
IIF(WM_EMPLOYEE_ID IS NULL OR WM_EMPLOYEE_ID = 'NULL','N/A', cast(ltrim(rtrim(wm_employee_id))as int))  as WM_EMPLOYEE_ID,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1990',cast(ltrim(rtrim(cre_dt))as Date))  as CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_user)))  as CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1990',cast(ltrim(rtrim(upd_ts))as datetime))  as UPD_TS, 
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',ltrim(rtrim(upd_user)))  as UPD_USER,
GETDATE() AS StartDate,
NULL as EndDate,
IIF(SIGNUP_TS IS NULL OR SIGNUP_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(signup_ts))as datetime))  as SIGNUP_TS,
IIF(REALM_ID IS NULL OR REALM_ID = 'NULL','N/A',ltrim(rtrim(realm_id)))  as REALM_ID,
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL','N/A', ltrim(rtrim(valid_cust_ind)))  as VALID_CUST_IND,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL','N/A',ltrim(rtrim(deltd_yn))) as DELTD_YN
FROM [BCMPWMT].[CUST]) s
WHERE CUST_ID = '51428720'

SELECT COUNT(*) FROM dim_cust_SQL_IN1563 T LEFT JOIN 
(select IIF(cust_id IS NULL OR cust_id = 'NULL', 101,cast(ltrim(rtrim(cust_id)) as int)) as cust_id,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) as TENANT_ORG_ID,
IIF(cust_type_id IS NULL OR cust_type_id = 'NULL', 101, cast(ltrim(rtrim(cust_type_id)) as int))  as cust_type_id,
IIF(nickname IS NULL OR nickname = 'NULL', 'N/A', ltrim(rtrim(nickname)))  as nickname,
IIF(SALUTE IS NULL OR SALUTE = 'NULL','N/A', LTRIM(RTRIM(SUBSTRING(SALUTE,1,4))))  as SALUTE,
IIF(MIDDLE_NM IS NULL OR MIDDLE_NM = 'NULL','N/A',ltrim(rtrim(middle_nm)))  as MIDDLE_NM,
IIF(CUST_TITLE IS NULL OR CUST_TITLE = 'NULL','N/A',REPLACE(ltrim(rtrim(cust_title)),'#',' '))  as CUST_TITLE,
IIF(SUFFIX IS NULL OR SUFFIX = 'NULL','N/A', CONCAT(SUBSTRING(LOWER(SUFFIX),1,1),SUBSTRING(UPPER(SUFFIX),2,1),SUBSTRING(LOWER(SUFFIX),3,LEN(SUFFIX))))  as SUFFIX,
IIF(WM_EMPLOYEE_ID IS NULL OR WM_EMPLOYEE_ID = 'NULL','N/A', cast(ltrim(rtrim(wm_employee_id))as int))  as WM_EMPLOYEE_ID,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1990',cast(ltrim(rtrim(cre_dt))as Date))  as CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_user)))  as CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1990',cast(ltrim(rtrim(upd_ts))as datetime))  as UPD_TS, 
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',ltrim(rtrim(upd_user)))  as UPD_USER,
GETDATE() AS StartDate,
NULL as EndDate,
IIF(SIGNUP_TS IS NULL OR SIGNUP_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(signup_ts))as datetime))  as SIGNUP_TS,
IIF(REALM_ID IS NULL OR REALM_ID = 'NULL','N/A',ltrim(rtrim(realm_id)))  as REALM_ID,
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL','N/A', ltrim(rtrim(valid_cust_ind))) as VALID_CUST_IND,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL','N/A',ltrim(rtrim(deltd_yn))) as DELTD_YN
FROM [BCMPWMT].[CUST]) S
ON T.CUST_ID = S.CUST_ID
WHERE S.CUST_ID IS NULL
AND (T.TENANT_ORG_ID <> S.TENANT_ORG_ID OR T.CUST_TYPE_ID <> S.CUST_TYPE_ID OR T.NICKNAME <> S.NICKNAME OR T.SALUTE <> S.SALUTE OR T.CUST_TITLE<>S.CUST_TITLE)

---------------------------------------------------------------------------------------------------------------

select * from [BCMPWMT].[CUST_ACCT]
select * from dim_CUST_ACCT_SQL_IN1563

select count(*) from dim_CUST_ACCT_SQL_IN1563
select count(*) from (
SELECT 
 IIF(ACCT_ID IS NULL OR ACCT_ID = 'NULL',101,cast(ltrim(rtrim(acct_id)) as bigint)) ACCT_ID,
IIF(CUST_ID IS NULL OR CUST_ID = 'NULL',101,cast(ltrim(rtrim(cust_id))as int)) CUST_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,cast(ltrim(rtrim(tenant_org_id))as int)) TENANT_ORG_ID,
IIF(ACCT_STS_ID IS NULL OR ACCT_STS_ID = 'NULL',101,cast(ltrim(rtrim(acct_sts_id))as int)) ACCT_STS_ID,
IIF(ACCT_TYPE_ID IS NULL OR ACCT_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(acct_type_id))as int)) ACCT_TYPE_ID,
IIF(EMAIL IS NULL OR EMAIL = 'NULL','N/A',IIF(EMAIL LIKE '%@%',LTRIM(RTRIM(EMAIL)),'N/A')) EMAIL,
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL', 101,cast(ltrim(rtrim(valid_cust_ind))as int)) VALID_CUST_IND,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT)) as DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_USER))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL', 'N/A' , ltrim(rtrim(upd_user))) UPD_USER,
getdate() as StartDate,
NULL AS EndDate,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A',cast(ltrim(rtrim(DELTD_YN)) as char)) DELTD_YN
FROM [BCMPWMT].[CUST_ACCT]) source

select email,count(*) from dim_CUST_ACCT_SQL_IN1563
group by email

select email,count(*) from (
SELECT 
 IIF(ACCT_ID IS NULL OR ACCT_ID = 'NULL',101,cast(ltrim(rtrim(acct_id)) as bigint)) ACCT_ID,
IIF(CUST_ID IS NULL OR CUST_ID = 'NULL',101,cast(ltrim(rtrim(cust_id))as int)) CUST_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,cast(ltrim(rtrim(tenant_org_id))as int)) TENANT_ORG_ID,
IIF(ACCT_STS_ID IS NULL OR ACCT_STS_ID = 'NULL',101,cast(ltrim(rtrim(acct_sts_id))as int)) ACCT_STS_ID,
IIF(ACCT_TYPE_ID IS NULL OR ACCT_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(acct_type_id))as int)) ACCT_TYPE_ID,
IIF(EMAIL IS NULL OR EMAIL = 'NULL','N/A',IIF(EMAIL LIKE '%@%',LTRIM(RTRIM(EMAIL)),'N/A')) EMAIL,
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL', 101,cast(ltrim(rtrim(valid_cust_ind))as int)) VALID_CUST_IND,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT)) as DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_USER))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL', 'N/A' , ltrim(rtrim(upd_user))) UPD_USER,
getdate() as StartDate,
NULL AS EndDate,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A',cast(ltrim(rtrim(DELTD_YN)) as char)) DELTD_YN
FROM [BCMPWMT].[CUST_ACCT]) source
group by email

select count(*) from dim_CUST_ACCT_SQL_IN1563
group by acct_id
having count(*) > 1

select acct_id,cust_id,tenant_org_id,email,valid_cust_ind
from dim_CUST_ACCT_SQL_IN1563
where acct_id = 87005017

select acct_id,cust_id,tenant_org_id,email,valid_cust_ind from (
SELECT 
 IIF(ACCT_ID IS NULL OR ACCT_ID = 'NULL',101,cast(ltrim(rtrim(acct_id)) as bigint)) ACCT_ID,
IIF(CUST_ID IS NULL OR CUST_ID = 'NULL',101,cast(ltrim(rtrim(cust_id))as int)) CUST_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,cast(ltrim(rtrim(tenant_org_id))as int)) TENANT_ORG_ID,
IIF(ACCT_STS_ID IS NULL OR ACCT_STS_ID = 'NULL',101,cast(ltrim(rtrim(acct_sts_id))as int)) ACCT_STS_ID,
IIF(ACCT_TYPE_ID IS NULL OR ACCT_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(acct_type_id))as int)) ACCT_TYPE_ID,
IIF(EMAIL IS NULL OR EMAIL = 'NULL','N/A',IIF(EMAIL LIKE '%@%',LTRIM(RTRIM(EMAIL)),'N/A')) EMAIL,
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL', 101,cast(ltrim(rtrim(valid_cust_ind))as int)) VALID_CUST_IND,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT)) as DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_USER))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL', 'N/A' , ltrim(rtrim(upd_user))) UPD_USER,
getdate() as StartDate,
NULL AS EndDate,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A',cast(ltrim(rtrim(DELTD_YN)) as char)) DELTD_YN
FROM [BCMPWMT].[CUST_ACCT]) source
where acct_id = '87005017'

select count(*) from dim_CUST_ACCT_SQL_IN1563 T LEFT JOIN
(SELECT 
 IIF(ACCT_ID IS NULL OR ACCT_ID = 'NULL',101,cast(ltrim(rtrim(acct_id)) as bigint)) ACCT_ID,
IIF(CUST_ID IS NULL OR CUST_ID = 'NULL',101,cast(ltrim(rtrim(cust_id))as int)) CUST_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,cast(ltrim(rtrim(tenant_org_id))as int)) TENANT_ORG_ID,
IIF(ACCT_STS_ID IS NULL OR ACCT_STS_ID = 'NULL',101,cast(ltrim(rtrim(acct_sts_id))as int)) ACCT_STS_ID,
IIF(ACCT_TYPE_ID IS NULL OR ACCT_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(acct_type_id))as int)) ACCT_TYPE_ID,
IIF(EMAIL IS NULL OR EMAIL = 'NULL','N/A',IIF(EMAIL LIKE '%@%',LTRIM(RTRIM(EMAIL)),'N/A')) EMAIL,
IIF(VALID_CUST_IND IS NULL OR VALID_CUST_IND = 'NULL', 101,cast(ltrim(rtrim(valid_cust_ind))as int)) VALID_CUST_IND,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT)) as DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',ltrim(rtrim(CRE_USER))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL', 'N/A' , ltrim(rtrim(upd_user))) UPD_USER,
getdate() as StartDate,
NULL AS EndDate,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A',cast(ltrim(rtrim(DELTD_YN)) as char)) DELTD_YN
FROM [BCMPWMT].[CUST_ACCT]) s 
ON T.ACCT_ID = S.ACCT_ID
WHERE S.ACCT_ID IS NULL AND
(T.CUST_ID <> S.CUST_ID OR T.TENANT_ORG_ID <> S.TENANT_ORG_ID OR T.ACCT_STS_ID <> S.ACCT_STS_ID OR T.ACCT_TYPE_ID <> S.ACCT_TYPE_ID
OR T.EMAIL <> S.EMAIL OR T.VALID_CUST_IND <> S.VALID_CUST_IND OR T.CRE_DT <> S.CRE_DT OR T.CRE_USER <> S.CRE_USER OR T.UPD_TS <> S.UPD_TS
OR T.UPD_USER <> S.UPD_USER OR T.DELTD_YN <> S.DELTD_YN OR T.StartDate <> S.StartDate)

-------------------------------------------------------------------------------------------------------
SELECT * FROM dim_cust_addr_zone_SQL_IN1563

select count(*) from dim_cust_addr_zone_SQL_IN1563
select count(*) from 
(select 
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID = 'NULL',101,cast(ltrim(rtrim(addr_zone_id))as int)) ADDR_ZONE_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(tenant_org_id))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',  101 , cast(ltrim(rtrim(data_src_id))as int)) DATA_SRC_ID,
IIF(CITY IS NULL OR CITY = 'NULL', 'N/A'  , ltrim(rtrim(city))) CITY,
IIF(POSTAL_CD IS NULL OR POSTAL_CD = 'NULL', 'N/A', ltrim(rtrim(postal_cd))) POSTAL_CD,
IIF(STATE IS NULL OR STATE = 'NULL', 'N/A'  ,ltrim(rtrim(state))) STATE,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A'  , cast(ltrim(rtrim(deltd_yn))as varchar)) DELTD_YN,
IIF(CRE_USER IS NULL OR CRE_USER  = 'NULL', 'N/A'  , ltrim(rtrim(cre_user))) CRE_USER,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(cre_dt))as date)) CRE_DT,
IIF(UPD_USER IS NULL OR UPD_USER= 'NULL', 'N/A'  ,ltrim(rtrim(upd_user))) UPD_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS
from [BCMPWMT].[CUST_ADDR_ZONE]) S

SELECT TENANT_ORG_ID,COUNT(*) FROM dim_cust_addr_zone_SQL_IN1563
GROUP BY TENANT_ORG_ID

SELECT TENANT_ORG_ID,COUNT(*) FROM 
(select 
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID = 'NULL',101,cast(ltrim(rtrim(addr_zone_id))as int)) ADDR_ZONE_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(tenant_org_id))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',  101 , cast(ltrim(rtrim(data_src_id))as int)) DATA_SRC_ID,
IIF(CITY IS NULL OR CITY = 'NULL', 'N/A'  , ltrim(rtrim(city))) CITY,
IIF(POSTAL_CD IS NULL OR POSTAL_CD = 'NULL', 'N/A', ltrim(rtrim(postal_cd))) POSTAL_CD,
IIF(STATE IS NULL OR STATE = 'NULL', 'N/A'  ,ltrim(rtrim(state))) STATE,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A'  , cast(ltrim(rtrim(deltd_yn))as varchar)) DELTD_YN,
IIF(CRE_USER IS NULL OR CRE_USER  = 'NULL', 'N/A'  , ltrim(rtrim(cre_user))) CRE_USER,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(cre_dt))as date)) CRE_DT,
IIF(UPD_USER IS NULL OR UPD_USER= 'NULL', 'N/A'  ,ltrim(rtrim(upd_user))) UPD_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS
from [BCMPWMT].[CUST_ADDR_ZONE]) S
GROUP BY TENANT_ORG_ID

select count(*) from dim_cust_addr_zone_SQL_IN1563
group by ADDR_ZONE_ID
having count(*) > 1

SELECT ADDR_ZONE_ID,TENANT_ORG_ID,DATA_SRC_ID,CITY,POSTAL_CD,STATE,CRE_DT,DELTD_YN
FROM dim_cust_addr_zone_SQL_IN1563
WHERE CITY = 'Howell'

select ADDR_ZONE_ID,TENANT_ORG_ID,DATA_SRC_ID,CITY,POSTAL_CD,STATE,CRE_DT,DELTD_YN
from (select 
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID = 'NULL',101,cast(ltrim(rtrim(addr_zone_id))as int)) ADDR_ZONE_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(tenant_org_id))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',  101 , cast(ltrim(rtrim(data_src_id))as int)) DATA_SRC_ID,
IIF(CITY IS NULL OR CITY = 'NULL', 'N/A'  , ltrim(rtrim(city))) CITY,
IIF(POSTAL_CD IS NULL OR POSTAL_CD = 'NULL', 'N/A', ltrim(rtrim(postal_cd))) POSTAL_CD,
IIF(STATE IS NULL OR STATE = 'NULL', 'N/A'  ,ltrim(rtrim(state))) STATE,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A'  , cast(ltrim(rtrim(deltd_yn))as varchar)) DELTD_YN,
IIF(CRE_USER IS NULL OR CRE_USER  = 'NULL', 'N/A'  , ltrim(rtrim(cre_user))) CRE_USER,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(cre_dt))as date)) CRE_DT,
IIF(UPD_USER IS NULL OR UPD_USER= 'NULL', 'N/A'  ,ltrim(rtrim(upd_user))) UPD_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS
from [BCMPWMT].[CUST_ADDR_ZONE]) S
WHERE CITY = 'Howell'

select count(*) from dim_cust_addr_zone_SQL_IN1563 T LEFT JOIN
(select 
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID = 'NULL',101,cast(ltrim(rtrim(addr_zone_id))as int)) ADDR_ZONE_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL', 101 ,cast(ltrim(rtrim(tenant_org_id))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',  101 , cast(ltrim(rtrim(data_src_id))as int)) DATA_SRC_ID,
IIF(CITY IS NULL OR CITY = 'NULL', 'N/A'  , ltrim(rtrim(city))) CITY,
IIF(POSTAL_CD IS NULL OR POSTAL_CD = 'NULL', 'N/A', ltrim(rtrim(postal_cd))) POSTAL_CD,
IIF(STATE IS NULL OR STATE = 'NULL', 'N/A'  ,ltrim(rtrim(state))) STATE,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A'  , cast(ltrim(rtrim(deltd_yn))as varchar)) DELTD_YN,
IIF(CRE_USER IS NULL OR CRE_USER  = 'NULL', 'N/A'  , ltrim(rtrim(cre_user))) CRE_USER,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(cre_dt))as date)) CRE_DT,
IIF(UPD_USER IS NULL OR UPD_USER= 'NULL', 'N/A'  ,ltrim(rtrim(upd_user))) UPD_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL', '01/01/1900'  , cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS
from [BCMPWMT].[CUST_ADDR_ZONE]) S
ON T.ADDR_ZONE_ID = S.ADDR_ZONE_ID
WHERE S.ADDR_ZONE_ID IS NULL AND
(T.ADDR_ZONE_ID <> S.ADDR_ZONE_ID OR T.TENANT_ORG_ID <> S.TENANT_ORG_ID OR T.DATA_SRC_ID <> S.DATA_SRC_ID OR T.CITY <> S.CITY
OR T.POSTAL_CD <> S.POSTAL_CD OR T.STATE <> S.STATE OR T.DELTD_YN <> S.DELTD_YN OR T.CRE_USER <> S.CRE_USER OR T.CRE_DT <> S.CRE_DT
OR T.UPD_USER <> S.UPD_USER OR T.UPD_TS <> S.UPD_TS)

---------------------------------------------------------------------------------------------------------
SELECT * FROM DIM_CUST_EMAIL_SQL_IN1563

SELECT COUNT(*) FROM DIM_CUST_EMAIL_SQL_IN1563
SELECT COUNT(*) FROM 
(select 
IIF(EMAIL_ID IS NULL OR EMAIL_ID = 'NULL',101 , cast(ltrim(rtrim(EMAIL_ID)) as bigint)) EMAIL_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101 , cast(ltrim(rtrim(Tenant_Org_id)) as int)) TENANT_ORG_ID,
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101 , cast(ltrim(rtrim(cntct_type_id)) as int)) CNTCT_TYPE_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101 , cast(ltrim(rtrim(Data_src_id)) as int)) DATA_SRC_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN  = 'NULL','N/A', cast(ltrim(rtrim(Deltd_yn)) as varchar)) DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900' , cast(ltrim(rtrim(Cre_Dt))as Date)) CRE_DT,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900', cast(ltrim(rtrim(Upd_ts))as Date)) UPD_TS
FROM [BCMPWMT].[CUST_EMAIL]) S

SELECT CNTCT_TYPE_ID,COUNT(*) FROM DIM_CUST_EMAIL_SQL_IN1563 GROUP BY CNTCT_TYPE_ID

SELECT CNTCT_TYPE_ID,COUNT(*) FROM 
(select 
IIF(EMAIL_ID IS NULL OR EMAIL_ID = 'NULL',101 , cast(ltrim(rtrim(EMAIL_ID)) as bigint)) EMAIL_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101 , cast(ltrim(rtrim(Tenant_Org_id)) as int)) TENANT_ORG_ID,
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101 , cast(ltrim(rtrim(cntct_type_id)) as int)) CNTCT_TYPE_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101 , cast(ltrim(rtrim(Data_src_id)) as int)) DATA_SRC_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN  = 'NULL','N/A', cast(ltrim(rtrim(Deltd_yn)) as varchar)) DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900' , cast(ltrim(rtrim(Cre_Dt))as Date)) CRE_DT,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900', cast(ltrim(rtrim(Upd_ts))as Date)) UPD_TS
FROM [BCMPWMT].[CUST_EMAIL]) S
GROUP BY CNTCT_TYPE_ID

SELECT COUNT(*) FROM DIM_CUST_EMAIL_SQL_IN1563
GROUP BY EMAIL_ID
HAVING COUNT(*) > 1

SELECT Email_Id,tenant_org_id,cntct_type_id,data_src_id,deltd_yn
from DIM_CUST_EMAIL_SQL_IN1563
where email_id = 343970302


SELECT Email_Id,tenant_org_id,cntct_type_id,data_src_id,deltd_yn
from (select 
IIF(EMAIL_ID IS NULL OR EMAIL_ID = 'NULL',101 , cast(ltrim(rtrim(EMAIL_ID)) as bigint)) EMAIL_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101 , cast(ltrim(rtrim(Tenant_Org_id)) as int)) TENANT_ORG_ID,
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101 , cast(ltrim(rtrim(cntct_type_id)) as int)) CNTCT_TYPE_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101 , cast(ltrim(rtrim(Data_src_id)) as int)) DATA_SRC_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN  = 'NULL','N/A', cast(ltrim(rtrim(Deltd_yn)) as varchar)) DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900' , cast(ltrim(rtrim(Cre_Dt))as Date)) CRE_DT,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900', cast(ltrim(rtrim(Upd_ts))as Date)) UPD_TS
FROM [BCMPWMT].[CUST_EMAIL]) S
where email_id = 343970302

select count(*) from DIM_CUST_EMAIL_SQL_IN1563 T left join 
(select 
IIF(EMAIL_ID IS NULL OR EMAIL_ID = 'NULL',101 , cast(ltrim(rtrim(EMAIL_ID)) as bigint)) EMAIL_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101 , cast(ltrim(rtrim(Tenant_Org_id)) as int)) TENANT_ORG_ID,
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101 , cast(ltrim(rtrim(cntct_type_id)) as int)) CNTCT_TYPE_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101 , cast(ltrim(rtrim(Data_src_id)) as int)) DATA_SRC_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN  = 'NULL','N/A', cast(ltrim(rtrim(Deltd_yn)) as varchar)) DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900' , cast(ltrim(rtrim(Cre_Dt))as Date)) CRE_DT,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900', cast(ltrim(rtrim(Upd_ts))as Date)) UPD_TS
FROM [BCMPWMT].[CUST_EMAIL]) S
ON T.EMAIL_ID = S.EMAIL_ID
WHERE S.EMAIL_ID IS NULL AND 
(T.TENANT_ORG_ID <> S.TENANT_ORG_ID OR T.CNTCT_TYPE_ID <> S.CNTCT_TYPE_ID OR T.DATA_SRC_ID <> S.DATA_SRC_ID
OR T.DELTD_YN <> S.DELTD_YN OR T.CRE_DT <> S.CRE_DT OR T.CRE_DT <> S.CRE_DT)

---------------------------------------------------------------------------------------------------------

select * from DIM_CUST_PHONE_SQL_IN1563

select count(*) from DIM_CUST_PHONE_SQL_IN1563

select count(*) from 
(SELECT 
IIF(PHONE_ID IS NULL OR PHONE_ID = 'NULL',101, CAST(ltrim(rtrim(PHONE_ID)) as bigint)) PHONE_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CAST(ltrim(rtrim(TENANT_ORG_ID)) as int)) TENANT_ORG_ID,
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101, CAST(ltrim(rtrim(CNTCT_TYPE_ID)) as bigint)) CNTCT_TYPE_ID,
IIF(SRC_PHONE_ID IS NULL OR SRC_PHONE_ID = 'NULL','N/A', ltrim(rtrim(Src_phone_id))) SRC_PHONE_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101,cast(ltrim(rtrim(Data_src_id)) as int)) DATA_SRC_ID,
IIF(AREA_CD IS NULL OR AREA_CD = 'NULL','N/A', ltrim(rtrim(AREA_CD))) AREA_CD,
IIF(CNTRY_CD IS NULL OR CNTRY_CD = 'NULL','N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(EXTN IS NULL OR  EXTN = 'NULL','N/A', ltrim(rtrim(EXTN))) EXTN,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900', cast(ltrim(rtrim(CRE_DT))as Date)) CRE_DT,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A', cast(ltrim(rtrim(Deltd_yn)) as char)) DELTD_YN,
IIF(Upd_ts IS NULL OR Upd_ts = 'NULL', '01/01/1900', cast(ltrim(rtrim(Upd_ts))as Datetime)) Upd_ts
FROM [BCMPWMT].[CUST_PHONE]) S

SELECT DATA_SRC_ID,COUNT(*) FROM DIM_CUST_PHONE_SQL_IN1563
GROUP BY DATA_SRC_ID

SELECT DATA_SRC_ID,COUNT(*) FROM 
(SELECT 
IIF(PHONE_ID IS NULL OR PHONE_ID = 'NULL',101, CAST(ltrim(rtrim(PHONE_ID)) as bigint)) PHONE_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CAST(ltrim(rtrim(TENANT_ORG_ID)) as int)) TENANT_ORG_ID,
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101, CAST(ltrim(rtrim(CNTCT_TYPE_ID)) as bigint)) CNTCT_TYPE_ID,
IIF(SRC_PHONE_ID IS NULL OR SRC_PHONE_ID = 'NULL','N/A', ltrim(rtrim(Src_phone_id))) SRC_PHONE_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101,cast(ltrim(rtrim(Data_src_id)) as int)) DATA_SRC_ID,
IIF(AREA_CD IS NULL OR AREA_CD = 'NULL','N/A', ltrim(rtrim(AREA_CD))) AREA_CD,
IIF(CNTRY_CD IS NULL OR CNTRY_CD = 'NULL','N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(EXTN IS NULL OR  EXTN = 'NULL','N/A', ltrim(rtrim(EXTN))) EXTN,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900', cast(ltrim(rtrim(CRE_DT))as Date)) CRE_DT,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A', cast(ltrim(rtrim(Deltd_yn)) as char)) DELTD_YN,
IIF(Upd_ts IS NULL OR Upd_ts = 'NULL', '01/01/1900', cast(ltrim(rtrim(Upd_ts))as Datetime)) Upd_ts
FROM [BCMPWMT].[CUST_PHONE]) S
GROUP BY DATA_SRC_ID

SELECT COUNT(*) FROM DIM_CUST_PHONE_SQL_IN1563
GROUP BY PHONE_ID
HAVING COUNT(*) > 1

SELECT PHONE_ID,TENANT_ORG_ID,SRC_PHONE_ID,DATA_SRC_ID,CNTRY_CD
FROM DIM_CUST_PHONE_SQL_IN1563
WHERE PHONE_ID = 2244187157

SELECT PHONE_ID,TENANT_ORG_ID,SRC_PHONE_ID,DATA_SRC_ID,CNTRY_CD
FROM (SELECT 
IIF(PHONE_ID IS NULL OR PHONE_ID = 'NULL',101, CAST(ltrim(rtrim(PHONE_ID)) as bigint)) PHONE_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CAST(ltrim(rtrim(TENANT_ORG_ID)) as int)) TENANT_ORG_ID,
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101, CAST(ltrim(rtrim(CNTCT_TYPE_ID)) as bigint)) CNTCT_TYPE_ID,
IIF(SRC_PHONE_ID IS NULL OR SRC_PHONE_ID = 'NULL','N/A', ltrim(rtrim(Src_phone_id))) SRC_PHONE_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101,cast(ltrim(rtrim(Data_src_id)) as int)) DATA_SRC_ID,
IIF(AREA_CD IS NULL OR AREA_CD = 'NULL','N/A', ltrim(rtrim(AREA_CD))) AREA_CD,
IIF(CNTRY_CD IS NULL OR CNTRY_CD = 'NULL','N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(EXTN IS NULL OR  EXTN = 'NULL','N/A', ltrim(rtrim(EXTN))) EXTN,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900', cast(ltrim(rtrim(CRE_DT))as Date)) CRE_DT,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A', cast(ltrim(rtrim(Deltd_yn)) as char)) DELTD_YN,
IIF(Upd_ts IS NULL OR Upd_ts = 'NULL', '01/01/1900', cast(ltrim(rtrim(Upd_ts))as Datetime)) Upd_ts
FROM [BCMPWMT].[CUST_PHONE]) S
WHERE PHONE_ID = 2244187157

SELECT COUNT(*) FROM DIM_CUST_PHONE_SQL_IN1563 T LEFT JOIN
(SELECT 
IIF(PHONE_ID IS NULL OR PHONE_ID = 'NULL',101, CAST(ltrim(rtrim(PHONE_ID)) as bigint)) PHONE_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CAST(ltrim(rtrim(TENANT_ORG_ID)) as int)) TENANT_ORG_ID,
IIF(CNTCT_TYPE_ID IS NULL OR CNTCT_TYPE_ID = 'NULL',101, CAST(ltrim(rtrim(CNTCT_TYPE_ID)) as bigint)) CNTCT_TYPE_ID,
IIF(SRC_PHONE_ID IS NULL OR SRC_PHONE_ID = 'NULL','N/A', ltrim(rtrim(Src_phone_id))) SRC_PHONE_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101,cast(ltrim(rtrim(Data_src_id)) as int)) DATA_SRC_ID,
IIF(AREA_CD IS NULL OR AREA_CD = 'NULL','N/A', ltrim(rtrim(AREA_CD))) AREA_CD,
IIF(CNTRY_CD IS NULL OR CNTRY_CD = 'NULL','N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(EXTN IS NULL OR  EXTN = 'NULL','N/A', ltrim(rtrim(EXTN))) EXTN,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL', '01/01/1900', cast(ltrim(rtrim(CRE_DT))as Date)) CRE_DT,
IIF(DELTD_YN IS NULL OR DELTD_YN = 'NULL', 'N/A', cast(ltrim(rtrim(Deltd_yn)) as char)) DELTD_YN,
IIF(Upd_ts IS NULL OR Upd_ts = 'NULL', '01/01/1900', cast(ltrim(rtrim(Upd_ts))as Datetime)) Upd_ts
FROM [BCMPWMT].[CUST_PHONE]) S
ON T.PHONE_ID = S.PHONE_ID
WHERE S.PHONE_ID IS NULL AND
(T.TENANT_ORG_ID <> S.TENANT_ORG_ID OR T.CNTCT_TYPE_ID <> S.CNTCT_TYPE_ID OR T.SRC_PHONE_ID <> S.SRC_PHONE_ID OR T.DATA_SRC_ID <>
S.DATA_SRC_ID OR T.AREA_CD <> S.AREA_CD OR T.CNTRY_CD <> S.CNTRY_CD OR T.EXTN <> S.EXTN OR T.CRE_DT <> S.CRE_DT OR T.DELTD_YN <> S.DELTD_YN)

-------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM Dim_FULFMT_TYPE_LKP_SQL_IN1563

SELECT COUNT(*) FROM Dim_FULFMT_TYPE_LKP_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT DISTINCT
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID = 'NULL',101,cast(ltrim(rtrim(FULFMT_TYPE_ID)) AS INT)) FULFMT_TYPE_ID,
IIF(FULFMT_TYPE_CD IS NULL OR  FULFMT_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_CD))) FULFMT_TYPE_CD,
IIF(FULFMT_TYPE_DESC IS NULL OR FULFMT_TYPE_DESC = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_DESC))) FULFMT_TYPE_DESC,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT ))AS DATE)) CRE_DT,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL',CAST('01/01/1900' AS NVARCHAR),CAST(FORMAT(CAST(UPD_TS AS DATETIME),'ddmmyyyy')AS NVARCHAR)) UPD_TS
FROM [BCMPWMT].[FULFMT_TYPE_LKP]) S

SELECT FULFMT_TYPE_DESC,COUNT(*) FROM Dim_FULFMT_TYPE_LKP_SQL_IN1563 GROUP BY FULFMT_TYPE_DESC

SELECT FULFMT_TYPE_DESC,COUNT(*) FROM 
(SELECT DISTINCT
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID = 'NULL',101,cast(ltrim(rtrim(FULFMT_TYPE_ID)) AS INT)) FULFMT_TYPE_ID,
IIF(FULFMT_TYPE_CD IS NULL OR  FULFMT_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_CD))) FULFMT_TYPE_CD,
IIF(FULFMT_TYPE_DESC IS NULL OR FULFMT_TYPE_DESC = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_DESC))) FULFMT_TYPE_DESC,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT ))AS DATE)) CRE_DT,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL',CAST('01/01/1900' AS NVARCHAR),CAST(FORMAT(CAST(UPD_TS AS DATETIME),'ddmmyyyy')AS NVARCHAR)) UPD_TS
FROM [BCMPWMT].[FULFMT_TYPE_LKP]) S
GROUP BY FULFMT_TYPE_DESC

SELECT COUNT(*) FROM Dim_FULFMT_TYPE_LKP_SQL_IN1563
GROUP BY FULFMT_TYPE_ID
HAVING COUNT(*) > 1

SELECT FULFMT_TYPE_ID,FULFMT_TYPE_CD,FULFMT_TYPE_DESC,CRE_DT,UPD_TS
FROM Dim_FULFMT_TYPE_LKP_SQL_IN1563
WHERE FULFMT_TYPE_CD = 'SHIPTOHOME'

SELECT FULFMT_TYPE_ID,FULFMT_TYPE_CD,FULFMT_TYPE_DESC,CRE_DT,UPD_TS
FROM (SELECT DISTINCT
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID = 'NULL',101,cast(ltrim(rtrim(FULFMT_TYPE_ID)) AS INT)) FULFMT_TYPE_ID,
IIF(FULFMT_TYPE_CD IS NULL OR  FULFMT_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_CD))) FULFMT_TYPE_CD,
IIF(FULFMT_TYPE_DESC IS NULL OR FULFMT_TYPE_DESC = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_DESC))) FULFMT_TYPE_DESC,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT ))AS DATE)) CRE_DT,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL',CAST('01/01/1900' AS NVARCHAR),CAST(FORMAT(CAST(UPD_TS AS DATETIME),'ddMMyyyy')AS NVARCHAR)) UPD_TS
FROM [BCMPWMT].[FULFMT_TYPE_LKP]) S
WHERE FULFMT_TYPE_CD = 'SHIPTOHOME'

SELECT COUNT(*) FROM Dim_FULFMT_TYPE_LKP_SQL_IN1563 T LEFT JOIN
(SELECT DISTINCT
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID = 'NULL',101,cast(ltrim(rtrim(FULFMT_TYPE_ID)) AS INT)) FULFMT_TYPE_ID,
IIF(FULFMT_TYPE_CD IS NULL OR  FULFMT_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_CD))) FULFMT_TYPE_CD,
IIF(FULFMT_TYPE_DESC IS NULL OR FULFMT_TYPE_DESC = 'NULL','N/A', LTRIM(RTRIM(FULFMT_TYPE_DESC))) FULFMT_TYPE_DESC,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT ))AS DATE)) CRE_DT,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL',CAST('01/01/1900' AS NVARCHAR),CAST(FORMAT(CAST(UPD_TS AS DATETIME),'ddMMyyyy')AS NVARCHAR)) UPD_TS
FROM [BCMPWMT].[FULFMT_TYPE_LKP]) S
ON T.FULFMT_TYPE_ID = S.FULFMT_TYPE_ID
WHERE S.FULFMT_TYPE_ID IS NULL AND
(T.FULFMT_TYPE_CD <> S.FULFMT_TYPE_CD OR T.FULFMT_TYPE_DESC <> S.FULFMT_TYPE_DESC OR T.CRE_DT <> S.CRE_DT OR T.UPD_TS <> S.UPD_TS)

--------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM Dim_ORG_TYPE_LKP_SQL_IN1563

SELECT COUNT(*) FROM  Dim_ORG_TYPE_LKP_SQL_IN1563

SELECT COUNT(*) FROM
(SELECT 
IIF(ORG_TYPE_ID IS NULL OR ORG_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORG_TYPE_ID)))) ORG_TYPE_ID,
IIF(ORG_TYPE_CD IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_CD))) ORG_TYPE_CD,
IIF(ORG_TYPE_DESC IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_DESC))) ORG_TYPE_DESC,
IIF(ORG_TYPE_NM IS NULL OR ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(ORG_TYPE_NM))) ORG_TYPE_NM,
IIF(PARENT_ORG_TYPE_NM IS NULL OR PARENT_ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_NM))) PARENT_ORG_TYPE_NM,
IIF(PARENT_ORG_TYPE_CD IS NULL OR PARENT_ORG_TYPE_CD ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_CD))) PARENT_ORG_TYPE_CD,
IIF(CRE_DT IS NULL OR CRE_DT ='NULL','01/01/1900', CONVERT(DATE,LTRIM(RTRIM(CRE_DT)))) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',LTRIM(RTRIM(CRE_USER))) CRE_USER,
NULL AS History_1,
NULL AS History_2
FROM [BCMPWMT].[ORG_TYPE_LKP]) S

select parent_org_type_nm,count(*) from Dim_ORG_TYPE_LKP_SQL_IN1563 group by parent_org_type_nm

select parent_org_type_nm,count(*) from
(SELECT 
IIF(ORG_TYPE_ID IS NULL OR ORG_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORG_TYPE_ID)))) ORG_TYPE_ID,
IIF(ORG_TYPE_CD IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_CD))) ORG_TYPE_CD,
IIF(ORG_TYPE_DESC IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_DESC))) ORG_TYPE_DESC,
IIF(ORG_TYPE_NM IS NULL OR ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(ORG_TYPE_NM))) ORG_TYPE_NM,
IIF(PARENT_ORG_TYPE_NM IS NULL OR PARENT_ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_NM))) PARENT_ORG_TYPE_NM,
IIF(PARENT_ORG_TYPE_CD IS NULL OR PARENT_ORG_TYPE_CD ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_CD))) PARENT_ORG_TYPE_CD,
IIF(CRE_DT IS NULL OR CRE_DT ='NULL','01/01/1900', CONVERT(DATE,LTRIM(RTRIM(CRE_DT)))) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',LTRIM(RTRIM(CRE_USER))) CRE_USER,
NULL AS History_1,
NULL AS History_2
FROM [BCMPWMT].[ORG_TYPE_LKP]) S
group by parent_org_type_nm

select count(*) from Dim_ORG_TYPE_LKP_SQL_IN1563
group by org_type_id
having count(*) >1

select org_type_id,org_type_cd,org_type_desc,org_type_nm,parent_org_type_nm
from Dim_ORG_TYPE_LKP_SQL_IN1563
where parent_org_type_nm = 'Root'

select org_type_id,org_type_cd,org_type_desc,org_type_nm,parent_org_type_nm
from (SELECT 
IIF(ORG_TYPE_ID IS NULL OR ORG_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORG_TYPE_ID)))) ORG_TYPE_ID,
IIF(ORG_TYPE_CD IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_CD))) ORG_TYPE_CD,
IIF(ORG_TYPE_DESC IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_DESC))) ORG_TYPE_DESC,
IIF(ORG_TYPE_NM IS NULL OR ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(ORG_TYPE_NM))) ORG_TYPE_NM,
IIF(PARENT_ORG_TYPE_NM IS NULL OR PARENT_ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_NM))) PARENT_ORG_TYPE_NM,
IIF(PARENT_ORG_TYPE_CD IS NULL OR PARENT_ORG_TYPE_CD ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_CD))) PARENT_ORG_TYPE_CD,
IIF(CRE_DT IS NULL OR CRE_DT ='NULL','01/01/1900', CONVERT(DATE,LTRIM(RTRIM(CRE_DT)))) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',LTRIM(RTRIM(CRE_USER))) CRE_USER,
NULL AS History_1,
NULL AS History_2
FROM [BCMPWMT].[ORG_TYPE_LKP]) S
where parent_org_type_nm = 'Root'

select count(*) from Dim_ORG_TYPE_LKP_SQL_IN1563 T left join 
(SELECT 
IIF(ORG_TYPE_ID IS NULL OR ORG_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORG_TYPE_ID)))) ORG_TYPE_ID,
IIF(ORG_TYPE_CD IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_CD))) ORG_TYPE_CD,
IIF(ORG_TYPE_DESC IS NULL OR ORG_TYPE_DESC ='NULL','N/A',LTRIM(RTRIM(ORG_TYPE_DESC))) ORG_TYPE_DESC,
IIF(ORG_TYPE_NM IS NULL OR ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(ORG_TYPE_NM))) ORG_TYPE_NM,
IIF(PARENT_ORG_TYPE_NM IS NULL OR PARENT_ORG_TYPE_NM ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_NM))) PARENT_ORG_TYPE_NM,
IIF(PARENT_ORG_TYPE_CD IS NULL OR PARENT_ORG_TYPE_CD ='NULL','N/A', LTRIM(RTRIM(PARENT_ORG_TYPE_CD))) PARENT_ORG_TYPE_CD,
IIF(CRE_DT IS NULL OR CRE_DT ='NULL','01/01/1900', CONVERT(DATE,LTRIM(RTRIM(CRE_DT)))) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',LTRIM(RTRIM(CRE_USER))) CRE_USER,
NULL AS History_1,
NULL AS History_2
FROM [BCMPWMT].[ORG_TYPE_LKP]) S
ON T.ORG_TYPE_ID = S.ORG_TYPE_ID
WHERE S.ORG_TYPE_ID IS NULL AND
(T.ORG_TYPE_CD <> S.ORG_TYPE_CD OR T.ORG_TYPE_DESC <> S.ORG_TYPE_DESC OR T.ORG_TYPE_NM <> S.ORG_TYPE_NM OR T.PARENT_ORG_TYPE_NM <>
S.PARENT_ORG_TYPE_NM OR T.PARENT_ORG_TYPE_CD <> S.PARENT_ORG_TYPE_CD OR T.CRE_DT <> S.CRE_DT)

-------------------------------------------------------------------------------------------------------------------------

SELECT * FROM Dim_RSN_TYPE_LKP_SQL_IN1563

SELECT COUNT(*) FROM Dim_RSN_TYPE_LKP_SQL_IN1563

SELECT COUNT(*) FROM
(SELECT
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(RSN_TYPE_ID)))) RSN_TYPE_ID,
IIF(RSN_TYPE_CD IS NULL OR RSN_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(RSN_TYPE_CD))) RSN_TYPE_CD,
IIF(RSN_TYPE_DESC IS NULL OR RSN_TYPE_DESC = 'NULL','N/A',  LTRIM(RTRIM(RSN_TYPE_DESC))) RSN_TYPE_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CRE_TS)))) CRE_TS,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A', LTRIM(RTRIM(CRE_USER))) CRE_USER
FROM [BCMPWMT].[RSN_TYPE_LKP]) S

SELECT  RSN_TYPE_CD,COUNT(*) FROM Dim_RSN_TYPE_LKP_SQL_IN1563 GROUP BY RSN_TYPE_CD

SELECT  RSN_TYPE_CD,COUNT(*) FROM
(SELECT
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(RSN_TYPE_ID)))) RSN_TYPE_ID,
IIF(RSN_TYPE_CD IS NULL OR RSN_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(RSN_TYPE_CD))) RSN_TYPE_CD,
IIF(RSN_TYPE_DESC IS NULL OR RSN_TYPE_DESC = 'NULL','N/A',  LTRIM(RTRIM(RSN_TYPE_DESC))) RSN_TYPE_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CRE_TS)))) CRE_TS,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A', LTRIM(RTRIM(CRE_USER))) CRE_USER
FROM [BCMPWMT].[RSN_TYPE_LKP]) S
GROUP BY RSN_TYPE_CD

select count(*) from Dim_RSN_TYPE_LKP_SQL_IN1563
group by RSN_TYPE_ID
having count(*) >1

SELECT RSN_TYPE_ID,RSN_TYPE_CD,RSN_TYPE_DESC,CRE_TS,CRE_USER
FROM Dim_RSN_TYPE_LKP_SQL_IN1563
WHERE RSN_TYPE_CD = 'CNCL'

SELECT RSN_TYPE_ID,RSN_TYPE_CD,RSN_TYPE_DESC,CRE_TS,CRE_USER
FROM (SELECT
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(RSN_TYPE_ID)))) RSN_TYPE_ID,
IIF(RSN_TYPE_CD IS NULL OR RSN_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(RSN_TYPE_CD))) RSN_TYPE_CD,
IIF(RSN_TYPE_DESC IS NULL OR RSN_TYPE_DESC = 'NULL','N/A',  LTRIM(RTRIM(RSN_TYPE_DESC))) RSN_TYPE_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CRE_TS)))) CRE_TS,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A', LTRIM(RTRIM(CRE_USER))) CRE_USER
FROM [BCMPWMT].[RSN_TYPE_LKP]) S
WHERE RSN_TYPE_CD = 'CNCL'

SELECT COUNT(*) FROM Dim_RSN_TYPE_LKP_SQL_IN1563 T LEFT JOIN
(SELECT
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101,CONVERT(INT,LTRIM(RTRIM(RSN_TYPE_ID)))) RSN_TYPE_ID,
IIF(RSN_TYPE_CD IS NULL OR RSN_TYPE_CD = 'NULL','N/A', LTRIM(RTRIM(RSN_TYPE_CD))) RSN_TYPE_CD,
IIF(RSN_TYPE_DESC IS NULL OR RSN_TYPE_DESC = 'NULL','N/A',  LTRIM(RTRIM(RSN_TYPE_DESC))) RSN_TYPE_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CRE_TS)))) CRE_TS,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A', LTRIM(RTRIM(CRE_USER))) CRE_USER
FROM [BCMPWMT].[RSN_TYPE_LKP]) S
ON T.RSN_TYPE_ID = S.RSN_TYPE_ID
WHERE S.RSN_TYPE_ID IS NULL AND 
(T.RSN_TYPE_ID <> S.RSN_TYPE_ID OR T.RSN_TYPE_CD <> S.RSN_TYPE_CD OR T.RSN_TYPE_DESC <> S.RSN_TYPE_DESC OR T.CRE_TS <> S.CRE_TS
OR T.CRE_USER <> S.CRE_USER)

-------------------------------------------------------------------------------------------------------------------------
SELECT * FROM dim_RSN_LKP_SQL_IN1563

SELECT COUNT(*) FROM dim_RSN_LKP_SQL_IN1563
SELECT COUNT(*) FROM 
(SELECT
IIF(RSN_ID IS NULL OR RSN_ID = 'NULL',101, cast(ltrim(rtrim(rsn_id)) as INT)) RSN_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, cast(ltrim(rtrim(tenant_org_id))as INT)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id)) as INT)) DATA_SRC_ID,
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id))as INT)) RSN_TYPE_ID,
IIF(RSN_CD IS NULL OR  RSN_CD = 'NULL' OR RSN_CD LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(rsn_cd))as int)) RSN_CD,
IIF(SRC_RSN_ID IS NULL OR SRC_RSN_ID = 'NULL' OR SRC_RSN_ID LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(src_rsn_id))as INT)) SRC_RSN_ID,
IIF(RSN_DESC IS NULL OR RSN_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_desc))) RSN_DESC,
IIF(RSN_LONG_DESC IS NULL OR RSN_LONG_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_long_desc))) RSN_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_ts))as datetime)) CRE_TS,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CRE_USER) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',UPD_USER) UPD_USER
FROM [BCMPWMT].[RSN_LKP]) S

SELECT RSN_TYPE_ID,COUNT(*) FROM dim_RSN_LKP_SQL_IN1563 GROUP BY RSN_TYPE_ID

SELECT RSN_TYPE_ID,COUNT(*) FROM 
(SELECT
IIF(RSN_ID IS NULL OR RSN_ID = 'NULL',101, cast(ltrim(rtrim(rsn_id)) as INT)) RSN_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, cast(ltrim(rtrim(tenant_org_id))as INT)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id)) as INT)) DATA_SRC_ID,
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id))as INT)) RSN_TYPE_ID,
IIF(RSN_CD IS NULL OR  RSN_CD = 'NULL' OR RSN_CD LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(rsn_cd))as int)) RSN_CD,
IIF(SRC_RSN_ID IS NULL OR SRC_RSN_ID = 'NULL' OR SRC_RSN_ID LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(src_rsn_id))as INT)) SRC_RSN_ID,
IIF(RSN_DESC IS NULL OR RSN_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_desc))) RSN_DESC,
IIF(RSN_LONG_DESC IS NULL OR RSN_LONG_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_long_desc))) RSN_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_ts))as datetime)) CRE_TS,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CRE_USER) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',UPD_USER) UPD_USER
FROM [BCMPWMT].[RSN_LKP]) S
GROUP BY RSN_TYPE_ID

select count(*) from dim_RSN_LKP_SQL_IN1563
group by RSN_ID
having count(*) >1

SELECT RSN_ID,TENANT_ORG_ID,RSN_CD,SRC_RSN_ID,RSN_DESC
FROM dim_RSN_LKP_SQL_IN1563
WHERE RSN_ID = 189

SELECT RSN_ID,TENANT_ORG_ID,RSN_CD,SRC_RSN_ID,RSN_DESC
FROM (SELECT
IIF(RSN_ID IS NULL OR RSN_ID = 'NULL',101, cast(ltrim(rtrim(rsn_id)) as INT)) RSN_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, cast(ltrim(rtrim(tenant_org_id))as INT)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id)) as INT)) DATA_SRC_ID,
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id))as INT)) RSN_TYPE_ID,
IIF(RSN_CD IS NULL OR  RSN_CD = 'NULL' OR RSN_CD LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(rsn_cd))as int)) RSN_CD,
IIF(SRC_RSN_ID IS NULL OR SRC_RSN_ID = 'NULL' OR SRC_RSN_ID LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(src_rsn_id))as INT)) SRC_RSN_ID,
IIF(RSN_DESC IS NULL OR RSN_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_desc))) RSN_DESC,
IIF(RSN_LONG_DESC IS NULL OR RSN_LONG_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_long_desc))) RSN_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_ts))as datetime)) CRE_TS,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CRE_USER) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',UPD_USER) UPD_USER
FROM [BCMPWMT].[RSN_LKP]) S
WHERE RSN_ID = 189

SELECT COUNT(*) FROM dim_RSN_LKP_SQL_IN1563 T LEFT JOIN
(SELECT
IIF(RSN_ID IS NULL OR RSN_ID = 'NULL',101, cast(ltrim(rtrim(rsn_id)) as INT)) RSN_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, cast(ltrim(rtrim(tenant_org_id))as INT)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id)) as INT)) DATA_SRC_ID,
IIF(RSN_TYPE_ID IS NULL OR RSN_TYPE_ID = 'NULL',101, cast(ltrim(rtrim(data_src_id))as INT)) RSN_TYPE_ID,
IIF(RSN_CD IS NULL OR  RSN_CD = 'NULL' OR RSN_CD LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(rsn_cd))as int)) RSN_CD,
IIF(SRC_RSN_ID IS NULL OR SRC_RSN_ID = 'NULL' OR SRC_RSN_ID LIKE '%[a-zA-Z]%',101, cast(ltrim(rtrim(src_rsn_id))as INT)) SRC_RSN_ID,
IIF(RSN_DESC IS NULL OR RSN_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_desc))) RSN_DESC,
IIF(RSN_LONG_DESC IS NULL OR RSN_LONG_DESC ='NULL', 'N/A', ltrim(rtrim(rsn_long_desc))) RSN_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_ts))as datetime)) CRE_TS,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CRE_USER) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(upd_ts))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',UPD_USER) UPD_USER
FROM [BCMPWMT].[RSN_LKP]) S
ON T.RSN_ID = S.RSN_ID
WHERE S.RSN_ID IS  NULL AND
(T.TENANT_ORG_ID <> S.TENANT_ORG_ID OR T.DATA_SRC_ID <> S.DATA_SRC_ID OR T.RSN_TYPE_ID <> S.RSN_TYPE_ID OR T.RSN_CD <> S.RSN_CD
OR T.SRC_RSN_ID <> S.SRC_RSN_ID OR T.RSN_DESC <> S.RSN_DESC OR T.RSN_LONG_DESC <> S.RSN_LONG_DESC OR T.CRE_TS <> S.CRE_TS
OR T.CRE_USER <> S.CRE_USER OR T.UPD_TS <> S.UPD_TS OR T.UPD_USER <> S.UPD_USER)

-------------------------------------------------------------------------------------------------------------------------

SELECT * FROM dim_prod_SQL_IN1563

SELECT COUNT(*) FROM dim_prod_SQL_IN1563

SELECT COUNT(*) FROM
(select 
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID)) as int)) CATLG_ITEM_ID,
IIF(PRMRY_DSTRBTR_NM IS NULL OR PRMRY_DSTRBTR_NM = 'NULL','N/A',ltrim(rtrim(PRMRY_DSTRBTR_NM))) PRMRY_DSTRBTR_NM,
IIF(PRMRY_VEND_NUM IS NULL OR  PRMRY_VEND_NUM = 'NULL',101,CAST(ltrim(rtrim(PRMRY_VEND_NUM)) AS INT)) PRMRY_VEND_NUM,
IIF(SRC_IMS_CRE_TS IS NULL OR SRC_IMS_CRE_TS = 'NULL','N/A',SRC_IMS_CRE_TS) SRC_IMS_CRE_TS,
IIF(SRC_IMS_MODFD_TS IS NULL OR SRC_IMS_MODFD_TS = 'NULL','N/A',SRC_IMS_MODFD_TS) SRC_IMS_MODFD_TS,
IIF(VEND_PACK_QTY IS NULL OR VEND_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(VEND_PACK_QTY)) as int)) VEND_PACK_QTY,
IIF(WHSE_PACK_QTY IS NULL OR WHSE_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(WHSE_PACK_QTY)) as int)) WHSE_PACK_QTY,
IIF(CURR_PRICE_MODFD_TS IS NULL OR CURR_PRICE_MODFD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(CURR_PRICE_MODFD_TS))as datetime)) CURR_PRICE_MODFD_TS,
IIF(AMT_ITEM_COST IS NULL OR AMT_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(AMT_ITEM_COST))as decimal)) AMT_ITEM_COST,
IIF(AMT_BASE_ITEM_PRICE IS NULL OR AMT_BASE_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_ITEM_PRICE))as decimal)) AMT_BASE_ITEM_PRICE,
IIF(AMT_BASE_SUGG_PRICE IS NULL OR AMT_BASE_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_SUGG_PRICE))as decimal)) AMT_BASE_SUGG_PRICE,
IIF(AMT_SUGG_PRICE IS NULL OR AMT_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_SUGG_PRICE))as decimal)) AMT_SUGG_PRICE,
IIF(MIN_ITEM_COST IS NULL OR MIN_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(MIN_ITEM_COST))as decimal)) MIN_ITEM_COST,
IIF(ORIG_PRICE IS NULL OR ORIG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_PRICE))as decimal)) ORIG_PRICE,
IIF(ORIG_ITEM_PRICE IS NULL OR ORIG_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_ITEM_PRICE))as decimal)) ORIG_ITEM_PRICE,
IIF(PROD_NM IS NULL OR PROD_NM = 'NULL','N/A',LTRIM(RTRIM(PROD_NM))) PROD_NM,
IIF(PROD_HT IS NULL OR PROD_HT = 'NULL' OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_HT))as decimal)) PROD_HT,
IIF(PROD_WT IS NULL OR PROD_WT = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WT))as decimal)) PROD_WT,
IIF(PROD_LEN IS NULL OR PROD_LEN = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_LEN))as decimal)) PROD_LEN,
IIF(PROD_WDTH IS NULL OR PROD_WDTH = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WDTH))as decimal)) PROD_WDTH,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_dt))as date)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',cast(ltrim(rtrim(CRE_USER))as VARCHAR)) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%','01/01/1900',cast(ltrim(rtrim(UPD_TS))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',cast(ltrim(rtrim(UPD_USER))as VARCHAR)) UPD_USER
FROM [BCMPWMT].[PROD]) S

SELECT SRC_IMS_CRE_TS,COUNT(*) FROM dim_prod_SQL_IN1563 GROUP BY SRC_IMS_CRE_TS

SELECT SRC_IMS_CRE_TS,COUNT(*) FROM
(select 
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID)) as int)) CATLG_ITEM_ID,
IIF(PRMRY_DSTRBTR_NM IS NULL OR PRMRY_DSTRBTR_NM = 'NULL','N/A',ltrim(rtrim(PRMRY_DSTRBTR_NM))) PRMRY_DSTRBTR_NM,
IIF(PRMRY_VEND_NUM IS NULL OR  PRMRY_VEND_NUM = 'NULL',101,CAST(ltrim(rtrim(PRMRY_VEND_NUM)) AS INT)) PRMRY_VEND_NUM,
IIF(SRC_IMS_CRE_TS IS NULL OR SRC_IMS_CRE_TS = 'NULL','N/A',SRC_IMS_CRE_TS) SRC_IMS_CRE_TS,
IIF(SRC_IMS_MODFD_TS IS NULL OR SRC_IMS_MODFD_TS = 'NULL','N/A',SRC_IMS_MODFD_TS) SRC_IMS_MODFD_TS,
IIF(VEND_PACK_QTY IS NULL OR VEND_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(VEND_PACK_QTY)) as int)) VEND_PACK_QTY,
IIF(WHSE_PACK_QTY IS NULL OR WHSE_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(WHSE_PACK_QTY)) as int)) WHSE_PACK_QTY,
IIF(CURR_PRICE_MODFD_TS IS NULL OR CURR_PRICE_MODFD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(CURR_PRICE_MODFD_TS))as datetime)) CURR_PRICE_MODFD_TS,
IIF(AMT_ITEM_COST IS NULL OR AMT_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(AMT_ITEM_COST))as decimal)) AMT_ITEM_COST,
IIF(AMT_BASE_ITEM_PRICE IS NULL OR AMT_BASE_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_ITEM_PRICE))as decimal)) AMT_BASE_ITEM_PRICE,
IIF(AMT_BASE_SUGG_PRICE IS NULL OR AMT_BASE_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_SUGG_PRICE))as decimal)) AMT_BASE_SUGG_PRICE,
IIF(AMT_SUGG_PRICE IS NULL OR AMT_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_SUGG_PRICE))as decimal)) AMT_SUGG_PRICE,
IIF(MIN_ITEM_COST IS NULL OR MIN_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(MIN_ITEM_COST))as decimal)) MIN_ITEM_COST,
IIF(ORIG_PRICE IS NULL OR ORIG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_PRICE))as decimal)) ORIG_PRICE,
IIF(ORIG_ITEM_PRICE IS NULL OR ORIG_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_ITEM_PRICE))as decimal)) ORIG_ITEM_PRICE,
IIF(PROD_NM IS NULL OR PROD_NM = 'NULL','N/A',LTRIM(RTRIM(PROD_NM))) PROD_NM,
IIF(PROD_HT IS NULL OR PROD_HT = 'NULL' OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_HT))as decimal)) PROD_HT,
IIF(PROD_WT IS NULL OR PROD_WT = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WT))as decimal)) PROD_WT,
IIF(PROD_LEN IS NULL OR PROD_LEN = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_LEN))as decimal)) PROD_LEN,
IIF(PROD_WDTH IS NULL OR PROD_WDTH = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WDTH))as decimal)) PROD_WDTH,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_dt))as date)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',cast(ltrim(rtrim(CRE_USER))as VARCHAR)) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%','01/01/1900',cast(ltrim(rtrim(UPD_TS))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',cast(ltrim(rtrim(UPD_USER))as VARCHAR)) UPD_USER
FROM [BCMPWMT].[PROD]) S
GROUP BY SRC_IMS_CRE_TS

SELECT COUNT(*) FROM dim_prod_SQL_IN1563
GROUP BY CATLG_ITEM_ID
HAVING COUNT(*) > 1

SELECT CATLG_ITEM_ID,PRMRY_DSTRBTR_NM,PRMRY_VEND_NUM,VEND_PACK_QTY,WHSE_PACK_QTY
FROM dim_prod_SQL_IN1563
WHERE CATLG_ITEM_ID = 45826172

SELECT CATLG_ITEM_ID,PRMRY_DSTRBTR_NM,PRMRY_VEND_NUM,VEND_PACK_QTY,WHSE_PACK_QTY
FROM (select 
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID)) as int)) CATLG_ITEM_ID,
IIF(PRMRY_DSTRBTR_NM IS NULL OR PRMRY_DSTRBTR_NM = 'NULL','N/A',ltrim(rtrim(PRMRY_DSTRBTR_NM))) PRMRY_DSTRBTR_NM,
IIF(PRMRY_VEND_NUM IS NULL OR  PRMRY_VEND_NUM = 'NULL',101,CAST(ltrim(rtrim(PRMRY_VEND_NUM)) AS INT)) PRMRY_VEND_NUM,
IIF(SRC_IMS_CRE_TS IS NULL OR SRC_IMS_CRE_TS = 'NULL','N/A',SRC_IMS_CRE_TS) SRC_IMS_CRE_TS,
IIF(SRC_IMS_MODFD_TS IS NULL OR SRC_IMS_MODFD_TS = 'NULL','N/A',SRC_IMS_MODFD_TS) SRC_IMS_MODFD_TS,
IIF(VEND_PACK_QTY IS NULL OR VEND_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(VEND_PACK_QTY)) as int)) VEND_PACK_QTY,
IIF(WHSE_PACK_QTY IS NULL OR WHSE_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(WHSE_PACK_QTY)) as int)) WHSE_PACK_QTY,
IIF(CURR_PRICE_MODFD_TS IS NULL OR CURR_PRICE_MODFD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(CURR_PRICE_MODFD_TS))as datetime)) CURR_PRICE_MODFD_TS,
IIF(AMT_ITEM_COST IS NULL OR AMT_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(AMT_ITEM_COST))as decimal)) AMT_ITEM_COST,
IIF(AMT_BASE_ITEM_PRICE IS NULL OR AMT_BASE_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_ITEM_PRICE))as decimal)) AMT_BASE_ITEM_PRICE,
IIF(AMT_BASE_SUGG_PRICE IS NULL OR AMT_BASE_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_SUGG_PRICE))as decimal)) AMT_BASE_SUGG_PRICE,
IIF(AMT_SUGG_PRICE IS NULL OR AMT_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_SUGG_PRICE))as decimal)) AMT_SUGG_PRICE,
IIF(MIN_ITEM_COST IS NULL OR MIN_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(MIN_ITEM_COST))as decimal)) MIN_ITEM_COST,
IIF(ORIG_PRICE IS NULL OR ORIG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_PRICE))as decimal)) ORIG_PRICE,
IIF(ORIG_ITEM_PRICE IS NULL OR ORIG_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_ITEM_PRICE))as decimal)) ORIG_ITEM_PRICE,
IIF(PROD_NM IS NULL OR PROD_NM = 'NULL','N/A',LTRIM(RTRIM(PROD_NM))) PROD_NM,
IIF(PROD_HT IS NULL OR PROD_HT = 'NULL' OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_HT))as decimal)) PROD_HT,
IIF(PROD_WT IS NULL OR PROD_WT = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WT))as decimal)) PROD_WT,
IIF(PROD_LEN IS NULL OR PROD_LEN = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_LEN))as decimal)) PROD_LEN,
IIF(PROD_WDTH IS NULL OR PROD_WDTH = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WDTH))as decimal)) PROD_WDTH,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_dt))as date)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',cast(ltrim(rtrim(CRE_USER))as VARCHAR)) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%','01/01/1900',cast(ltrim(rtrim(UPD_TS))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',cast(ltrim(rtrim(UPD_USER))as VARCHAR)) UPD_USER
FROM [BCMPWMT].[PROD]) S
WHERE CATLG_ITEM_ID = 45826172

SELECT COUNT(*) FROM dim_prod_SQL_IN1563 T LEFT JOIN
(select 
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID)) as int)) CATLG_ITEM_ID,
IIF(PRMRY_DSTRBTR_NM IS NULL OR PRMRY_DSTRBTR_NM = 'NULL','N/A',ltrim(rtrim(PRMRY_DSTRBTR_NM))) PRMRY_DSTRBTR_NM,
IIF(PRMRY_VEND_NUM IS NULL OR  PRMRY_VEND_NUM = 'NULL',101,CAST(ltrim(rtrim(PRMRY_VEND_NUM)) AS INT)) PRMRY_VEND_NUM,
IIF(SRC_IMS_CRE_TS IS NULL OR SRC_IMS_CRE_TS = 'NULL','N/A',SRC_IMS_CRE_TS) SRC_IMS_CRE_TS,
IIF(SRC_IMS_MODFD_TS IS NULL OR SRC_IMS_MODFD_TS = 'NULL','N/A',SRC_IMS_MODFD_TS) SRC_IMS_MODFD_TS,
IIF(VEND_PACK_QTY IS NULL OR VEND_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(VEND_PACK_QTY)) as int)) VEND_PACK_QTY,
IIF(WHSE_PACK_QTY IS NULL OR WHSE_PACK_QTY = 'NULL',101,cast(ltrim(rtrim(WHSE_PACK_QTY)) as int)) WHSE_PACK_QTY,
IIF(CURR_PRICE_MODFD_TS IS NULL OR CURR_PRICE_MODFD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(CURR_PRICE_MODFD_TS))as datetime)) CURR_PRICE_MODFD_TS,
IIF(AMT_ITEM_COST IS NULL OR AMT_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(AMT_ITEM_COST))as decimal)) AMT_ITEM_COST,
IIF(AMT_BASE_ITEM_PRICE IS NULL OR AMT_BASE_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_ITEM_PRICE))as decimal)) AMT_BASE_ITEM_PRICE,
IIF(AMT_BASE_SUGG_PRICE IS NULL OR AMT_BASE_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_BASE_SUGG_PRICE))as decimal)) AMT_BASE_SUGG_PRICE,
IIF(AMT_SUGG_PRICE IS NULL OR AMT_SUGG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(AMT_SUGG_PRICE))as decimal)) AMT_SUGG_PRICE,
IIF(MIN_ITEM_COST IS NULL OR MIN_ITEM_COST = 'NULL',101.00,cast(ltrim(rtrim(MIN_ITEM_COST))as decimal)) MIN_ITEM_COST,
IIF(ORIG_PRICE IS NULL OR ORIG_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_PRICE))as decimal)) ORIG_PRICE,
IIF(ORIG_ITEM_PRICE IS NULL OR ORIG_ITEM_PRICE = 'NULL',101.00,cast(ltrim(rtrim(ORIG_ITEM_PRICE))as decimal)) ORIG_ITEM_PRICE,
IIF(PROD_NM IS NULL OR PROD_NM = 'NULL','N/A',LTRIM(RTRIM(PROD_NM))) PROD_NM,
IIF(PROD_HT IS NULL OR PROD_HT = 'NULL' OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_HT))as decimal)) PROD_HT,
IIF(PROD_WT IS NULL OR PROD_WT = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WT))as decimal)) PROD_WT,
IIF(PROD_LEN IS NULL OR PROD_LEN = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_LEN))as decimal)) PROD_LEN,
IIF(PROD_WDTH IS NULL OR PROD_WDTH = 'NULL'OR PROD_HT LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(PROD_WDTH))as decimal)) PROD_WDTH,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(cre_dt))as date)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',cast(ltrim(rtrim(CRE_USER))as VARCHAR)) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%','01/01/1900',cast(ltrim(rtrim(UPD_TS))as datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',cast(ltrim(rtrim(UPD_USER))as VARCHAR)) UPD_USER
FROM [BCMPWMT].[PROD]) S
ON T.CATLG_ITEM_ID = S.CATLG_ITEM_ID
WHERE S.CATLG_ITEM_ID IS NULL AND
(T.PRMRY_DSTRBTR_NM <> S.PRMRY_DSTRBTR_NM OR T.PRMRY_VEND_NUM <> S.PRMRY_VEND_NUM OR T.SRC_IMS_CRE_TS <> S.SRC_IMS_CRE_TS OR
T.SRC_IMS_MODFD_TS <> S.SRC_IMS_MODFD_TS OR T.VEND_PACK_QTY <> S.VEND_PACK_QTY OR T.WHSE_PACK_QTY <> S.WHSE_PACK_QTY OR T.CURR_PRICE_MODFD_TS
<> S.CURR_PRICE_MODFD_TS OR T.AMT_ITEM_COST <> S.AMT_ITEM_COST OR T.AMT_BASE_ITEM_PRICE <> S.AMT_BASE_ITEM_PRICE OR T.AMT_BASE_SUGG_PRICE <> S.AMT_BASE_SUGG_PRICE
OR T.AMT_SUGG_PRICE <> S.AMT_SUGG_PRICE OR T.MIN_ITEM_COST <> S.MIN_ITEM_COST OR T.ORIG_PRICE <> S.ORIG_PRICE OR T.ORIG_ITEM_PRICE <> S.ORIG_ITEM_PRICE
OR T.PROD_NM <> S.PROD_NM OR T.PROD_HT <> S.PROD_HT OR T.PROD_WT <> S.PROD_WT OR T.PROD_LEN <> S.PROD_LEN OR T.PROD_WDTH <> S.PROD_WDTH
OR T.CRE_DT <> S.CRE_DT OR T.CRE_USER <> S.CRE_USER OR T.UPD_TS <> S.UPD_TS OR T.UPD_USER <> S.UPD_USER)

-------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM DIM_ORG_BUSINESS_UNIT_SQL_IN1563

SELECT COUNT(*) FROM DIM_ORG_BUSINESS_UNIT_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT
IIF(ORG_ID IS NULL OR ORG_ID = 'NULL','N/A', LTRIM(RTRIM(ORG_ID))) ORG_ID,
IIF(SRC_ORG_CD IS NULL OR SRC_ORG_CD = 'NULL','N/A', LTRIM(RTRIM(SRC_ORG_CD))) SRC_ORG_CD,
IIF(ORG_TYPE_ID IS NULL OR ORG_TYPE_ID = 'NULL',101,cast(ltrim(rtrim(ORG_TYPE_ID)) AS INT)) ORG_TYPE_ID,
IIF(ORG_NM IS NULL OR ORG_NM = 'NULL','N/A', LTRIM(RTRIM(ORG_NM))) ORG_NM,
IIF(PARENT_ORG_ID IS NULL OR PARENT_ORG_ID = 'NULL','N/A', LTRIM(RTRIM(PARENT_ORG_ID))) PARENT_ORG_ID,
IIF(PARENT_ORG_NM IS NULL OR PARENT_ORG_NM = 'NULL','N/A', LTRIM(RTRIM(PARENT_ORG_NM))) PARENT_ORG_NM,
IIF(WM_RDC_NUM IS NULL OR WM_RDC_NUM = 'NULL','N/A', LTRIM(RTRIM(WM_RDC_NUM))) WM_RDC_NUM,
IIF(WM_STORE_NUM IS NULL OR WM_STORE_NUM = 'NULL','N/A', LTRIM(RTRIM(WM_STORE_NUM))) WM_STORE_NUM,
IIF(WM_DSTRBTR_NO IS NULL OR WM_DSTRBTR_NO = 'NULL','N/A', LTRIM(RTRIM(WM_DSTRBTR_NO))) WM_DSTRBTR_NO,
IIF(WH_IND IS NULL OR WH_IND = 'NULL',101,cast(ltrim(rtrim(WH_IND)) AS INT)) WH_IND,
IIF(DSV_IND IS NULL OR DSV_IND = 'NULL',101,cast(ltrim(rtrim(DSV_IND)) AS INT)) DSV_IND,
IIF(ACTV_IND IS NULL OR ACTV_IND = 'NULL',101,cast(ltrim(rtrim(ACTV_IND)) AS INT)) ACTV_IND,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(EFF_BEGIN_DT))as date)) EFF_BEGIN_DT,
IIF(EFF_END_DT IS NULL OR EFF_END_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(EFF_END_DT))as date)) EFF_END_DT,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT))as date)) CRE_DT,
'Y' as Is_Valid_Flag,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(UPD_TS))as date)) UPD_TS
FROM [BCMPWMT].[ORG_BUSINESS_UNIT]) S

SELECT WH_IND,COUNT(*) FROM DIM_ORG_BUSINESS_UNIT_SQL_IN1563 GROUP BY WH_IND

SELECT WH_IND,COUNT(*) FROM 
(SELECT
IIF(ORG_ID IS NULL OR ORG_ID = 'NULL','N/A', LTRIM(RTRIM(ORG_ID))) ORG_ID,
IIF(SRC_ORG_CD IS NULL OR SRC_ORG_CD = 'NULL','N/A', LTRIM(RTRIM(SRC_ORG_CD))) SRC_ORG_CD,
IIF(ORG_TYPE_ID IS NULL OR ORG_TYPE_ID = 'NULL',101,cast(ltrim(rtrim(ORG_TYPE_ID)) AS INT)) ORG_TYPE_ID,
IIF(ORG_NM IS NULL OR ORG_NM = 'NULL','N/A', LTRIM(RTRIM(ORG_NM))) ORG_NM,
IIF(PARENT_ORG_ID IS NULL OR PARENT_ORG_ID = 'NULL','N/A', LTRIM(RTRIM(PARENT_ORG_ID))) PARENT_ORG_ID,
IIF(PARENT_ORG_NM IS NULL OR PARENT_ORG_NM = 'NULL','N/A', LTRIM(RTRIM(PARENT_ORG_NM))) PARENT_ORG_NM,
IIF(WM_RDC_NUM IS NULL OR WM_RDC_NUM = 'NULL','N/A', LTRIM(RTRIM(WM_RDC_NUM))) WM_RDC_NUM,
IIF(WM_STORE_NUM IS NULL OR WM_STORE_NUM = 'NULL','N/A', LTRIM(RTRIM(WM_STORE_NUM))) WM_STORE_NUM,
IIF(WM_DSTRBTR_NO IS NULL OR WM_DSTRBTR_NO = 'NULL','N/A', LTRIM(RTRIM(WM_DSTRBTR_NO))) WM_DSTRBTR_NO,
IIF(WH_IND IS NULL OR WH_IND = 'NULL',101,cast(ltrim(rtrim(WH_IND)) AS INT)) WH_IND,
IIF(DSV_IND IS NULL OR DSV_IND = 'NULL',101,cast(ltrim(rtrim(DSV_IND)) AS INT)) DSV_IND,
IIF(ACTV_IND IS NULL OR ACTV_IND = 'NULL',101,cast(ltrim(rtrim(ACTV_IND)) AS INT)) ACTV_IND,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(EFF_BEGIN_DT))as date)) EFF_BEGIN_DT,
IIF(EFF_END_DT IS NULL OR EFF_END_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(EFF_END_DT))as date)) EFF_END_DT,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT))as date)) CRE_DT,
'Y' as Is_Valid_Flag,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(UPD_TS))as date)) UPD_TS
FROM [BCMPWMT].[ORG_BUSINESS_UNIT]) S
GROUP BY WH_IND

SELECT COUNT(*) FROM DIM_ORG_BUSINESS_UNIT_SQL_IN1563
GROUP BY ORG_ID
HAVING COUNT(*) > 1

SELECT ORG_ID,SRC_ORG_CD,ORG_TYPE_ID,ORG_NM,PARENT_ORG_ID
FROM DIM_ORG_BUSINESS_UNIT_SQL_IN1563
WHERE WH_IND = 1

SELECT ORG_ID,SRC_ORG_CD,ORG_TYPE_ID,ORG_NM,PARENT_ORG_ID
FROM (SELECT
IIF(ORG_ID IS NULL OR ORG_ID = 'NULL','N/A', LTRIM(RTRIM(ORG_ID))) ORG_ID,
IIF(SRC_ORG_CD IS NULL OR SRC_ORG_CD = 'NULL','N/A', LTRIM(RTRIM(SRC_ORG_CD))) SRC_ORG_CD,
IIF(ORG_TYPE_ID IS NULL OR ORG_TYPE_ID = 'NULL',101,cast(ltrim(rtrim(ORG_TYPE_ID)) AS INT)) ORG_TYPE_ID,
IIF(ORG_NM IS NULL OR ORG_NM = 'NULL','N/A', LTRIM(RTRIM(ORG_NM))) ORG_NM,
IIF(PARENT_ORG_ID IS NULL OR PARENT_ORG_ID = 'NULL','N/A', LTRIM(RTRIM(PARENT_ORG_ID))) PARENT_ORG_ID,
IIF(PARENT_ORG_NM IS NULL OR PARENT_ORG_NM = 'NULL','N/A', LTRIM(RTRIM(PARENT_ORG_NM))) PARENT_ORG_NM,
IIF(WM_RDC_NUM IS NULL OR WM_RDC_NUM = 'NULL','N/A', LTRIM(RTRIM(WM_RDC_NUM))) WM_RDC_NUM,
IIF(WM_STORE_NUM IS NULL OR WM_STORE_NUM = 'NULL','N/A', LTRIM(RTRIM(WM_STORE_NUM))) WM_STORE_NUM,
IIF(WM_DSTRBTR_NO IS NULL OR WM_DSTRBTR_NO = 'NULL','N/A', LTRIM(RTRIM(WM_DSTRBTR_NO))) WM_DSTRBTR_NO,
IIF(WH_IND IS NULL OR WH_IND = 'NULL',101,cast(ltrim(rtrim(WH_IND)) AS INT)) WH_IND,
IIF(DSV_IND IS NULL OR DSV_IND = 'NULL',101,cast(ltrim(rtrim(DSV_IND)) AS INT)) DSV_IND,
IIF(ACTV_IND IS NULL OR ACTV_IND = 'NULL',101,cast(ltrim(rtrim(ACTV_IND)) AS INT)) ACTV_IND,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(EFF_BEGIN_DT))as date)) EFF_BEGIN_DT,
IIF(EFF_END_DT IS NULL OR EFF_END_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(EFF_END_DT))as date)) EFF_END_DT,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT))as date)) CRE_DT,
'Y' as Is_Valid_Flag,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(UPD_TS))as date)) UPD_TS
FROM [BCMPWMT].[ORG_BUSINESS_UNIT]) S
WHERE WH_IND = 1

SELECT COUNT(*) FROM DIM_ORG_BUSINESS_UNIT_SQL_IN1563 T LEFT JOIN 
(SELECT
IIF(ORG_ID IS NULL OR ORG_ID = 'NULL','N/A', LTRIM(RTRIM(ORG_ID))) ORG_ID,
IIF(SRC_ORG_CD IS NULL OR SRC_ORG_CD = 'NULL','N/A', LTRIM(RTRIM(SRC_ORG_CD))) SRC_ORG_CD,
IIF(ORG_TYPE_ID IS NULL OR ORG_TYPE_ID = 'NULL',101,cast(ltrim(rtrim(ORG_TYPE_ID)) AS INT)) ORG_TYPE_ID,
IIF(ORG_NM IS NULL OR ORG_NM = 'NULL','N/A', LTRIM(RTRIM(ORG_NM))) ORG_NM,
IIF(PARENT_ORG_ID IS NULL OR PARENT_ORG_ID = 'NULL','N/A', LTRIM(RTRIM(PARENT_ORG_ID))) PARENT_ORG_ID,
IIF(PARENT_ORG_NM IS NULL OR PARENT_ORG_NM = 'NULL','N/A', LTRIM(RTRIM(PARENT_ORG_NM))) PARENT_ORG_NM,
IIF(WM_RDC_NUM IS NULL OR WM_RDC_NUM = 'NULL','N/A', LTRIM(RTRIM(WM_RDC_NUM))) WM_RDC_NUM,
IIF(WM_STORE_NUM IS NULL OR WM_STORE_NUM = 'NULL','N/A', LTRIM(RTRIM(WM_STORE_NUM))) WM_STORE_NUM,
IIF(WM_DSTRBTR_NO IS NULL OR WM_DSTRBTR_NO = 'NULL','N/A', LTRIM(RTRIM(WM_DSTRBTR_NO))) WM_DSTRBTR_NO,
IIF(WH_IND IS NULL OR WH_IND = 'NULL',101,cast(ltrim(rtrim(WH_IND)) AS INT)) WH_IND,
IIF(DSV_IND IS NULL OR DSV_IND = 'NULL',101,cast(ltrim(rtrim(DSV_IND)) AS INT)) DSV_IND,
IIF(ACTV_IND IS NULL OR ACTV_IND = 'NULL',101,cast(ltrim(rtrim(ACTV_IND)) AS INT)) ACTV_IND,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(EFF_BEGIN_DT))as date)) EFF_BEGIN_DT,
IIF(EFF_END_DT IS NULL OR EFF_END_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(EFF_END_DT))as date)) EFF_END_DT,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(CRE_DT))as date)) CRE_DT,
'Y' as Is_Valid_Flag,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(UPD_TS))as date)) UPD_TS
FROM [BCMPWMT].[ORG_BUSINESS_UNIT]) S
ON T.ORG_ID = S.ORG_ID
WHERE S.ORG_ID IS NULL AND 
(T.SRC_ORG_CD<>  S.SRC_ORG_CD  OR
T.ORG_TYPE_ID<>  S.ORG_TYPE_ID  OR
T.ORG_NM<>  S.ORG_NM  OR
T.PARENT_ORG_ID<>  S.PARENT_ORG_ID  OR
T.PARENT_ORG_NM<>  S.PARENT_ORG_NM  OR
T.WM_RDC_NUM<>  S.WM_RDC_NUM  OR
T.WM_STORE_NUM<>  S.WM_STORE_NUM  OR
T.WM_DSTRBTR_NO<>  S.WM_DSTRBTR_NO  OR
T.WH_IND<>  S.WH_IND  OR
T.DSV_IND<>  S.DSV_IND  OR
T.ACTV_IND<>  S.ACTV_IND  OR
T.EFF_BEGIN_DT<>  S.EFF_BEGIN_DT  OR
T.EFF_END_DT<>  S.EFF_END_DT  OR
T.CRE_DT<>  S.CRE_DT  OR
T.Is_Valid_Flag<>  S.Is_Valid_Flag  OR
T.UPD_TS<>  S.UPD_TS
)

-------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM Dim_ORDER_STS_MASTER_LKP_SQL_IN1563

SELECT COUNT(*) FROM Dim_ORDER_STS_MASTER_LKP_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT 
IIF(ORDER_STS_MASTER_ID IS NULL OR ORDER_STS_MASTER_ID = 'NULL',101,cast(ltrim(rtrim(ORDER_STS_MASTER_ID)) AS bigint)) ORDER_STS_MASTER_ID,
IIF(ORDER_STS_MASTER_CD IS NULL OR ORDER_STS_MASTER_CD = 'NULL','N/A',LTRIM(RTRIM(ORDER_STS_MASTER_CD))) ORDER_STS_MASTER_CD,
IIF(ORDER_STS_SHORT_DESC IS NULL OR ORDER_STS_SHORT_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_SHORT_DESC))) ORDER_STS_SHORT_DESC,
IIF(ORDER_STS_LONG_DESC IS NULL OR ORDER_STS_LONG_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_LONG_DESC))) ORDER_STS_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(CRE_TS,1,CHARINDEX(' P',CRE_TS))))AS DATETIME)) CRE_TS,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(UPD_TS,1,CHARINDEX(' P',UPD_TS))))AS DATETIME)) UPD_TS
FROM [BCMPWMT].[ORDER_STS_MASTER_LKP]) S

SELECT UPD_TS,COUNT(*) FROM Dim_ORDER_STS_MASTER_LKP_SQL_IN1563 GROUP BY UPD_TS

SELECT UPD_TS,COUNT(*) FROM 
(SELECT 
IIF(ORDER_STS_MASTER_ID IS NULL OR ORDER_STS_MASTER_ID = 'NULL',101,cast(ltrim(rtrim(ORDER_STS_MASTER_ID)) AS bigint)) ORDER_STS_MASTER_ID,
IIF(ORDER_STS_MASTER_CD IS NULL OR ORDER_STS_MASTER_CD = 'NULL','N/A',LTRIM(RTRIM(ORDER_STS_MASTER_CD))) ORDER_STS_MASTER_CD,
IIF(ORDER_STS_SHORT_DESC IS NULL OR ORDER_STS_SHORT_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_SHORT_DESC))) ORDER_STS_SHORT_DESC,
IIF(ORDER_STS_LONG_DESC IS NULL OR ORDER_STS_LONG_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_LONG_DESC))) ORDER_STS_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(CRE_TS,1,CHARINDEX(' P',CRE_TS))))AS DATETIME)) CRE_TS,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(UPD_TS,1,CHARINDEX(' P',UPD_TS))))AS DATETIME)) UPD_TS
FROM [BCMPWMT].[ORDER_STS_MASTER_LKP]) S
GROUP BY UPD_TS

SELECT COUNT(*) FROM Dim_ORDER_STS_MASTER_LKP_SQL_IN1563
GROUP BY ORDER_STS_MASTER_ID
HAVING COUNT(*) > 1

SELECT ORDER_STS_MASTER_CD,ORDER_STS_SHORT_DESC,ORDER_STS_LONG_DESC,CRE_TS,UPD_TS
FROM Dim_ORDER_STS_MASTER_LKP_SQL_IN1563
WHERE ORDER_STS_MASTER_CD = 'BML_AUTH_FAIL'

SELECT ORDER_STS_MASTER_CD,ORDER_STS_SHORT_DESC,ORDER_STS_LONG_DESC,CRE_TS,UPD_TS
FROM (SELECT 
IIF(ORDER_STS_MASTER_ID IS NULL OR ORDER_STS_MASTER_ID = 'NULL',101,cast(ltrim(rtrim(ORDER_STS_MASTER_ID)) AS bigint)) ORDER_STS_MASTER_ID,
IIF(ORDER_STS_MASTER_CD IS NULL OR ORDER_STS_MASTER_CD = 'NULL','N/A',LTRIM(RTRIM(ORDER_STS_MASTER_CD))) ORDER_STS_MASTER_CD,
IIF(ORDER_STS_SHORT_DESC IS NULL OR ORDER_STS_SHORT_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_SHORT_DESC))) ORDER_STS_SHORT_DESC,
IIF(ORDER_STS_LONG_DESC IS NULL OR ORDER_STS_LONG_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_LONG_DESC))) ORDER_STS_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(CRE_TS,1,CHARINDEX(' P',CRE_TS))))AS DATETIME)) CRE_TS,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(UPD_TS,1,CHARINDEX(' P',UPD_TS))))AS DATETIME)) UPD_TS
FROM [BCMPWMT].[ORDER_STS_MASTER_LKP]) S
WHERE ORDER_STS_MASTER_CD = 'BML_AUTH_FAIL'

SELECT COUNT(*) FROM Dim_ORDER_STS_MASTER_LKP_SQL_IN1563 T LEFT JOIN
(SELECT 
IIF(ORDER_STS_MASTER_ID IS NULL OR ORDER_STS_MASTER_ID = 'NULL',101,cast(ltrim(rtrim(ORDER_STS_MASTER_ID)) AS bigint)) ORDER_STS_MASTER_ID,
IIF(ORDER_STS_MASTER_CD IS NULL OR ORDER_STS_MASTER_CD = 'NULL','N/A',LTRIM(RTRIM(ORDER_STS_MASTER_CD))) ORDER_STS_MASTER_CD,
IIF(ORDER_STS_SHORT_DESC IS NULL OR ORDER_STS_SHORT_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_SHORT_DESC))) ORDER_STS_SHORT_DESC,
IIF(ORDER_STS_LONG_DESC IS NULL OR ORDER_STS_LONG_DESC = 'NULL','N/A', LTRIM(RTRIM(ORDER_STS_LONG_DESC))) ORDER_STS_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(CRE_TS,1,CHARINDEX(' P',CRE_TS))))AS DATETIME)) CRE_TS,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1990', cast(ltrim(rtrim(SUBSTRING(UPD_TS,1,CHARINDEX(' P',UPD_TS))))AS DATETIME)) UPD_TS
FROM [BCMPWMT].[ORDER_STS_MASTER_LKP]) S
ON T. ORDER_STS_MASTER_ID = S.ORDER_STS_MASTER_ID
WHERE S.ORDER_STS_MASTER_ID IS NULL AND 
(T.ORDER_STS_MASTER_CD<>  S.ORDER_STS_MASTER_CD  OR
T.ORDER_STS_SHORT_DESC<>  S.ORDER_STS_SHORT_DESC  OR
T.ORDER_STS_LONG_DESC<>  S.ORDER_STS_LONG_DESC  OR
T.CRE_TS<>  S.CRE_TS  OR
T.UPD_TS<>  S.UPD_TS)

-------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM Dim_OFFR_SQL_IN1563

SELECT COUNT(*) FROM Dim_OFFR_SQL_IN1563

SELECT COUNT(*) FROM
(select
	IIF(OFFER_PK IS NULL OR OFFER_PK = 'NULL','N/A',LTRIM(RTRIM(OFFER_PK))) OFFER_PK,
	IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,CAST(LTRIM(RTRIM(CATLG_ITEM_ID)) as bigint)) CATLG_ITEM_ID,
	IIF(SRC_ORG_CD IS NULL OR SRC_ORG_CD = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ORG_CD)) as bigint)) SRC_ORG_CD,
	IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) as bigint)) TENANT_ORG_ID,
	IIF(SRC_ITEM_KEY IS NULL OR SRC_ITEM_KEY = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ITEM_KEY)) as bigint)) SRC_ITEM_KEY,
	IIF(UPC IS NULL OR UPC = 'NULL','N/A',LTRIM(RTRIM(UPC))) UPC,
	IIF(WM_ITEM_NUM IS NULL OR WM_ITEM_NUM = 'NULL',101,CAST(LTRIM(RTRIM(WM_ITEM_NUM)) as bigint)) WM_ITEM_NUM,
	IIF(WM_UPC IS NULL OR WM_UPC = 'NULL','N/A',LTRIM(RTRIM(WM_UPC))) WM_UPC,
	IIF(OFFR_NM IS NULL OR OFFR_NM = 'NULL','N/A',LTRIM(RTRIM(OFFR_NM))) OFFR_NM,
	IIF(OFFR_START_TS IS NULL OR OFFR_START_TS = 'NULL' OR OFFR_START_TS LIKE '%[a-zA-Z]%','N/A',CAST(FORMAT(cast(OFFR_START_TS as datetime),'yyMMdd') AS NVARCHAR)) OFFR_START_TS,
	IIF(OFFR_START_DT IS NULL OR OFFR_START_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_START_DT))AS DATETIME)) OFFR_START_DT,
	IIF(OFFR_END_TS IS NULL OR OFFR_END_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_END_TS))AS DATETIME)) OFFR_END_TS,
	IIF(OFFR_TYPE_ID IS NULL OR OFFR_TYPE_ID = 'NULL','N/A',LTRIM(RTRIM(OFFR_TYPE_ID))) OFFR_TYPE_ID,
	IIF(COMM_PCT IS NULL OR COMM_PCT = 'NULL',101.00,cast(ltrim(rtrim(COMM_PCT))as decimal)) COMM_PCT,
	IIF(SLR_OFFR_ID IS NULL OR SLR_OFFR_ID = 'NULL','N/A',LTRIM(RTRIM(SLR_OFFR_ID))) SLR_OFFR_ID,
	IIF(PRTNR_ID IS NULL OR PRTNR_ID = 'NULL','N/A',LTRIM(RTRIM(PRTNR_ID))) PRTNR_ID,
	IIF(START_PRICE IS NULL OR START_PRICE = 'NULL' OR START_PRICE LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(START_PRICE))as decimal)) START_PRICE,
	IIF(LAST_PRICE_UPD_TS IS NULL OR LAST_PRICE_UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(LAST_PRICE_UPD_TS))AS DATETIME)) LAST_PRICE_UPD_TS,
	IIF(CURR_PRICE IS NULL OR CURR_PRICE = 'NULL' OR CURR_PRICE LIKE '%[a-zA-Z/]%',101.00,cast(ltrim(rtrim(CURR_PRICE))as decimal)) CURR_PRICE,
	IIF(CURR_SUGG_PRICE IS NULL OR CURR_SUGG_PRICE = 'NULL' OR CURR_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(CURR_SUGG_PRICE))as decimal)) CURR_SUGG_PRICE,
	IIF(BASE_ITEM_PRICE IS NULL OR BASE_ITEM_PRICE = 'NULL' OR BASE_ITEM_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_ITEM_PRICE))as decimal)) BASE_ITEM_PRICE,
	IIF(BASE_SUGG_PRICE IS NULL OR BASE_SUGG_PRICE = 'NULL' OR BASE_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_SUGG_PRICE))as decimal)) BASE_SUGG_PRICE,
	IIF(UOM IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(UOM))) UOM,
	IIF(TAXABLE_IND IS NULL OR TAXABLE_IND = 'NULL',101,CAST(CONVERT(FLOAT,LTRIM(RTRIM(TAXABLE_IND))) as int)) TAXABLE_IND,
	IIF(GIFT_WRAP_IND IS NULL OR GIFT_WRAP_IND = 'NULL',101,CAST(LTRIM(RTRIM(GIFT_WRAP_IND)) as int)) GIFT_WRAP_IND,
	IIF(SHIP_ALONE_IND IS NULL OR SHIP_ALONE_IND = 'NULL',101,CAST(LTRIM(RTRIM(SHIP_ALONE_IND)) as int)) SHIP_ALONE_IND,
	IIF(FREE_RETURNS_IND IS NULL OR FREE_RETURNS_IND = 'NULL',101,CAST(LTRIM(RTRIM(FREE_RETURNS_IND)) as int)) FREE_RETURNS_IND,
	IIF(SLR_UPC IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(SLR_UPC))) SLR_UPC,
	IIF(SHIPTOSTORE_IND IS NULL OR SHIPTOSTORE_IND = 'NULL' OR SHIPTOSTORE_IND LIKE '%[a-zA-Z/]%',101,CAST(LTRIM(RTRIM(SHIPTOSTORE_IND)) as bigint)) SHIPTOSTORE_IND,
	IIF(PIP_IND IS NULL OR PIP_IND = 'NULL',101,CAST(LTRIM(RTRIM(PIP_IND)) as int)) PIP_IND,
	IIF(PRE_ORDER_IND IS NULL OR PRE_ORDER_IND = 'NULL',101,CAST(LTRIM(RTRIM(PRE_ORDER_IND)) as int)) PRE_ORDER_IND,
	IIF(CRE_DT IS NULL OR CRE_DT = 'NULL' OR CRE_DT LIKE '%[a-zA-Z]%' OR CRE_DT = '0' ,'01/01/1900',cast(ltrim(rtrim(CRE_DT))AS DATE)) CRE_DT,
	IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%' ,'01/01/1900',cast(ltrim(rtrim(UPD_TS))AS DATETIME)) UPD_TS
from [BCMPWMT].[OFFR]) S

SELECT src_item_key,COUNT(*) FROM Dim_OFFR_SQL_IN1563 group by src_item_key

SELECT src_item_key,COUNT(*) FROM 
(select
	IIF(OFFER_PK IS NULL OR OFFER_PK = 'NULL','N/A',LTRIM(RTRIM(OFFER_PK))) OFFER_PK,
	IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,CAST(LTRIM(RTRIM(CATLG_ITEM_ID)) as bigint)) CATLG_ITEM_ID,
	IIF(SRC_ORG_CD IS NULL OR SRC_ORG_CD = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ORG_CD)) as bigint)) SRC_ORG_CD,
	IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) as bigint)) TENANT_ORG_ID,
	IIF(SRC_ITEM_KEY IS NULL OR SRC_ITEM_KEY = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ITEM_KEY)) as bigint)) SRC_ITEM_KEY,
	IIF(UPC IS NULL OR UPC = 'NULL','N/A',LTRIM(RTRIM(UPC))) UPC,
	IIF(WM_ITEM_NUM IS NULL OR WM_ITEM_NUM = 'NULL',101,CAST(LTRIM(RTRIM(WM_ITEM_NUM)) as bigint)) WM_ITEM_NUM,
	IIF(WM_UPC IS NULL OR WM_UPC = 'NULL','N/A',LTRIM(RTRIM(WM_UPC))) WM_UPC,
	IIF(OFFR_NM IS NULL OR OFFR_NM = 'NULL','N/A',LTRIM(RTRIM(OFFR_NM))) OFFR_NM,
	IIF(OFFR_START_TS IS NULL OR OFFR_START_TS = 'NULL' OR OFFR_START_TS LIKE '%[a-zA-Z]%','N/A',CAST(FORMAT(cast(OFFR_START_TS as datetime),'yyMMdd') AS NVARCHAR)) OFFR_START_TS,
	IIF(OFFR_START_DT IS NULL OR OFFR_START_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_START_DT))AS DATETIME)) OFFR_START_DT,
	IIF(OFFR_END_TS IS NULL OR OFFR_END_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_END_TS))AS DATETIME)) OFFR_END_TS,
	IIF(OFFR_TYPE_ID IS NULL OR OFFR_TYPE_ID = 'NULL','N/A',LTRIM(RTRIM(OFFR_TYPE_ID))) OFFR_TYPE_ID,
	IIF(COMM_PCT IS NULL OR COMM_PCT = 'NULL',101.00,cast(ltrim(rtrim(COMM_PCT))as decimal)) COMM_PCT,
	IIF(SLR_OFFR_ID IS NULL OR SLR_OFFR_ID = 'NULL','N/A',LTRIM(RTRIM(SLR_OFFR_ID))) SLR_OFFR_ID,
	IIF(PRTNR_ID IS NULL OR PRTNR_ID = 'NULL','N/A',LTRIM(RTRIM(PRTNR_ID))) PRTNR_ID,
	IIF(START_PRICE IS NULL OR START_PRICE = 'NULL' OR START_PRICE LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(START_PRICE))as decimal)) START_PRICE,
	IIF(LAST_PRICE_UPD_TS IS NULL OR LAST_PRICE_UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(LAST_PRICE_UPD_TS))AS DATETIME)) LAST_PRICE_UPD_TS,
	IIF(CURR_PRICE IS NULL OR CURR_PRICE = 'NULL' OR CURR_PRICE LIKE '%[a-zA-Z/]%',101.00,cast(ltrim(rtrim(CURR_PRICE))as decimal)) CURR_PRICE,
	IIF(CURR_SUGG_PRICE IS NULL OR CURR_SUGG_PRICE = 'NULL' OR CURR_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(CURR_SUGG_PRICE))as decimal)) CURR_SUGG_PRICE,
	IIF(BASE_ITEM_PRICE IS NULL OR BASE_ITEM_PRICE = 'NULL' OR BASE_ITEM_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_ITEM_PRICE))as decimal)) BASE_ITEM_PRICE,
	IIF(BASE_SUGG_PRICE IS NULL OR BASE_SUGG_PRICE = 'NULL' OR BASE_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_SUGG_PRICE))as decimal)) BASE_SUGG_PRICE,
	IIF(UOM IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(UOM))) UOM,
	IIF(TAXABLE_IND IS NULL OR TAXABLE_IND = 'NULL',101,CAST(CONVERT(FLOAT,LTRIM(RTRIM(TAXABLE_IND))) as int)) TAXABLE_IND,
	IIF(GIFT_WRAP_IND IS NULL OR GIFT_WRAP_IND = 'NULL',101,CAST(LTRIM(RTRIM(GIFT_WRAP_IND)) as int)) GIFT_WRAP_IND,
	IIF(SHIP_ALONE_IND IS NULL OR SHIP_ALONE_IND = 'NULL',101,CAST(LTRIM(RTRIM(SHIP_ALONE_IND)) as int)) SHIP_ALONE_IND,
	IIF(FREE_RETURNS_IND IS NULL OR FREE_RETURNS_IND = 'NULL',101,CAST(LTRIM(RTRIM(FREE_RETURNS_IND)) as int)) FREE_RETURNS_IND,
	IIF(SLR_UPC IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(SLR_UPC))) SLR_UPC,
	IIF(SHIPTOSTORE_IND IS NULL OR SHIPTOSTORE_IND = 'NULL' OR SHIPTOSTORE_IND LIKE '%[a-zA-Z/]%',101,CAST(LTRIM(RTRIM(SHIPTOSTORE_IND)) as bigint)) SHIPTOSTORE_IND,
	IIF(PIP_IND IS NULL OR PIP_IND = 'NULL',101,CAST(LTRIM(RTRIM(PIP_IND)) as int)) PIP_IND,
	IIF(PRE_ORDER_IND IS NULL OR PRE_ORDER_IND = 'NULL',101,CAST(LTRIM(RTRIM(PRE_ORDER_IND)) as int)) PRE_ORDER_IND,
	IIF(CRE_DT IS NULL OR CRE_DT = 'NULL' OR CRE_DT LIKE '%[a-zA-Z]%' OR CRE_DT = '0' ,'01/01/1900',cast(ltrim(rtrim(CRE_DT))AS DATE)) CRE_DT,
	IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%' ,'01/01/1900',cast(ltrim(rtrim(UPD_TS))AS DATETIME)) UPD_TS
from [BCMPWMT].[OFFR]) S
group by src_item_key

select count(*) from Dim_OFFR_SQL_IN1563
group by offer_pk
having count(*) > 1

select OFFER_PK,CATLG_ITEM_ID,SRC_ORG_CD,SRC_ITEM_KEY,WM_ITEM_NUM
from Dim_OFFR_SQL_IN1563
where OFFER_PK = '00044EFFB0AB42F69FC877CA21546377'

select OFFER_PK,CATLG_ITEM_ID,SRC_ORG_CD,SRC_ITEM_KEY,WM_ITEM_NUM
from (select
	IIF(OFFER_PK IS NULL OR OFFER_PK = 'NULL','N/A',LTRIM(RTRIM(OFFER_PK))) OFFER_PK,
	IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,CAST(LTRIM(RTRIM(CATLG_ITEM_ID)) as bigint)) CATLG_ITEM_ID,
	IIF(SRC_ORG_CD IS NULL OR SRC_ORG_CD = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ORG_CD)) as bigint)) SRC_ORG_CD,
	IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) as bigint)) TENANT_ORG_ID,
	IIF(SRC_ITEM_KEY IS NULL OR SRC_ITEM_KEY = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ITEM_KEY)) as bigint)) SRC_ITEM_KEY,
	IIF(UPC IS NULL OR UPC = 'NULL','N/A',LTRIM(RTRIM(UPC))) UPC,
	IIF(WM_ITEM_NUM IS NULL OR WM_ITEM_NUM = 'NULL',101,CAST(LTRIM(RTRIM(WM_ITEM_NUM)) as bigint)) WM_ITEM_NUM,
	IIF(WM_UPC IS NULL OR WM_UPC = 'NULL','N/A',LTRIM(RTRIM(WM_UPC))) WM_UPC,
	IIF(OFFR_NM IS NULL OR OFFR_NM = 'NULL','N/A',LTRIM(RTRIM(OFFR_NM))) OFFR_NM,
	IIF(OFFR_START_TS IS NULL OR OFFR_START_TS = 'NULL' OR OFFR_START_TS LIKE '%[a-zA-Z]%','N/A',CAST(FORMAT(cast(OFFR_START_TS as datetime),'yyMMdd') AS NVARCHAR)) OFFR_START_TS,
	IIF(OFFR_START_DT IS NULL OR OFFR_START_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_START_DT))AS DATETIME)) OFFR_START_DT,
	IIF(OFFR_END_TS IS NULL OR OFFR_END_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_END_TS))AS DATETIME)) OFFR_END_TS,
	IIF(OFFR_TYPE_ID IS NULL OR OFFR_TYPE_ID = 'NULL','N/A',LTRIM(RTRIM(OFFR_TYPE_ID))) OFFR_TYPE_ID,
	IIF(COMM_PCT IS NULL OR COMM_PCT = 'NULL',101.00,cast(ltrim(rtrim(COMM_PCT))as decimal)) COMM_PCT,
	IIF(SLR_OFFR_ID IS NULL OR SLR_OFFR_ID = 'NULL','N/A',LTRIM(RTRIM(SLR_OFFR_ID))) SLR_OFFR_ID,
	IIF(PRTNR_ID IS NULL OR PRTNR_ID = 'NULL','N/A',LTRIM(RTRIM(PRTNR_ID))) PRTNR_ID,
	IIF(START_PRICE IS NULL OR START_PRICE = 'NULL' OR START_PRICE LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(START_PRICE))as decimal)) START_PRICE,
	IIF(LAST_PRICE_UPD_TS IS NULL OR LAST_PRICE_UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(LAST_PRICE_UPD_TS))AS DATETIME)) LAST_PRICE_UPD_TS,
	IIF(CURR_PRICE IS NULL OR CURR_PRICE = 'NULL' OR CURR_PRICE LIKE '%[a-zA-Z/]%',101.00,cast(ltrim(rtrim(CURR_PRICE))as decimal)) CURR_PRICE,
	IIF(CURR_SUGG_PRICE IS NULL OR CURR_SUGG_PRICE = 'NULL' OR CURR_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(CURR_SUGG_PRICE))as decimal)) CURR_SUGG_PRICE,
	IIF(BASE_ITEM_PRICE IS NULL OR BASE_ITEM_PRICE = 'NULL' OR BASE_ITEM_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_ITEM_PRICE))as decimal)) BASE_ITEM_PRICE,
	IIF(BASE_SUGG_PRICE IS NULL OR BASE_SUGG_PRICE = 'NULL' OR BASE_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_SUGG_PRICE))as decimal)) BASE_SUGG_PRICE,
	IIF(UOM IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(UOM))) UOM,
	IIF(TAXABLE_IND IS NULL OR TAXABLE_IND = 'NULL',101,CAST(CONVERT(FLOAT,LTRIM(RTRIM(TAXABLE_IND))) as int)) TAXABLE_IND,
	IIF(GIFT_WRAP_IND IS NULL OR GIFT_WRAP_IND = 'NULL',101,CAST(LTRIM(RTRIM(GIFT_WRAP_IND)) as int)) GIFT_WRAP_IND,
	IIF(SHIP_ALONE_IND IS NULL OR SHIP_ALONE_IND = 'NULL',101,CAST(LTRIM(RTRIM(SHIP_ALONE_IND)) as int)) SHIP_ALONE_IND,
	IIF(FREE_RETURNS_IND IS NULL OR FREE_RETURNS_IND = 'NULL',101,CAST(LTRIM(RTRIM(FREE_RETURNS_IND)) as int)) FREE_RETURNS_IND,
	IIF(SLR_UPC IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(SLR_UPC))) SLR_UPC,
	IIF(SHIPTOSTORE_IND IS NULL OR SHIPTOSTORE_IND = 'NULL' OR SHIPTOSTORE_IND LIKE '%[a-zA-Z/]%',101,CAST(LTRIM(RTRIM(SHIPTOSTORE_IND)) as bigint)) SHIPTOSTORE_IND,
	IIF(PIP_IND IS NULL OR PIP_IND = 'NULL',101,CAST(LTRIM(RTRIM(PIP_IND)) as int)) PIP_IND,
	IIF(PRE_ORDER_IND IS NULL OR PRE_ORDER_IND = 'NULL',101,CAST(LTRIM(RTRIM(PRE_ORDER_IND)) as int)) PRE_ORDER_IND,
	IIF(CRE_DT IS NULL OR CRE_DT = 'NULL' OR CRE_DT LIKE '%[a-zA-Z]%' OR CRE_DT = '0' ,'01/01/1900',cast(ltrim(rtrim(CRE_DT))AS DATE)) CRE_DT,
	IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%' ,'01/01/1900',cast(ltrim(rtrim(UPD_TS))AS DATETIME)) UPD_TS
from [BCMPWMT].[OFFR]) S
where OFFER_PK = '00044EFFB0AB42F69FC877CA21546377'

SELECT COUNT(*) FROM Dim_OFFR_SQL_IN1563 T LEFT JOIN 
(select
	IIF(OFFER_PK IS NULL OR OFFER_PK = 'NULL','N/A',LTRIM(RTRIM(OFFER_PK))) OFFER_PK,
	IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,CAST(LTRIM(RTRIM(CATLG_ITEM_ID)) as bigint)) CATLG_ITEM_ID,
	IIF(SRC_ORG_CD IS NULL OR SRC_ORG_CD = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ORG_CD)) as bigint)) SRC_ORG_CD,
	IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) as bigint)) TENANT_ORG_ID,
	IIF(SRC_ITEM_KEY IS NULL OR SRC_ITEM_KEY = 'NULL',101,CAST(LTRIM(RTRIM(SRC_ITEM_KEY)) as bigint)) SRC_ITEM_KEY,
	IIF(UPC IS NULL OR UPC = 'NULL','N/A',LTRIM(RTRIM(UPC))) UPC,
	IIF(WM_ITEM_NUM IS NULL OR WM_ITEM_NUM = 'NULL',101,CAST(LTRIM(RTRIM(WM_ITEM_NUM)) as bigint)) WM_ITEM_NUM,
	IIF(WM_UPC IS NULL OR WM_UPC = 'NULL','N/A',LTRIM(RTRIM(WM_UPC))) WM_UPC,
	IIF(OFFR_NM IS NULL OR OFFR_NM = 'NULL','N/A',LTRIM(RTRIM(OFFR_NM))) OFFR_NM,
	IIF(OFFR_START_TS IS NULL OR OFFR_START_TS = 'NULL' OR OFFR_START_TS LIKE '%[a-zA-Z]%','N/A',CAST(FORMAT(cast(OFFR_START_TS as datetime),'yyMMdd') AS NVARCHAR)) OFFR_START_TS,
	IIF(OFFR_START_DT IS NULL OR OFFR_START_DT = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_START_DT))AS DATETIME)) OFFR_START_DT,
	IIF(OFFR_END_TS IS NULL OR OFFR_END_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(OFFR_END_TS))AS DATETIME)) OFFR_END_TS,
	IIF(OFFR_TYPE_ID IS NULL OR OFFR_TYPE_ID = 'NULL','N/A',LTRIM(RTRIM(OFFR_TYPE_ID))) OFFR_TYPE_ID,
	IIF(COMM_PCT IS NULL OR COMM_PCT = 'NULL',101.00,cast(ltrim(rtrim(COMM_PCT))as decimal)) COMM_PCT,
	IIF(SLR_OFFR_ID IS NULL OR SLR_OFFR_ID = 'NULL','N/A',LTRIM(RTRIM(SLR_OFFR_ID))) SLR_OFFR_ID,
	IIF(PRTNR_ID IS NULL OR PRTNR_ID = 'NULL','N/A',LTRIM(RTRIM(PRTNR_ID))) PRTNR_ID,
	IIF(START_PRICE IS NULL OR START_PRICE = 'NULL' OR START_PRICE LIKE '%[a-zA-Z]%',101.00,cast(ltrim(rtrim(START_PRICE))as decimal)) START_PRICE,
	IIF(LAST_PRICE_UPD_TS IS NULL OR LAST_PRICE_UPD_TS = 'NULL','01/01/1900',cast(ltrim(rtrim(LAST_PRICE_UPD_TS))AS DATETIME)) LAST_PRICE_UPD_TS,
	IIF(CURR_PRICE IS NULL OR CURR_PRICE = 'NULL' OR CURR_PRICE LIKE '%[a-zA-Z/]%',101.00,cast(ltrim(rtrim(CURR_PRICE))as decimal)) CURR_PRICE,
	IIF(CURR_SUGG_PRICE IS NULL OR CURR_SUGG_PRICE = 'NULL' OR CURR_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(CURR_SUGG_PRICE))as decimal)) CURR_SUGG_PRICE,
	IIF(BASE_ITEM_PRICE IS NULL OR BASE_ITEM_PRICE = 'NULL' OR BASE_ITEM_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_ITEM_PRICE))as decimal)) BASE_ITEM_PRICE,
	IIF(BASE_SUGG_PRICE IS NULL OR BASE_SUGG_PRICE = 'NULL' OR BASE_SUGG_PRICE LIKE '%[a-zA-Z/]%' ,101.00,cast(ltrim(rtrim(BASE_SUGG_PRICE))as decimal)) BASE_SUGG_PRICE,
	IIF(UOM IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(UOM))) UOM,
	IIF(TAXABLE_IND IS NULL OR TAXABLE_IND = 'NULL',101,CAST(CONVERT(FLOAT,LTRIM(RTRIM(TAXABLE_IND))) as int)) TAXABLE_IND,
	IIF(GIFT_WRAP_IND IS NULL OR GIFT_WRAP_IND = 'NULL',101,CAST(LTRIM(RTRIM(GIFT_WRAP_IND)) as int)) GIFT_WRAP_IND,
	IIF(SHIP_ALONE_IND IS NULL OR SHIP_ALONE_IND = 'NULL',101,CAST(LTRIM(RTRIM(SHIP_ALONE_IND)) as int)) SHIP_ALONE_IND,
	IIF(FREE_RETURNS_IND IS NULL OR FREE_RETURNS_IND = 'NULL',101,CAST(LTRIM(RTRIM(FREE_RETURNS_IND)) as int)) FREE_RETURNS_IND,
	IIF(SLR_UPC IS NULL OR UOM = 'NULL','N/A',LTRIM(RTRIM(SLR_UPC))) SLR_UPC,
	IIF(SHIPTOSTORE_IND IS NULL OR SHIPTOSTORE_IND = 'NULL' OR SHIPTOSTORE_IND LIKE '%[a-zA-Z/]%',101,CAST(LTRIM(RTRIM(SHIPTOSTORE_IND)) as bigint)) SHIPTOSTORE_IND,
	IIF(PIP_IND IS NULL OR PIP_IND = 'NULL',101,CAST(LTRIM(RTRIM(PIP_IND)) as int)) PIP_IND,
	IIF(PRE_ORDER_IND IS NULL OR PRE_ORDER_IND = 'NULL',101,CAST(LTRIM(RTRIM(PRE_ORDER_IND)) as int)) PRE_ORDER_IND,
	IIF(CRE_DT IS NULL OR CRE_DT = 'NULL' OR CRE_DT LIKE '%[a-zA-Z]%' OR CRE_DT = '0' ,'01/01/1900',cast(ltrim(rtrim(CRE_DT))AS DATE)) CRE_DT,
	IIF(UPD_TS IS NULL OR UPD_TS = 'NULL' OR UPD_TS LIKE '%[a-zA-Z]%' ,'01/01/1900',cast(ltrim(rtrim(UPD_TS))AS DATETIME)) UPD_TS
from [BCMPWMT].[OFFR]) S
ON T.OFFER_PK = S. OFFER_PK
WHERE S.OFFER_PK IS NULL AND 
(T.CATLG_ITEM_ID<>  S.CATLG_ITEM_ID  OR
T.SRC_ORG_CD<>  S.SRC_ORG_CD  OR
T.TENANT_ORG_ID<>  S.TENANT_ORG_ID  OR
T.SRC_ITEM_KEY<>  S.SRC_ITEM_KEY  OR
T.UPC<>  S.UPC  OR
T.WM_ITEM_NUM<>  S.WM_ITEM_NUM  OR
T.WM_UPC<>  S.WM_UPC  OR
T.OFFR_NM<>  S.OFFR_NM  OR
T.OFFR_START_TS<>  S.OFFR_START_TS  OR
T.OFFR_START_DT<>  S.OFFR_START_DT  OR
T.OFFR_END_TS<>  S.OFFR_END_TS  OR
T.OFFR_TYPE_ID<>  S.OFFR_TYPE_ID  OR
T.COMM_PCT<>  S.COMM_PCT  OR
T.SLR_OFFR_ID<>  S.SLR_OFFR_ID  OR
T.PRTNR_ID<>  S.PRTNR_ID  OR
T.START_PRICE<>  S.START_PRICE  OR
T.LAST_PRICE_UPD_TS<>  S.LAST_PRICE_UPD_TS  OR
T.CURR_PRICE<>  S.CURR_PRICE  OR
T.CURR_SUGG_PRICE<>  S.CURR_SUGG_PRICE  OR
T.BASE_ITEM_PRICE<>  S.BASE_ITEM_PRICE  OR
T.BASE_SUGG_PRICE<>  S.BASE_SUGG_PRICE  OR
T.UOM<>  S.UOM  OR
T.TAXABLE_IND<>  S.TAXABLE_IND  OR
T.GIFT_WRAP_IND<>  S.GIFT_WRAP_IND  OR
T.SHIP_ALONE_IND<>  S.SHIP_ALONE_IND  OR
T.FREE_RETURNS_IND<>  S.FREE_RETURNS_IND  OR
T.SLR_UPC<>  S.SLR_UPC  OR
T.SHIPTOSTORE_IND<>  S.SHIPTOSTORE_IND  OR
T.PIP_IND<>  S.PIP_IND  OR
T.PRE_ORDER_IND<>  S.PRE_ORDER_IND  OR
T.CRE_DT<>  S.CRE_DT  OR
T.UPD_TS<>  S.UPD_TS)

----------------------------------------------------------------------------------------------------------------------
SELECT * FROM DIM_STS_LKP_SQL_IN1563

SELECT COUNT(*) FROM DIM_STS_LKP_SQL_IN1563

SELECT COUNT(*) FROM 
(select 
IIF(STS_ID IS NULL OR STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_ID)))) STS_ID,
IIF(STS_MASTER_ID IS NULL OR STS_MASTER_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_MASTER_ID)))) STS_MASTER_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(DATA_SRC_ID)))) DATA_SRC_ID,
IIF(STS_CD IS NULL OR STS_CD = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_CD)))) STS_CD,
IIF(SRC_STS_ID IS NULL OR SRC_STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(SRC_STS_ID)))) SRC_STS_ID,
IIF(STS_DESC IS NULL OR STS_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_DESC)))) STS_DESC,
IIF(STS_LONG_DESC IS NULL OR STS_LONG_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_LONG_DESC)))) STS_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,CRE_TS)),'-',format(convert(datetime,CRE_TS),'yyyy'))) CRE_TS,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,UPD_TS)),'-',format(convert(datetime,UPD_TS),'yyyy'))) UPD_TS
from [BCMPWMT].[STS_LKP]) S


SELECT DATA_SRC_ID,COUNT(*) FROM DIM_STS_LKP_SQL_IN1563 GROUP BY DATA_SRC_ID

SELECT DATA_SRC_ID,COUNT(*) FROM 
(select 
IIF(STS_ID IS NULL OR STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_ID)))) STS_ID,
IIF(STS_MASTER_ID IS NULL OR STS_MASTER_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_MASTER_ID)))) STS_MASTER_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(DATA_SRC_ID)))) DATA_SRC_ID,
IIF(STS_CD IS NULL OR STS_CD = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_CD)))) STS_CD,
IIF(SRC_STS_ID IS NULL OR SRC_STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(SRC_STS_ID)))) SRC_STS_ID,
IIF(STS_DESC IS NULL OR STS_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_DESC)))) STS_DESC,
IIF(STS_LONG_DESC IS NULL OR STS_LONG_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_LONG_DESC)))) STS_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,CRE_TS)),'-',format(convert(datetime,CRE_TS),'yyyy'))) CRE_TS,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,UPD_TS)),'-',format(convert(datetime,UPD_TS),'yyyy'))) UPD_TS
from [BCMPWMT].[STS_LKP]) S
GROUP BY DATA_SRC_ID

SELECT COUNT(*) FROM DIM_STS_LKP_SQL_IN1563
GROUP BY STS_ID
HAVING COUNT(*) > 1

SELECT STS_ID,STS_MASTER_ID,TENANT_ORG_ID,STS_DESC,STS_LONG_DESC
FROM DIM_STS_LKP_SQL_IN1563
WHERE STS_MASTER_ID = 81

SELECT STS_ID,STS_MASTER_ID,TENANT_ORG_ID,STS_DESC,STS_LONG_DESC
FROM (select 
IIF(STS_ID IS NULL OR STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_ID)))) STS_ID,
IIF(STS_MASTER_ID IS NULL OR STS_MASTER_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_MASTER_ID)))) STS_MASTER_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(DATA_SRC_ID)))) DATA_SRC_ID,
IIF(STS_CD IS NULL OR STS_CD = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_CD)))) STS_CD,
IIF(SRC_STS_ID IS NULL OR SRC_STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(SRC_STS_ID)))) SRC_STS_ID,
IIF(STS_DESC IS NULL OR STS_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_DESC)))) STS_DESC,
IIF(STS_LONG_DESC IS NULL OR STS_LONG_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_LONG_DESC)))) STS_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,CRE_TS)),'-',format(convert(datetime,CRE_TS),'yyyy'))) CRE_TS,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,UPD_TS)),'-',format(convert(datetime,UPD_TS),'yyyy'))) UPD_TS
from [BCMPWMT].[STS_LKP]) S
WHERE STS_MASTER_ID = 81

SELECT COUNT(*) FROM DIM_STS_LKP_SQL_IN1563 T LEFT JOIN
(select 
IIF(STS_ID IS NULL OR STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_ID)))) STS_ID,
IIF(STS_MASTER_ID IS NULL OR STS_MASTER_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(STS_MASTER_ID)))) STS_MASTER_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(DATA_SRC_ID)))) DATA_SRC_ID,
IIF(STS_CD IS NULL OR STS_CD = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_CD)))) STS_CD,
IIF(SRC_STS_ID IS NULL OR SRC_STS_ID = 'NULL',101, CONVERT(INT,LTRIM(RTRIM(SRC_STS_ID)))) SRC_STS_ID,
IIF(STS_DESC IS NULL OR STS_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_DESC)))) STS_DESC,
IIF(STS_LONG_DESC IS NULL OR STS_LONG_DESC = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(STS_LONG_DESC)))) STS_LONG_DESC,
IIF(CRE_TS IS NULL OR CRE_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,CRE_TS)),'-',format(convert(datetime,CRE_TS),'yyyy'))) CRE_TS,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CONCAT('Q',DATEPART(qq,convert(datetime,UPD_TS)),'-',format(convert(datetime,UPD_TS),'yyyy'))) UPD_TS
from [BCMPWMT].[STS_LKP]) S
ON T.STS_ID = S.STS_ID
WHERE S.STS_ID IS NULL AND
(T.STS_MASTER_ID<>  S.STS_MASTER_ID  OR
T.TENANT_ORG_ID<>  S.TENANT_ORG_ID  OR
T.DATA_SRC_ID<>  S.DATA_SRC_ID  OR
T.STS_CD<>  S.STS_CD  OR
T.SRC_STS_ID<>  S.SRC_STS_ID  OR
T.STS_DESC<>  S.STS_DESC  OR
T.STS_LONG_DESC<>  S.STS_LONG_DESC  OR
T.CRE_TS<>  S.CRE_TS  OR
T.UPD_TS<>  S.UPD_TS)

----------------------------------------------------------------------------------------------------------------------

SELECT * FROM dim_rpt_hrchy_SQL_IN1563

SELECT COUNT(*) FROM dim_rpt_hrchy_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID LIKE 'NULL' OR RPT_HRCHY_ID LIKE '?',101.00,cast(RPT_HRCHY_ID as FLOAT)) RPT_HRCHY_ID,
IIF(SRC_RPT_HRCHY_ID IS NULL OR SRC_RPT_HRCHY_ID LIKE 'NULL' OR SRC_RPT_HRCHY_ID LIKE '?',101.00,cast(SRC_RPT_HRCHY_ID as FLOAT)) SRC_RPT_HRCHY_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(tenant_org_id)))) tenant_org_id,
IIF(RPT_HRCHY_PATH IS NULL OR RPT_HRCHY_PATH LIKE 'NULL' OR RPT_HRCHY_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_PATH)))) RPT_HRCHY_PATH,
IIF(DIV_ID IS NULL OR DIV_ID LIKE 'NULL' OR DIV_ID LIKE '?',101.00,cast(DIV_ID as FLOAT)) DIV_ID,
IIF(DIV_NM IS NULL OR DIV_NM LIKE 'NULL' OR DIV_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DIV_NM)))) DIV_NM,
IIF(SUPER_DEPT_ID IS NULL OR SUPER_DEPT_ID LIKE 'NULL' OR SUPER_DEPT_ID LIKE '?',101.00,cast(SUPER_DEPT_ID as FLOAT)) SUPER_DEPT_ID,
IIF(SUPER_DEPT_NM IS NULL OR SUPER_DEPT_NM LIKE 'NULL' OR SUPER_DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUPER_DEPT_NM)))) SUPER_DEPT_NM,
IIF(DEPT_ID IS NULL OR DEPT_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(DEPT_ID as FLOAT)) DEPT_ID,
IIF(DEPT_NM IS NULL OR DEPT_NM LIKE 'NULL' OR DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEPT_NM)))) DEPT_NM,
IIF(CATEG_NM IS NULL OR CATEG_NM LIKE 'NULL' OR CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_NM)))) CATEG_NM,
IIF(SUB_CATEG_ID IS NULL OR SUB_CATEG_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(SUB_CATEG_ID as FLOAT)) SUB_CATEG_ID,
IIF(SUB_CATEG_NM IS NULL OR SUB_CATEG_NM LIKE 'NULL' OR SUB_CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUB_CATEG_NM)))) SUB_CATEG_NM,
IIF(ITEM_CATEG_GROUPING_ID IS NULL OR ITEM_CATEG_GROUPING_ID LIKE 'NULL' OR ITEM_CATEG_GROUPING_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ITEM_CATEG_GROUPING_ID)))) ITEM_CATEG_GROUPING_ID,
IIF(SRC_CRE_TS IS NULL OR SRC_CRE_TS LIKE 'NULL' OR SRC_CRE_TS LIKE '?','N/A',SRC_CRE_TS) SRC_CRE_TS,
IIF(SRC_MODFD_TS IS NULL OR SRC_MODFD_TS LIKE 'NULL' OR SRC_MODFD_TS LIKE '?','N/A',SRC_MODFD_TS) SRC_MODFD_TS,
IIF(SRC_HRCHY_MODFD_TS IS NULL OR SRC_HRCHY_MODFD_TS LIKE 'NULL' OR SRC_HRCHY_MODFD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(SRC_HRCHY_MODFD_TS,1,CHARINDEX('.',SRC_HRCHY_MODFD_TS)-1))) SRC_HRCHY_MODFD_TS,
IIF(CATEG_MGR_NM IS NULL OR CATEG_MGR_NM LIKE 'NULL' OR CATEG_MGR_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_MGR_NM)))) CATEG_MGR_NM,
IIF(BUYER_NM IS NULL OR BUYER_NM LIKE 'NULL' OR BUYER_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BUYER_NM)))) BUYER_NM,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT LIKE 'NULL' OR EFF_BEGIN_DT LIKE '?' OR (EFF_BEGIN_DT LIKE '%[0-9]%' AND NOT EFF_BEGIN_DT LIKE '%[/]%'),'01/01/1900',cast(eff_begin_dt as date)) eff_begin_dt,
IIF(EFF_END_DT IS NULL OR EFF_END_DT LIKE 'NULL' OR EFF_END_DT LIKE '?' OR (EFF_END_DT LIKE '%[0-9]%' AND NOT EFF_END_DT LIKE '%[/]%'),'01/01/1900',cast(EFF_END_DT as date)) EFF_END_DT,
IIF(RPT_HRCHY_ID_PATH IS NULL OR RPT_HRCHY_ID_PATH LIKE 'NULL' OR RPT_HRCHY_ID_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_ID_PATH)))) RPT_HRCHY_ID_PATH,
IIF(CATEG_ID IS NULL OR CATEG_ID LIKE 'NULL' OR CATEG_ID LIKE '?',101.00,cast(CATEG_ID as FLOAT)) CATEG_ID,
IIF(CONSUMABLE_IND IS NULL OR CONSUMABLE_IND LIKE 'NULL' OR CONSUMABLE_IND LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CONSUMABLE_IND)))) CONSUMABLE_IND,
IIF(CURR_IND IS NULL OR CURR_IND LIKE 'NULL' OR CURR_IND LIKE '?',101.00,cast(CURR_IND as FLOAT)) CURR_IND,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?' OR (CRE_DT LIKE '%[0-9]%' AND NOT CRE_DT LIKE '%[/]%') ,'01/01/1900',cast(ltrim(rtrim(cre_dt))as date)) cre_dt,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(UPD_TS,1,CHARINDEX('.',UPD_TS)-1))) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?','N/A',UPD_USER) UPD_USER
FROM [BCMPWMT].[RPT_HRCHY]) S

SELECT DIV_ID,COUNT(*) FROM dim_rpt_hrchy_SQL_IN1563
GROUP BY DIV_ID

SELECT DIV_ID,COUNT(*) FROM 
(SELECT
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID LIKE 'NULL' OR RPT_HRCHY_ID LIKE '?',101.00,cast(RPT_HRCHY_ID as FLOAT)) RPT_HRCHY_ID,
IIF(SRC_RPT_HRCHY_ID IS NULL OR SRC_RPT_HRCHY_ID LIKE 'NULL' OR SRC_RPT_HRCHY_ID LIKE '?',101.00,cast(SRC_RPT_HRCHY_ID as FLOAT)) SRC_RPT_HRCHY_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(tenant_org_id)))) tenant_org_id,
IIF(RPT_HRCHY_PATH IS NULL OR RPT_HRCHY_PATH LIKE 'NULL' OR RPT_HRCHY_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_PATH)))) RPT_HRCHY_PATH,
IIF(DIV_ID IS NULL OR DIV_ID LIKE 'NULL' OR DIV_ID LIKE '?',101.00,cast(DIV_ID as FLOAT)) DIV_ID,
IIF(DIV_NM IS NULL OR DIV_NM LIKE 'NULL' OR DIV_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DIV_NM)))) DIV_NM,
IIF(SUPER_DEPT_ID IS NULL OR SUPER_DEPT_ID LIKE 'NULL' OR SUPER_DEPT_ID LIKE '?',101.00,cast(SUPER_DEPT_ID as FLOAT)) SUPER_DEPT_ID,
IIF(SUPER_DEPT_NM IS NULL OR SUPER_DEPT_NM LIKE 'NULL' OR SUPER_DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUPER_DEPT_NM)))) SUPER_DEPT_NM,
IIF(DEPT_ID IS NULL OR DEPT_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(DEPT_ID as FLOAT)) DEPT_ID,
IIF(DEPT_NM IS NULL OR DEPT_NM LIKE 'NULL' OR DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEPT_NM)))) DEPT_NM,
IIF(CATEG_NM IS NULL OR CATEG_NM LIKE 'NULL' OR CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_NM)))) CATEG_NM,
IIF(SUB_CATEG_ID IS NULL OR SUB_CATEG_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(SUB_CATEG_ID as FLOAT)) SUB_CATEG_ID,
IIF(SUB_CATEG_NM IS NULL OR SUB_CATEG_NM LIKE 'NULL' OR SUB_CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUB_CATEG_NM)))) SUB_CATEG_NM,
IIF(ITEM_CATEG_GROUPING_ID IS NULL OR ITEM_CATEG_GROUPING_ID LIKE 'NULL' OR ITEM_CATEG_GROUPING_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ITEM_CATEG_GROUPING_ID)))) ITEM_CATEG_GROUPING_ID,
IIF(SRC_CRE_TS IS NULL OR SRC_CRE_TS LIKE 'NULL' OR SRC_CRE_TS LIKE '?','N/A',SRC_CRE_TS) SRC_CRE_TS,
IIF(SRC_MODFD_TS IS NULL OR SRC_MODFD_TS LIKE 'NULL' OR SRC_MODFD_TS LIKE '?','N/A',SRC_MODFD_TS) SRC_MODFD_TS,
IIF(SRC_HRCHY_MODFD_TS IS NULL OR SRC_HRCHY_MODFD_TS LIKE 'NULL' OR SRC_HRCHY_MODFD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(SRC_HRCHY_MODFD_TS,1,CHARINDEX('.',SRC_HRCHY_MODFD_TS)-1))) SRC_HRCHY_MODFD_TS,
IIF(CATEG_MGR_NM IS NULL OR CATEG_MGR_NM LIKE 'NULL' OR CATEG_MGR_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_MGR_NM)))) CATEG_MGR_NM,
IIF(BUYER_NM IS NULL OR BUYER_NM LIKE 'NULL' OR BUYER_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BUYER_NM)))) BUYER_NM,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT LIKE 'NULL' OR EFF_BEGIN_DT LIKE '?' OR (EFF_BEGIN_DT LIKE '%[0-9]%' AND NOT EFF_BEGIN_DT LIKE '%[/]%'),'01/01/1900',cast(eff_begin_dt as date)) eff_begin_dt,
IIF(EFF_END_DT IS NULL OR EFF_END_DT LIKE 'NULL' OR EFF_END_DT LIKE '?' OR (EFF_END_DT LIKE '%[0-9]%' AND NOT EFF_END_DT LIKE '%[/]%'),'01/01/1900',cast(EFF_END_DT as date)) EFF_END_DT,
IIF(RPT_HRCHY_ID_PATH IS NULL OR RPT_HRCHY_ID_PATH LIKE 'NULL' OR RPT_HRCHY_ID_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_ID_PATH)))) RPT_HRCHY_ID_PATH,
IIF(CATEG_ID IS NULL OR CATEG_ID LIKE 'NULL' OR CATEG_ID LIKE '?',101.00,cast(CATEG_ID as FLOAT)) CATEG_ID,
IIF(CONSUMABLE_IND IS NULL OR CONSUMABLE_IND LIKE 'NULL' OR CONSUMABLE_IND LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CONSUMABLE_IND)))) CONSUMABLE_IND,
IIF(CURR_IND IS NULL OR CURR_IND LIKE 'NULL' OR CURR_IND LIKE '?',101.00,cast(CURR_IND as FLOAT)) CURR_IND,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?' OR (CRE_DT LIKE '%[0-9]%' AND NOT CRE_DT LIKE '%[/]%') ,'01/01/1900',cast(ltrim(rtrim(cre_dt))as date)) cre_dt,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(UPD_TS,1,CHARINDEX('.',UPD_TS)-1))) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?','N/A',UPD_USER) UPD_USER
FROM [BCMPWMT].[RPT_HRCHY]) S
GROUP BY DIV_ID

SELECT COUNT(*) FROM dim_rpt_hrchy_SQL_IN1563
GROUP BY RPT_HRCHY_KEY
HAVING COUNT(*) > 1

SELECT RPT_HRCHY_ID,SRC_RPT_HRCHY_ID,RPT_HRCHY_PATH,DIV_NM,DEPT_ID
FROM dim_rpt_hrchy_SQL_IN1563
WHERE RPT_HRCHY_ID = 23470

SELECT RPT_HRCHY_ID,SRC_RPT_HRCHY_ID,RPT_HRCHY_PATH,DIV_NM,DEPT_ID
FROM (SELECT
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID LIKE 'NULL' OR RPT_HRCHY_ID LIKE '?',101.00,cast(RPT_HRCHY_ID as FLOAT)) RPT_HRCHY_ID,
IIF(SRC_RPT_HRCHY_ID IS NULL OR SRC_RPT_HRCHY_ID LIKE 'NULL' OR SRC_RPT_HRCHY_ID LIKE '?',101.00,cast(SRC_RPT_HRCHY_ID as FLOAT)) SRC_RPT_HRCHY_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(tenant_org_id)))) tenant_org_id,
IIF(RPT_HRCHY_PATH IS NULL OR RPT_HRCHY_PATH LIKE 'NULL' OR RPT_HRCHY_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_PATH)))) RPT_HRCHY_PATH,
IIF(DIV_ID IS NULL OR DIV_ID LIKE 'NULL' OR DIV_ID LIKE '?',101.00,cast(DIV_ID as FLOAT)) DIV_ID,
IIF(DIV_NM IS NULL OR DIV_NM LIKE 'NULL' OR DIV_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DIV_NM)))) DIV_NM,
IIF(SUPER_DEPT_ID IS NULL OR SUPER_DEPT_ID LIKE 'NULL' OR SUPER_DEPT_ID LIKE '?',101.00,cast(SUPER_DEPT_ID as FLOAT)) SUPER_DEPT_ID,
IIF(SUPER_DEPT_NM IS NULL OR SUPER_DEPT_NM LIKE 'NULL' OR SUPER_DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUPER_DEPT_NM)))) SUPER_DEPT_NM,
IIF(DEPT_ID IS NULL OR DEPT_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(DEPT_ID as FLOAT)) DEPT_ID,
IIF(DEPT_NM IS NULL OR DEPT_NM LIKE 'NULL' OR DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEPT_NM)))) DEPT_NM,
IIF(CATEG_NM IS NULL OR CATEG_NM LIKE 'NULL' OR CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_NM)))) CATEG_NM,
IIF(SUB_CATEG_ID IS NULL OR SUB_CATEG_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(SUB_CATEG_ID as FLOAT)) SUB_CATEG_ID,
IIF(SUB_CATEG_NM IS NULL OR SUB_CATEG_NM LIKE 'NULL' OR SUB_CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUB_CATEG_NM)))) SUB_CATEG_NM,
IIF(ITEM_CATEG_GROUPING_ID IS NULL OR ITEM_CATEG_GROUPING_ID LIKE 'NULL' OR ITEM_CATEG_GROUPING_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ITEM_CATEG_GROUPING_ID)))) ITEM_CATEG_GROUPING_ID,
IIF(SRC_CRE_TS IS NULL OR SRC_CRE_TS LIKE 'NULL' OR SRC_CRE_TS LIKE '?','N/A',SRC_CRE_TS) SRC_CRE_TS,
IIF(SRC_MODFD_TS IS NULL OR SRC_MODFD_TS LIKE 'NULL' OR SRC_MODFD_TS LIKE '?','N/A',SRC_MODFD_TS) SRC_MODFD_TS,
IIF(SRC_HRCHY_MODFD_TS IS NULL OR SRC_HRCHY_MODFD_TS LIKE 'NULL' OR SRC_HRCHY_MODFD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(SRC_HRCHY_MODFD_TS,1,CHARINDEX('.',SRC_HRCHY_MODFD_TS)-1))) SRC_HRCHY_MODFD_TS,
IIF(CATEG_MGR_NM IS NULL OR CATEG_MGR_NM LIKE 'NULL' OR CATEG_MGR_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_MGR_NM)))) CATEG_MGR_NM,
IIF(BUYER_NM IS NULL OR BUYER_NM LIKE 'NULL' OR BUYER_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BUYER_NM)))) BUYER_NM,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT LIKE 'NULL' OR EFF_BEGIN_DT LIKE '?' OR (EFF_BEGIN_DT LIKE '%[0-9]%' AND NOT EFF_BEGIN_DT LIKE '%[/]%'),'01/01/1900',cast(eff_begin_dt as date)) eff_begin_dt,
IIF(EFF_END_DT IS NULL OR EFF_END_DT LIKE 'NULL' OR EFF_END_DT LIKE '?' OR (EFF_END_DT LIKE '%[0-9]%' AND NOT EFF_END_DT LIKE '%[/]%'),'01/01/1900',cast(EFF_END_DT as date)) EFF_END_DT,
IIF(RPT_HRCHY_ID_PATH IS NULL OR RPT_HRCHY_ID_PATH LIKE 'NULL' OR RPT_HRCHY_ID_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_ID_PATH)))) RPT_HRCHY_ID_PATH,
IIF(CATEG_ID IS NULL OR CATEG_ID LIKE 'NULL' OR CATEG_ID LIKE '?',101.00,cast(CATEG_ID as FLOAT)) CATEG_ID,
IIF(CONSUMABLE_IND IS NULL OR CONSUMABLE_IND LIKE 'NULL' OR CONSUMABLE_IND LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CONSUMABLE_IND)))) CONSUMABLE_IND,
IIF(CURR_IND IS NULL OR CURR_IND LIKE 'NULL' OR CURR_IND LIKE '?',101.00,cast(CURR_IND as FLOAT)) CURR_IND,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?' OR (CRE_DT LIKE '%[0-9]%' AND NOT CRE_DT LIKE '%[/]%') ,'01/01/1900',cast(ltrim(rtrim(cre_dt))as date)) cre_dt,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(UPD_TS,1,CHARINDEX('.',UPD_TS)-1))) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?','N/A',UPD_USER) UPD_USER
FROM [BCMPWMT].[RPT_HRCHY]) S
WHERE RPT_HRCHY_ID = 23470

SELECT COUNT(*) FROM dim_rpt_hrchy_SQL_IN1563 T LEFT JOIN
(SELECT
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID LIKE 'NULL' OR RPT_HRCHY_ID LIKE '?',101.00,cast(RPT_HRCHY_ID as FLOAT)) RPT_HRCHY_ID,
IIF(SRC_RPT_HRCHY_ID IS NULL OR SRC_RPT_HRCHY_ID LIKE 'NULL' OR SRC_RPT_HRCHY_ID LIKE '?',101.00,cast(SRC_RPT_HRCHY_ID as FLOAT)) SRC_RPT_HRCHY_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(tenant_org_id)))) tenant_org_id,
IIF(RPT_HRCHY_PATH IS NULL OR RPT_HRCHY_PATH LIKE 'NULL' OR RPT_HRCHY_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_PATH)))) RPT_HRCHY_PATH,
IIF(DIV_ID IS NULL OR DIV_ID LIKE 'NULL' OR DIV_ID LIKE '?',101.00,cast(DIV_ID as FLOAT)) DIV_ID,
IIF(DIV_NM IS NULL OR DIV_NM LIKE 'NULL' OR DIV_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DIV_NM)))) DIV_NM,
IIF(SUPER_DEPT_ID IS NULL OR SUPER_DEPT_ID LIKE 'NULL' OR SUPER_DEPT_ID LIKE '?',101.00,cast(SUPER_DEPT_ID as FLOAT)) SUPER_DEPT_ID,
IIF(SUPER_DEPT_NM IS NULL OR SUPER_DEPT_NM LIKE 'NULL' OR SUPER_DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUPER_DEPT_NM)))) SUPER_DEPT_NM,
IIF(DEPT_ID IS NULL OR DEPT_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(DEPT_ID as FLOAT)) DEPT_ID,
IIF(DEPT_NM IS NULL OR DEPT_NM LIKE 'NULL' OR DEPT_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEPT_NM)))) DEPT_NM,
IIF(CATEG_NM IS NULL OR CATEG_NM LIKE 'NULL' OR CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_NM)))) CATEG_NM,
IIF(SUB_CATEG_ID IS NULL OR SUB_CATEG_ID LIKE 'NULL' OR DEPT_ID LIKE '?',101.00,cast(SUB_CATEG_ID as FLOAT)) SUB_CATEG_ID,
IIF(SUB_CATEG_NM IS NULL OR SUB_CATEG_NM LIKE 'NULL' OR SUB_CATEG_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(SUB_CATEG_NM)))) SUB_CATEG_NM,
IIF(ITEM_CATEG_GROUPING_ID IS NULL OR ITEM_CATEG_GROUPING_ID LIKE 'NULL' OR ITEM_CATEG_GROUPING_ID LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ITEM_CATEG_GROUPING_ID)))) ITEM_CATEG_GROUPING_ID,
IIF(SRC_CRE_TS IS NULL OR SRC_CRE_TS LIKE 'NULL' OR SRC_CRE_TS LIKE '?','N/A',SRC_CRE_TS) SRC_CRE_TS,
IIF(SRC_MODFD_TS IS NULL OR SRC_MODFD_TS LIKE 'NULL' OR SRC_MODFD_TS LIKE '?','N/A',SRC_MODFD_TS) SRC_MODFD_TS,
IIF(SRC_HRCHY_MODFD_TS IS NULL OR SRC_HRCHY_MODFD_TS LIKE 'NULL' OR SRC_HRCHY_MODFD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(SRC_HRCHY_MODFD_TS,1,CHARINDEX('.',SRC_HRCHY_MODFD_TS)-1))) SRC_HRCHY_MODFD_TS,
IIF(CATEG_MGR_NM IS NULL OR CATEG_MGR_NM LIKE 'NULL' OR CATEG_MGR_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CATEG_MGR_NM)))) CATEG_MGR_NM,
IIF(BUYER_NM IS NULL OR BUYER_NM LIKE 'NULL' OR BUYER_NM LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BUYER_NM)))) BUYER_NM,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT LIKE 'NULL' OR EFF_BEGIN_DT LIKE '?' OR (EFF_BEGIN_DT LIKE '%[0-9]%' AND NOT EFF_BEGIN_DT LIKE '%[/]%'),'01/01/1900',cast(eff_begin_dt as date)) eff_begin_dt,
IIF(EFF_END_DT IS NULL OR EFF_END_DT LIKE 'NULL' OR EFF_END_DT LIKE '?' OR (EFF_END_DT LIKE '%[0-9]%' AND NOT EFF_END_DT LIKE '%[/]%'),'01/01/1900',cast(EFF_END_DT as date)) EFF_END_DT,
IIF(RPT_HRCHY_ID_PATH IS NULL OR RPT_HRCHY_ID_PATH LIKE 'NULL' OR RPT_HRCHY_ID_PATH LIKE '?','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(RPT_HRCHY_ID_PATH)))) RPT_HRCHY_ID_PATH,
IIF(CATEG_ID IS NULL OR CATEG_ID LIKE 'NULL' OR CATEG_ID LIKE '?',101.00,cast(CATEG_ID as FLOAT)) CATEG_ID,
IIF(CONSUMABLE_IND IS NULL OR CONSUMABLE_IND LIKE 'NULL' OR CONSUMABLE_IND LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CONSUMABLE_IND)))) CONSUMABLE_IND,
IIF(CURR_IND IS NULL OR CURR_IND LIKE 'NULL' OR CURR_IND LIKE '?',101.00,cast(CURR_IND as FLOAT)) CURR_IND,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?' OR (CRE_DT LIKE '%[0-9]%' AND NOT CRE_DT LIKE '%[/]%') ,'01/01/1900',cast(ltrim(rtrim(cre_dt))as date)) cre_dt,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?','N/A',CONVERT(NVARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?','01/01/1900',CONVERT(DATETIME,SUBSTRING(UPD_TS,1,CHARINDEX('.',UPD_TS)-1))) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?','N/A',UPD_USER) UPD_USER
FROM [BCMPWMT].[RPT_HRCHY]) S
ON S.RPT_HRCHY_ID = T. RPT_HRCHY_ID
WHERE S.RPT_HRCHY_ID IS NULL AND 
(T.SRC_RPT_HRCHY_ID<>  S.SRC_RPT_HRCHY_ID  OR
T.TENANT_ORG_ID<>  S.TENANT_ORG_ID  OR
T.RPT_HRCHY_PATH<>  S.RPT_HRCHY_PATH  OR
T.DIV_ID<>  S.DIV_ID  OR
T.DIV_NM<>  S.DIV_NM  OR
T.SUPER_DEPT_ID<>  S.SUPER_DEPT_ID  OR
T.SUPER_DEPT_NM<>  S.SUPER_DEPT_NM  OR
T.DEPT_ID<>  S.DEPT_ID  OR
T.DEPT_NM<>  S.DEPT_NM  OR
T.CATEG_NM<>  S.CATEG_NM  OR
T.SUB_CATEG_ID<>  S.SUB_CATEG_ID  OR
T.SUB_CATEG_NM<>  S.SUB_CATEG_NM  OR
T.ITEM_CATEG_GROUPING_ID<>  S.ITEM_CATEG_GROUPING_ID  OR
T.SRC_CRE_TS<>  S.SRC_CRE_TS  OR
T.SRC_MODFD_TS<>  S.SRC_MODFD_TS  OR
T.SRC_HRCHY_MODFD_TS<>  S.SRC_HRCHY_MODFD_TS  OR
T.CATEG_MGR_NM<>  S.CATEG_MGR_NM  OR
T.BUYER_NM<>  S.BUYER_NM  OR
T.EFF_BEGIN_DT<>  S.EFF_BEGIN_DT  OR
T.EFF_END_DT<>  S.EFF_END_DT  OR
T.RPT_HRCHY_ID_PATH<>  S.RPT_HRCHY_ID_PATH  OR
T.CATEG_ID<>  S.CATEG_ID  OR
T.CONSUMABLE_IND<>  S.CONSUMABLE_IND  OR
T.CURR_IND<>  S.CURR_IND  OR
T.CRE_DT<>  S.CRE_DT  OR
T.CRE_USER<>  S.CRE_USER  OR
T.UPD_TS<>  S.UPD_TS  OR
T.UPD_USER<>  S.UPD_USER)

----------------------------------------------------------------------------------------------------------------------
SELECT * FROM dim_prod_rpt_hrchy_SQL_IN1563

SELECT COUNT(*) FROM dim_prod_rpt_hrchy_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT
IIF(PROD_RPT_HRCHY_ASSOC_ID IS NULL OR PROD_RPT_HRCHY_ASSOC_ID = 'NULL',101,cast(ltrim(rtrim(PROD_RPT_HRCHY_ASSOC_ID))as int)) PROD_RPT_HRCHY_ASSOC_ID,
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID))as int)) CATLG_ITEM_ID,
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID = 'NULL',101,cast(ltrim(rtrim(RPT_HRCHY_ID))as int)) RPT_HRCHY_ID,
IIF(RH_SUB_CATEG_NM IS NULL OR RH_SUB_CATEG_NM = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_NM))as int)) RH_SUB_CATEG_NM,
IIF(CURR_IND IS NULL OR CURR_IND = 'NULL',101,cast(ltrim(rtrim(CURR_IND))as int)) CURR_IND,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_BEGIN_DT)) AS DATE)) EFF_BEGIN_DT,
IIF(EFF_END_DT IS NULL OR EFF_END_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_END_DT)) AS DATE)) EFF_END_DT,
IIF(PRMRY_CATEG_PATH IS NULL OR PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(PRMRY_CATEG_PATH))) PRMRY_CATEG_PATH,
IIF(CHAR_PRMRY_CATEG_PATH IS NULL OR CHAR_PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(CHAR_PRMRY_CATEG_PATH))) CHAR_PRMRY_CATEG_PATH,
IIF(RH_SUB_CATEG_ID IS NULL OR RH_SUB_CATEG_ID = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_ID))as int)) RH_SUB_CATEG_ID,
IIF(PRMRY_SHELF_ID IS NULL OR PRMRY_SHELF_ID = 'NULL',101,cast(ltrim(rtrim(PRMRY_SHELF_ID))as int)) PRMRY_SHELF_ID,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(UPD_TS)) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[PROD_RPT_HRCHY]) S

SELECT CRE_USER,COUNT(*) FROM dim_prod_rpt_hrchy_SQL_IN1563
GROUP BY CRE_USER

SELECT CRE_USER,COUNT(*) FROM
(SELECT
IIF(PROD_RPT_HRCHY_ASSOC_ID IS NULL OR PROD_RPT_HRCHY_ASSOC_ID = 'NULL',101,cast(ltrim(rtrim(PROD_RPT_HRCHY_ASSOC_ID))as int)) PROD_RPT_HRCHY_ASSOC_ID,
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID))as int)) CATLG_ITEM_ID,
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID = 'NULL',101,cast(ltrim(rtrim(RPT_HRCHY_ID))as int)) RPT_HRCHY_ID,
IIF(RH_SUB_CATEG_NM IS NULL OR RH_SUB_CATEG_NM = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_NM))as int)) RH_SUB_CATEG_NM,
IIF(CURR_IND IS NULL OR CURR_IND = 'NULL',101,cast(ltrim(rtrim(CURR_IND))as int)) CURR_IND,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_BEGIN_DT)) AS DATE)) EFF_BEGIN_DT,
IIF(EFF_END_DT IS NULL OR EFF_END_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_END_DT)) AS DATE)) EFF_END_DT,
IIF(PRMRY_CATEG_PATH IS NULL OR PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(PRMRY_CATEG_PATH))) PRMRY_CATEG_PATH,
IIF(CHAR_PRMRY_CATEG_PATH IS NULL OR CHAR_PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(CHAR_PRMRY_CATEG_PATH))) CHAR_PRMRY_CATEG_PATH,
IIF(RH_SUB_CATEG_ID IS NULL OR RH_SUB_CATEG_ID = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_ID))as int)) RH_SUB_CATEG_ID,
IIF(PRMRY_SHELF_ID IS NULL OR PRMRY_SHELF_ID = 'NULL',101,cast(ltrim(rtrim(PRMRY_SHELF_ID))as int)) PRMRY_SHELF_ID,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(UPD_TS)) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[PROD_RPT_HRCHY]) S
GROUP BY CRE_USER

SELECT COUNT(*) FROM dim_prod_rpt_hrchy_SQL_IN1563
GROUP BY PROD_RPT_HRCHY_ASSOC_ID
HAVING COUNT(*) > 1

SELECT PROD_RPT_HRCHY_ASSOC_ID,CATLG_ITEM_ID,RPT_HRCHY_ID,RH_SUB_CATEG_NM,CURR_IND
FROM dim_prod_rpt_hrchy_SQL_IN1563
WHERE CATLG_ITEM_ID = 46944831

SELECT PROD_RPT_HRCHY_ASSOC_ID,CATLG_ITEM_ID,RPT_HRCHY_ID,RH_SUB_CATEG_NM,CURR_IND
FROM 
(SELECT
IIF(PROD_RPT_HRCHY_ASSOC_ID IS NULL OR PROD_RPT_HRCHY_ASSOC_ID = 'NULL',101,cast(ltrim(rtrim(PROD_RPT_HRCHY_ASSOC_ID))as int)) PROD_RPT_HRCHY_ASSOC_ID,
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID))as int)) CATLG_ITEM_ID,
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID = 'NULL',101,cast(ltrim(rtrim(RPT_HRCHY_ID))as int)) RPT_HRCHY_ID,
IIF(RH_SUB_CATEG_NM IS NULL OR RH_SUB_CATEG_NM = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_NM))as int)) RH_SUB_CATEG_NM,
IIF(CURR_IND IS NULL OR CURR_IND = 'NULL',101,cast(ltrim(rtrim(CURR_IND))as int)) CURR_IND,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_BEGIN_DT)) AS DATE)) EFF_BEGIN_DT,
IIF(EFF_END_DT IS NULL OR EFF_END_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_END_DT)) AS DATE)) EFF_END_DT,
IIF(PRMRY_CATEG_PATH IS NULL OR PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(PRMRY_CATEG_PATH))) PRMRY_CATEG_PATH,
IIF(CHAR_PRMRY_CATEG_PATH IS NULL OR CHAR_PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(CHAR_PRMRY_CATEG_PATH))) CHAR_PRMRY_CATEG_PATH,
IIF(RH_SUB_CATEG_ID IS NULL OR RH_SUB_CATEG_ID = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_ID))as int)) RH_SUB_CATEG_ID,
IIF(PRMRY_SHELF_ID IS NULL OR PRMRY_SHELF_ID = 'NULL',101,cast(ltrim(rtrim(PRMRY_SHELF_ID))as int)) PRMRY_SHELF_ID,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(UPD_TS)) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[PROD_RPT_HRCHY]) S
WHERE CATLG_ITEM_ID = 46944831

SELECT COUNT(*) FROM dim_prod_rpt_hrchy_SQL_IN1563 T LEFT JOIN 
(SELECT
IIF(PROD_RPT_HRCHY_ASSOC_ID IS NULL OR PROD_RPT_HRCHY_ASSOC_ID = 'NULL',101,cast(ltrim(rtrim(PROD_RPT_HRCHY_ASSOC_ID))as int)) PROD_RPT_HRCHY_ASSOC_ID,
IIF(CATLG_ITEM_ID IS NULL OR CATLG_ITEM_ID = 'NULL',101,cast(ltrim(rtrim(CATLG_ITEM_ID))as int)) CATLG_ITEM_ID,
IIF(RPT_HRCHY_ID IS NULL OR RPT_HRCHY_ID = 'NULL',101,cast(ltrim(rtrim(RPT_HRCHY_ID))as int)) RPT_HRCHY_ID,
IIF(RH_SUB_CATEG_NM IS NULL OR RH_SUB_CATEG_NM = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_NM))as int)) RH_SUB_CATEG_NM,
IIF(CURR_IND IS NULL OR CURR_IND = 'NULL',101,cast(ltrim(rtrim(CURR_IND))as int)) CURR_IND,
IIF(EFF_BEGIN_DT IS NULL OR EFF_BEGIN_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_BEGIN_DT)) AS DATE)) EFF_BEGIN_DT,
IIF(EFF_END_DT IS NULL OR EFF_END_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(EFF_END_DT)) AS DATE)) EFF_END_DT,
IIF(PRMRY_CATEG_PATH IS NULL OR PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(PRMRY_CATEG_PATH))) PRMRY_CATEG_PATH,
IIF(CHAR_PRMRY_CATEG_PATH IS NULL OR CHAR_PRMRY_CATEG_PATH = 'NULL','N/A',LTRIM(RTRIM(CHAR_PRMRY_CATEG_PATH))) CHAR_PRMRY_CATEG_PATH,
IIF(RH_SUB_CATEG_ID IS NULL OR RH_SUB_CATEG_ID = 'NULL',101,cast(ltrim(rtrim(RH_SUB_CATEG_ID))as int)) RH_SUB_CATEG_ID,
IIF(PRMRY_SHELF_ID IS NULL OR PRMRY_SHELF_ID = 'NULL',101,cast(ltrim(rtrim(PRMRY_SHELF_ID))as int)) PRMRY_SHELF_ID,
IIF(CRE_DT IS NULL OR CRE_DT = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS = 'NULL','01/01/1900',CAST(LTRIM(RTRIM(UPD_TS)) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER = 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[PROD_RPT_HRCHY]) S
ON T. PROD_RPT_HRCHY_ASSOC_ID = S.PROD_RPT_HRCHY_ASSOC_ID
WHERE S.PROD_RPT_HRCHY_ASSOC_ID IS NULL AND 
(T.CATLG_ITEM_ID<>  S.CATLG_ITEM_ID  OR
T.RPT_HRCHY_ID<>  S.RPT_HRCHY_ID  OR
T.RH_SUB_CATEG_NM<>  S.RH_SUB_CATEG_NM  OR
T.CURR_IND<>  S.CURR_IND  OR
T.EFF_BEGIN_DT<>  S.EFF_BEGIN_DT  OR
T.EFF_END_DT<>  S.EFF_END_DT  OR
T.PRMRY_CATEG_PATH<>  S.PRMRY_CATEG_PATH  OR
T.CHAR_PRMRY_CATEG_PATH<>  S.CHAR_PRMRY_CATEG_PATH  OR
T.RH_SUB_CATEG_ID<>  S.RH_SUB_CATEG_ID  OR
T.PRMRY_SHELF_ID<>  S.PRMRY_SHELF_ID  OR
T.CRE_DT<>  S.CRE_DT  OR
T.CRE_USER<>  S.CRE_USER  OR
T.UPD_TS<>  S.UPD_TS  OR
T.UPD_USER<>  S.UPD_USER)

----------------------------------------------------------------------------------------------------------------------
SELECT * FROM DIM_CUST_ACCT_DETAILS_SQL_IN1563

SELECT COUNT(*) FROM DIM_CUST_ACCT_DETAILS_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT 
A.CUST_ID AS CUST_ID,
A.TENANT_ORG_ID AS TENANT_ORG_ID,
A.CUST_TYPE_ID AS CUST_TYPE_ID,
A.NICKNAME AS NICKNAME,
A.SALUTE AS SALUTE,
A.MIDDLE_NM AS MIDDLE_NM,
A.CUST_TITLE AS CUST_TITLE,
A.SUFFIX AS SUFFIX,
A.WM_EMPLOYEE_ID AS WM_EMPLOYEE_ID,
A.CRE_DT AS CRE_DT,
A.CRE_USER AS CRE_USER,
A.UPD_TS AS UPD_TS,
A.UPD_USER AS UPD_USER,
A.SIGNUP_TS AS SIGNUP_TS,
A.REALM_ID AS REALM_ID,
A.VALID_CUST_IND AS VALID_CUST_IND,
A.DELTD_YN AS DELTD_YN,
B.ACCT_ID AS ACCT_ID,
B.CUST_ID AS CUST_ID_1,
B.TENANT_ORG_ID AS TENANT_ORG_ID_1,
B.ACCT_STS_ID AS ACCT_STS_ID,
B.ACCT_TYPE_ID AS ACCT_TYPE_ID,
B.EMAIL AS EMAIL,
B.VALID_CUST_IND AS VALID_CUST_IND_1,
B.CRE_DT AS CRE_DT_1,
B.CRE_USER AS CRE_USER_1,
B.UPD_TS AS UPD_TS_1,
B.UPD_USER AS UPD_USER_1,
B.StartDate AS StartDate,
B.EndDate AS EndDate,
B.DELTD_YN AS DELTD_YN_1
FROM dim_cust_SQL_IN1563 A LEFT JOIN dim_CUST_ACCT_SQL_IN1563 B
ON A.CUST_ID = B.CUST_ID) S

SELECT SALUTE,COUNT(*) FROM DIM_CUST_ACCT_DETAILS_SQL_IN1563 GROUP BY SALUTE

SELECT SALUTE,COUNT(*) FROM 
(SELECT 
A.CUST_ID AS CUST_ID,
A.TENANT_ORG_ID AS TENANT_ORG_ID,
A.CUST_TYPE_ID AS CUST_TYPE_ID,
A.NICKNAME AS NICKNAME,
A.SALUTE AS SALUTE,
A.MIDDLE_NM AS MIDDLE_NM,
A.CUST_TITLE AS CUST_TITLE,
A.SUFFIX AS SUFFIX,
A.WM_EMPLOYEE_ID AS WM_EMPLOYEE_ID,
A.CRE_DT AS CRE_DT,
A.CRE_USER AS CRE_USER,
A.UPD_TS AS UPD_TS,
A.UPD_USER AS UPD_USER,
A.SIGNUP_TS AS SIGNUP_TS,
A.REALM_ID AS REALM_ID,
A.VALID_CUST_IND AS VALID_CUST_IND,
A.DELTD_YN AS DELTD_YN,
B.ACCT_ID AS ACCT_ID,
B.CUST_ID AS CUST_ID_1,
B.TENANT_ORG_ID AS TENANT_ORG_ID_1,
B.ACCT_STS_ID AS ACCT_STS_ID,
B.ACCT_TYPE_ID AS ACCT_TYPE_ID,
B.EMAIL AS EMAIL,
B.VALID_CUST_IND AS VALID_CUST_IND_1,
B.CRE_DT AS CRE_DT_1,
B.CRE_USER AS CRE_USER_1,
B.UPD_TS AS UPD_TS_1,
B.UPD_USER AS UPD_USER_1,
B.StartDate AS StartDate,
B.EndDate AS EndDate,
B.DELTD_YN AS DELTD_YN_1
FROM dim_cust_SQL_IN1563 A LEFT JOIN dim_CUST_ACCT_SQL_IN1563 B
ON A.CUST_ID = B.CUST_ID) S
GROUP BY SALUTE

SELECT COUNT(*) FROM DIM_CUST_ACCT_DETAILS_SQL_IN1563
GROUP BY CUST_ID
HAVING COUNT(*) > 1

SELECT CUST_ID,TENANT_ORG_ID,CUST_TYPE_ID,NICKNAME,SALUTE
FROM DIM_CUST_ACCT_DETAILS_SQL_IN1563
WHERE CUST_ID = 75620491

SELECT CUST_ID,TENANT_ORG_ID,CUST_TYPE_ID,NICKNAME,SALUTE
FROM 
(SELECT 
A.CUST_ID AS CUST_ID,
A.TENANT_ORG_ID AS TENANT_ORG_ID,
A.CUST_TYPE_ID AS CUST_TYPE_ID,
A.NICKNAME AS NICKNAME,
A.SALUTE AS SALUTE,
A.MIDDLE_NM AS MIDDLE_NM,
A.CUST_TITLE AS CUST_TITLE,
A.SUFFIX AS SUFFIX,
A.WM_EMPLOYEE_ID AS WM_EMPLOYEE_ID,
A.CRE_DT AS CRE_DT,
A.CRE_USER AS CRE_USER,
A.UPD_TS AS UPD_TS,
A.UPD_USER AS UPD_USER,
A.SIGNUP_TS AS SIGNUP_TS,
A.REALM_ID AS REALM_ID,
A.VALID_CUST_IND AS VALID_CUST_IND,
A.DELTD_YN AS DELTD_YN,
B.ACCT_ID AS ACCT_ID,
B.CUST_ID AS CUST_ID_1,
B.TENANT_ORG_ID AS TENANT_ORG_ID_1,
B.ACCT_STS_ID AS ACCT_STS_ID,
B.ACCT_TYPE_ID AS ACCT_TYPE_ID,
B.EMAIL AS EMAIL,
B.VALID_CUST_IND AS VALID_CUST_IND_1,
B.CRE_DT AS CRE_DT_1,
B.CRE_USER AS CRE_USER_1,
B.UPD_TS AS UPD_TS_1,
B.UPD_USER AS UPD_USER_1,
B.StartDate AS StartDate,
B.EndDate AS EndDate,
B.DELTD_YN AS DELTD_YN_1
FROM dim_cust_SQL_IN1563 A LEFT JOIN dim_CUST_ACCT_SQL_IN1563 B
ON A.CUST_ID = B.CUST_ID) S
WHERE CUST_ID = 75620491

SELECT COUNT(*) FROM DIM_CUST_ACCT_DETAILS_SQL_IN1563 T LEFT JOIN
(SELECT 
A.CUST_ID AS CUST_ID,
A.TENANT_ORG_ID AS TENANT_ORG_ID,
A.CUST_TYPE_ID AS CUST_TYPE_ID,
A.NICKNAME AS NICKNAME,
A.SALUTE AS SALUTE,
A.MIDDLE_NM AS MIDDLE_NM,
A.CUST_TITLE AS CUST_TITLE,
A.SUFFIX AS SUFFIX,
A.WM_EMPLOYEE_ID AS WM_EMPLOYEE_ID,
A.CRE_DT AS CRE_DT,
A.CRE_USER AS CRE_USER,
A.UPD_TS AS UPD_TS,
A.UPD_USER AS UPD_USER,
A.SIGNUP_TS AS SIGNUP_TS,
A.REALM_ID AS REALM_ID,
A.VALID_CUST_IND AS VALID_CUST_IND,
A.DELTD_YN AS DELTD_YN,
B.ACCT_ID AS ACCT_ID,
B.CUST_ID AS CUST_ID_1,
B.TENANT_ORG_ID AS TENANT_ORG_ID_1,
B.ACCT_STS_ID AS ACCT_STS_ID,
B.ACCT_TYPE_ID AS ACCT_TYPE_ID,
B.EMAIL AS EMAIL,
B.VALID_CUST_IND AS VALID_CUST_IND_1,
B.CRE_DT AS CRE_DT_1,
B.CRE_USER AS CRE_USER_1,
B.UPD_TS AS UPD_TS_1,
B.UPD_USER AS UPD_USER_1,
B.StartDate AS StartDate,
B.EndDate AS EndDate,
B.DELTD_YN AS DELTD_YN_1
FROM dim_cust_SQL_IN1563 A LEFT JOIN dim_CUST_ACCT_SQL_IN1563 B
ON A.CUST_ID = B.CUST_ID) S
ON T.CUST_ID = S.CUST_ID
WHERE S.CUST_ID IS NULL AND(
T.	TENANT_ORG_ID	<>	S.	TENANT_ORG_ID	  OR
T.	CUST_TYPE_ID	<>	S.	CUST_TYPE_ID	  OR
T.	NICKNAME	<>	S.	NICKNAME	  OR
T.	SALUTE	<>	S.	SALUTE	  OR
T.	MIDDLE_NM	<>	S.	MIDDLE_NM	  OR
T.	CUST_TITLE	<>	S.	CUST_TITLE	  OR
T.	SUFFIX	<>	S.	SUFFIX	  OR
T.	WM_EMPLOYEE_ID	<>	S.	WM_EMPLOYEE_ID	  OR
T.	CRE_DT	<>	S.	CRE_DT	  OR
T.	CRE_USER	<>	S.	CRE_USER	  OR
T.	UPD_TS	<>	S.	UPD_TS	  OR
T.	UPD_USER	<>	S.	UPD_USER	  OR
T.	SIGNUP_TS	<>	S.	SIGNUP_TS	  OR
T.	REALM_ID	<>	S.	REALM_ID	  OR
T.	VALID_CUST_IND	<>	S.	VALID_CUST_IND	  OR
T.	DELTD_YN	<>	S.	DELTD_YN	  OR
T.	ACCT_ID	<>	S.	ACCT_ID	  OR
T.	CUST_ID_1	<>	S.	CUST_ID_1	  OR
T.	TENANT_ORG_ID_1	<>	S.	TENANT_ORG_ID_1	  OR
T.	ACCT_STS_ID	<>	S.	ACCT_STS_ID	  OR
T.	ACCT_TYPE_ID	<>	S.	ACCT_TYPE_ID	  OR
T.	EMAIL	<>	S.	EMAIL	  OR
T.	VALID_CUST_IND_1	<>	S.	VALID_CUST_IND_1	  OR
T.	CRE_DT_1	<>	S.	CRE_DT_1	  OR
T.	CRE_USER_1	<>	S.	CRE_USER_1	  OR
T.	UPD_TS_1	<>	S.	UPD_TS_1	  OR
T.	UPD_USER_1	<>	S.	UPD_USER_1	  OR
T.	StartDate	<>	S.	StartDate	  OR
T.	EndDate	<>	S.	EndDate	  OR
T.	DELTD_YN_1	<>	S.	DELTD_YN_1	  
)

------------------------------------------------------------------------------------------------------------------------
SELECT * FROM dim_cust_address_SQL_IN1563

SELECT COUNT(*) FROM dim_cust_address_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT
IIF(ADDR_ID IS NULL OR ADDR_ID like 'NULL' OR ADDR_ID LIKE '?', convert(float,101.00),ADDR_ID) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID like 'NULL' OR TENANT_ORG_ID LIKE '?', 101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID like 'NULL' OR DATA_SRC_ID LIKE '?', 101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(VALID_TS)) AS DATETIME)) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?', 'N/A', ltrim(rtrim(valid_sts))) valid_sts,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?', 'N/A', ltrim(rtrim(CITY))) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?', 'N/A', ltrim(rtrim(MUNICIPALITY))) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(POSTAL_CD))as int)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_EXTN))as int)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(char,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
getdate() as StartDate,
NULL AS EndDate ,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?', '01/01/1900',CAST(SUBSTRING(LTRIM(RTRIM(UPD_TS)),1,CHARINDEX('.',UPD_TS)-1) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[CUST_ADDR]) S

SELECT DATA_SRC_ID,COUNT(*) FROM dim_cust_address_SQL_IN1563
GROUP BY DATA_SRC_ID

SELECT DATA_SRC_ID,COUNT(*) FROM
(SELECT
IIF(ADDR_ID IS NULL OR ADDR_ID like 'NULL' OR ADDR_ID LIKE '?', convert(float,101.00),ADDR_ID) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID like 'NULL' OR TENANT_ORG_ID LIKE '?', 101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID like 'NULL' OR DATA_SRC_ID LIKE '?', 101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(VALID_TS)) AS DATETIME)) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?', 'N/A', ltrim(rtrim(valid_sts))) valid_sts,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?', 'N/A', ltrim(rtrim(CITY))) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?', 'N/A', ltrim(rtrim(MUNICIPALITY))) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(POSTAL_CD))as int)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_EXTN))as int)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(char,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
getdate() as StartDate,
NULL AS EndDate ,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?', '01/01/1900',CAST(SUBSTRING(LTRIM(RTRIM(UPD_TS)),1,CHARINDEX('.',UPD_TS)-1) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[CUST_ADDR]) S
GROUP BY DATA_SRC_ID

SELECT COUNT(*) FROM dim_cust_address_SQL_IN1563 
GROUP BY DATA_SRC_ID
HAVING COUNT(*) > 1

SELECT ADDR_ID,TENANT_ORG_ID,DATA_SRC_ID,VALID_TS,CITY
FROM dim_cust_address_SQL_IN1563
WHERE ADDR_ID = 2758054980

SELECT ADDR_ID,TENANT_ORG_ID,DATA_SRC_ID,VALID_TS,CITY
FROM (SELECT
IIF(ADDR_ID IS NULL OR ADDR_ID like 'NULL' OR ADDR_ID LIKE '?', convert(float,101.00),ADDR_ID) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID like 'NULL' OR TENANT_ORG_ID LIKE '?', 101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID like 'NULL' OR DATA_SRC_ID LIKE '?', 101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(VALID_TS)) AS DATETIME)) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?', 'N/A', ltrim(rtrim(valid_sts))) valid_sts,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?', 'N/A', ltrim(rtrim(CITY))) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?', 'N/A', ltrim(rtrim(MUNICIPALITY))) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(POSTAL_CD))as int)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_EXTN))as int)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(char,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
getdate() as StartDate,
NULL AS EndDate ,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?', '01/01/1900',CAST(SUBSTRING(LTRIM(RTRIM(UPD_TS)),1,CHARINDEX('.',UPD_TS)-1) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[CUST_ADDR]) S
WHERE ADDR_ID = 2758054980

SELECT COUNT(*) FROM dim_cust_address_SQL_IN1563 T LEFT JOIN
(SELECT
IIF(ADDR_ID IS NULL OR ADDR_ID like 'NULL' OR ADDR_ID LIKE '?', convert(float,101.00),ADDR_ID) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID like 'NULL' OR TENANT_ORG_ID LIKE '?', 101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID like 'NULL' OR DATA_SRC_ID LIKE '?', 101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(VALID_TS)) AS DATETIME)) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?', 'N/A', ltrim(rtrim(valid_sts))) valid_sts,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?', 'N/A', ltrim(rtrim(CITY))) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?', 'N/A', ltrim(rtrim(MUNICIPALITY))) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(POSTAL_CD))as int)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_EXTN))as int)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(char,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
getdate() as StartDate,
NULL AS EndDate ,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?', '01/01/1900',CAST(SUBSTRING(LTRIM(RTRIM(UPD_TS)),1,CHARINDEX('.',UPD_TS)-1) AS datetime)) UPD_TS,
IIF(UPD_USER IS NULL OR UPD_USER LIKE 'NULL' OR UPD_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(UPD_USER)))) UPD_USER
FROM [BCMPWMT].[CUST_ADDR]) S
ON T.ADDR_ID = S.ADDR_ID
WHERE S.ADDR_ID IS NULL AND
(T.	TENANT_ORG_ID	<>	S.	TENANT_ORG_ID	  OR
T.	DATA_SRC_ID	<>	S.	DATA_SRC_ID	  OR
T.	VALID_TS	<>	S.	VALID_TS	  OR
T.	VALID_STS	<>	S.	VALID_STS	  OR
T.	CITY	<>	S.	CITY	  OR
T.	MUNICIPALITY	<>	S.	MUNICIPALITY	  OR
T.	TOWN	<>	S.	TOWN	  OR
T.	VILLAGE	<>	S.	VILLAGE	  OR
T.	COUNTY	<>	S.	COUNTY	  OR
T.	DISTRICT	<>	S.	DISTRICT	  OR
T.	ZIP_CD	<>	S.	ZIP_CD	  OR
T.	POSTAL_CD	<>	S.	POSTAL_CD	  OR
T.	ZIP_EXTN	<>	S.	ZIP_EXTN	  OR
T.	ADDR_TYPE	<>	S.	ADDR_TYPE	  OR
T.	AREA	<>	S.	AREA	  OR
T.	CNTRY_CD	<>	S.	CNTRY_CD	  OR
T.	STATE_PRVNCE_TYPE	<>	S.	STATE_PRVNCE_TYPE	  OR
T.	OWNER_ID	<>	S.	OWNER_ID	  OR
T.	PARENT_ID	<>	S.	PARENT_ID	  OR
T.	DELTD_YN	<>	S.	DELTD_YN	  OR
T.	StartDate	<>	S.	StartDate	  OR
T.	EndDate	<>	S.	EndDate	  OR
T.	CRE_DT	<>	S.	CRE_DT	  OR
T.	CRE_USER	<>	S.	CRE_USER	  OR
T.	UPD_TS	<>	S.	UPD_TS	  OR
T.	UPD_USER	<>	S.	UPD_USER)

------------------------------------------------------------------------------------------------------------------------
SELECT * FROM dim_cust_addr1_SQL_IN1563

SELECT COUNT(*) FROM dim_cust_addr1_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT 
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101,cast(ltrim(rtrim(addr_id))as bigint)) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?','N/A',convert(nvarchar,format(convert(date,VALID_TS),'dd-MM-yyyy'))) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?',101,cast(ltrim(rtrim(VALID_STS))as int)) VALID_STS,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?','N/A',cast(ltrim(rtrim(CITY))as nvarchar)) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?','N/A',IIF(LEN(MUNICIPALITY) > 2 OR LEN(MUNICIPALITY) < 9,LTRIM(RTRIM(MUNICIPALITY)),'N/A')) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(POSTAL_CD))as NVARCHAR)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(ZIP_EXTN))as NVARCHAR)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(NVARchar,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER
FROM [BCMPWMT].[CUST_ADDR1]) S

SELECT TENANT_ORG_ID,COUNT(*) FROM dim_cust_addr1_SQL_IN1563 GROUP BY TENANT_ORG_ID

SELECT TENANT_ORG_ID,COUNT(*) FROM 
(SELECT 
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101,cast(ltrim(rtrim(addr_id))as bigint)) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?','N/A',convert(nvarchar,format(convert(date,VALID_TS),'dd-MM-yyyy'))) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?',101,cast(ltrim(rtrim(VALID_STS))as int)) VALID_STS,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?','N/A',cast(ltrim(rtrim(CITY))as nvarchar)) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?','N/A',IIF(LEN(MUNICIPALITY) > 2 OR LEN(MUNICIPALITY) < 9,LTRIM(RTRIM(MUNICIPALITY)),'N/A')) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(POSTAL_CD))as NVARCHAR)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(ZIP_EXTN))as NVARCHAR)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(NVARchar,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER
FROM [BCMPWMT].[CUST_ADDR1]) S
GROUP BY TENANT_ORG_ID

SELECT COUNT(*) FROM dim_cust_addr1_SQL_IN1563
GROUP BY ADDR_ID
HAVING COUNT(*) > 1

SELECT ADDR_ID,TENANT_ORG_ID,DATA_SRC_ID,CITY,COUNTY
FROM dim_cust_addr1_SQL_IN1563
WHERE ADDR_ID = 2969262550

SELECT ADDR_ID,TENANT_ORG_ID,DATA_SRC_ID,CITY,COUNTY
FROM 
(SELECT 
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101,cast(ltrim(rtrim(addr_id))as bigint)) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?','N/A',convert(nvarchar,format(convert(date,VALID_TS),'dd-MM-yyyy'))) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?',101,cast(ltrim(rtrim(VALID_STS))as int)) VALID_STS,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?','N/A',cast(ltrim(rtrim(CITY))as nvarchar)) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?','N/A',IIF(LEN(MUNICIPALITY) > 2 OR LEN(MUNICIPALITY) < 9,LTRIM(RTRIM(MUNICIPALITY)),'N/A')) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(POSTAL_CD))as NVARCHAR)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(ZIP_EXTN))as NVARCHAR)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(NVARchar,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER
FROM [BCMPWMT].[CUST_ADDR1]) S
WHERE ADDR_ID = 2969262550

SELECT COUNT(*) FROM dim_cust_addr1_SQL_IN1563 T LEFT JOIN
(SELECT 
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101,cast(ltrim(rtrim(addr_id))as bigint)) ADDR_ID,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101,cast(ltrim(rtrim(TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101,cast(ltrim(rtrim(DATA_SRC_ID))as int)) DATA_SRC_ID,
IIF(VALID_TS IS NULL OR VALID_TS LIKE 'NULL' OR VALID_TS LIKE '?','N/A',convert(nvarchar,format(convert(date,VALID_TS),'dd-MM-yyyy'))) VALID_TS,
IIF(VALID_STS IS NULL OR VALID_STS LIKE 'NULL' OR VALID_STS LIKE '?',101,cast(ltrim(rtrim(VALID_STS))as int)) VALID_STS,
IIF(CITY IS NULL OR CITY LIKE 'NULL' OR CITY LIKE '?','N/A',cast(ltrim(rtrim(CITY))as nvarchar)) CITY,
IIF(MUNICIPALITY IS NULL OR MUNICIPALITY LIKE 'NULL' OR MUNICIPALITY LIKE '?','N/A',IIF(LEN(MUNICIPALITY) > 2 OR LEN(MUNICIPALITY) < 9,LTRIM(RTRIM(MUNICIPALITY)),'N/A')) MUNICIPALITY,
IIF(TOWN IS NULL OR TOWN LIKE 'NULL' OR TOWN LIKE '?', 'N/A', ltrim(rtrim(TOWN))) TOWN,
IIF(VILLAGE IS NULL OR VILLAGE LIKE 'NULL' OR VILLAGE LIKE '?', 'N/A', ltrim(rtrim(VILLAGE))) VILLAGE,
IIF(COUNTY IS NULL OR COUNTY LIKE 'NULL' OR COUNTY LIKE '?', 'N/A', ltrim(rtrim(COUNTY))) COUNTY,
IIF(DISTRICT IS NULL OR DISTRICT LIKE 'NULL' OR DISTRICT LIKE '?', 'N/A', ltrim(rtrim(DISTRICT))) DISTRICT,
IIF(ZIP_CD IS NULL OR ZIP_CD like 'NULL' OR ZIP_CD LIKE '?' OR ZIP_CD LIKE '%[A-Za-z]%', 101,cast(ltrim(rtrim(ZIP_CD))as int)) ZIP_CD,
IIF(POSTAL_CD IS NULL OR POSTAL_CD like 'NULL' OR POSTAL_CD LIKE '?' OR POSTAL_CD LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(POSTAL_CD))as NVARCHAR)) POSTAL_CD,
IIF(ZIP_EXTN IS NULL OR ZIP_EXTN like 'NULL' OR ZIP_EXTN LIKE '?' OR ZIP_EXTN LIKE '%[A-Za-z]%', 'N/A',cast(ltrim(rtrim(ZIP_EXTN))as NVARCHAR)) ZIP_EXTN,
IIF(ADDR_TYPE IS NULL OR ADDR_TYPE LIKE 'NULL' OR ADDR_TYPE LIKE '?', 'N/A', ltrim(rtrim(ADDR_TYPE))) ADDR_TYPE,
IIF(AREA IS NULL OR AREA LIKE 'NULL' OR AREA LIKE '?', 'N/A', ltrim(rtrim(AREA))) AREA,
IIF(CNTRY_CD IS NULL OR CNTRY_CD LIKE 'NULL' OR CNTRY_CD LIKE '?', 'N/A', ltrim(rtrim(CNTRY_CD))) CNTRY_CD,
IIF(STATE_PRVNCE_TYPE IS NULL OR STATE_PRVNCE_TYPE LIKE 'NULL' OR STATE_PRVNCE_TYPE LIKE '?', 'N/A', ltrim(rtrim(STATE_PRVNCE_TYPE))) STATE_PRVNCE_TYPE,
IIF(OWNER_ID IS NULL OR OWNER_ID like 'NULL' OR OWNER_ID LIKE '?', 101,cast(ltrim(rtrim(OWNER_ID))as int)) OWNER_ID,
IIF(PARENT_ID IS NULL OR PARENT_ID like 'NULL' OR PARENT_ID LIKE '?', 101,cast(ltrim(rtrim(PARENT_ID))as int)) PARENT_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?', 'N/A', convert(NVARchar,ltrim(rtrim(DELTD_YN)))) DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?', '01/01/1900',CAST(LTRIM(RTRIM(CRE_DT)) AS DATE)) CRE_DT,
IIF(CRE_USER IS NULL OR CRE_USER LIKE 'NULL' OR CRE_USER LIKE '?', 'N/A', convert(nvarchar,ltrim(rtrim(CRE_USER)))) CRE_USER
FROM [BCMPWMT].[CUST_ADDR1]) S
ON T.ADDR_ID = S.ADDR_ID
WHERE S.ADDR_ID IS NULL AND
(T.	TENANT_ORG_ID	<>	S.	TENANT_ORG_ID	  OR
T.	DATA_SRC_ID	<>	S.	DATA_SRC_ID	  OR
T.	VALID_TS	<>	S.	VALID_TS	  OR
T.	VALID_STS	<>	S.	VALID_STS	  OR
T.	CITY	<>	S.	CITY	  OR
T.	MUNICIPALITY	<>	S.	MUNICIPALITY	  OR
T.	TOWN	<>	S.	TOWN	  OR
T.	VILLAGE	<>	S.	VILLAGE	  OR
T.	COUNTY	<>	S.	COUNTY	  OR
T.	DISTRICT	<>	S.	DISTRICT	  OR
T.	ZIP_CD	<>	S.	ZIP_CD	  OR
T.	POSTAL_CD	<>	S.	POSTAL_CD	  OR
T.	ZIP_EXTN	<>	S.	ZIP_EXTN	  OR
T.	ADDR_TYPE	<>	S.	ADDR_TYPE	  OR
T.	AREA	<>	S.	AREA	  OR
T.	CNTRY_CD	<>	S.	CNTRY_CD	  OR
T.	STATE_PRVNCE_TYPE	<>	S.	STATE_PRVNCE_TYPE	  OR
T.	OWNER_ID	<>	S.	OWNER_ID	  OR
T.	PARENT_ID	<>	S.	PARENT_ID	  OR
T.	DELTD_YN	<>	S.	DELTD_YN	  OR
T.	CRE_DT	<>	S.	CRE_DT	  OR
T.	CRE_USER	<>	S.	CRE_USER	  )

------------------------------------------------------------------------------------------------------------------------

SELECT * FROM DIM_CUST_CNTCT_SQL_IN1563

SELECT COUNT(*) FROM DIM_CUST_CNTCT_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT
IIF(CNTCT_ID IS NULL OR CNTCT_ID LIKE 'NULL' OR CNTCT_ID LIKE '?',101, cast(ltrim(rtrim(Cntct_id)) as int))Cntct_id,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101, cast(ltrim(rtrim(TENANT_ORG_ID)) as int))TENANT_ORG_ID,
IIF(SRC_CNTCT_ID IS NULL OR SRC_CNTCT_ID LIKE 'NULL' OR SRC_CNTCT_ID LIKE '?','N/A', cast(ltrim(rtrim(SRC_CNTCT_ID)) as VARCHAR))SRC_CNTCT_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101, cast(ltrim(rtrim(DATA_SRC_ID)) as int))DATA_SRC_ID,
IIF(ACCT_ID IS NULL OR ACCT_ID LIKE 'NULL' OR ACCT_ID LIKE '?',101, cast(ltrim(rtrim(ACCT_ID)) as bigint))ACCT_ID,
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ID)) as bigint))ADDR_ID ,
IIF(PHONE_ID IS NULL OR PHONE_ID LIKE 'NULL' OR PHONE_ID LIKE '?',101, cast(ltrim(rtrim(PHONE_ID)) as bigint))PHONE_ID,
IIF(EMAIL_ID IS NULL OR EMAIL_ID LIKE 'NULL' OR EMAIL_ID LIKE '?','N/A', cast(ltrim(rtrim(EMAIL_ID)) as VARCHAR))EMAIL_ID,
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID LIKE 'NULL' OR ADDR_ZONE_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ZONE_ID)) as bigint))ADDR_ZONE_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?','N/A', cast(ltrim(rtrim(DELTD_YN)) as CHAR))DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?','01/01/1900',cast(ltrim(rtrim(Cre_Dt))as Date)) Cre_Dt,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?' OR UPD_TS LIKE '%[A-Za-z]%','N/A', cast(FORMAT(CONVERT(DATE,(ltrim(rtrim(UPD_TS)))),'dd/MMMM/yyyy') as NVARCHAR))UPD_TS
FROM [BCMPWMT].[CUST_CNTCT]) S

SELECT TENANT_ORG_ID,COUNT(*) FROM DIM_CUST_CNTCT_SQL_IN1563
GROUP BY TENANT_ORG_ID

SELECT TENANT_ORG_ID,COUNT(*) FROM 
(SELECT
IIF(CNTCT_ID IS NULL OR CNTCT_ID LIKE 'NULL' OR CNTCT_ID LIKE '?',101, cast(ltrim(rtrim(Cntct_id)) as int))Cntct_id,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101, cast(ltrim(rtrim(TENANT_ORG_ID)) as int))TENANT_ORG_ID,
IIF(SRC_CNTCT_ID IS NULL OR SRC_CNTCT_ID LIKE 'NULL' OR SRC_CNTCT_ID LIKE '?','N/A', cast(ltrim(rtrim(SRC_CNTCT_ID)) as VARCHAR))SRC_CNTCT_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101, cast(ltrim(rtrim(DATA_SRC_ID)) as int))DATA_SRC_ID,
IIF(ACCT_ID IS NULL OR ACCT_ID LIKE 'NULL' OR ACCT_ID LIKE '?',101, cast(ltrim(rtrim(ACCT_ID)) as bigint))ACCT_ID,
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ID)) as bigint))ADDR_ID ,
IIF(PHONE_ID IS NULL OR PHONE_ID LIKE 'NULL' OR PHONE_ID LIKE '?',101, cast(ltrim(rtrim(PHONE_ID)) as bigint))PHONE_ID,
IIF(EMAIL_ID IS NULL OR EMAIL_ID LIKE 'NULL' OR EMAIL_ID LIKE '?','N/A', cast(ltrim(rtrim(EMAIL_ID)) as VARCHAR))EMAIL_ID,
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID LIKE 'NULL' OR ADDR_ZONE_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ZONE_ID)) as bigint))ADDR_ZONE_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?','N/A', cast(ltrim(rtrim(DELTD_YN)) as CHAR))DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?','01/01/1900',cast(ltrim(rtrim(Cre_Dt))as Date)) Cre_Dt,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?' OR UPD_TS LIKE '%[A-Za-z]%','N/A', cast(FORMAT(CONVERT(DATE,(ltrim(rtrim(UPD_TS)))),'dd/MMMM/yyyy') as NVARCHAR))UPD_TS
FROM [BCMPWMT].[CUST_CNTCT]) S
GROUP BY TENANT_ORG_ID

SELECT COUNT(*) FROM DIM_CUST_CNTCT_SQL_IN1563 T LEFT JOIN
(SELECT
IIF(CNTCT_ID IS NULL OR CNTCT_ID LIKE 'NULL' OR CNTCT_ID LIKE '?',101, cast(ltrim(rtrim(Cntct_id)) as int))Cntct_id,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101, cast(ltrim(rtrim(TENANT_ORG_ID)) as int))TENANT_ORG_ID,
IIF(SRC_CNTCT_ID IS NULL OR SRC_CNTCT_ID LIKE 'NULL' OR SRC_CNTCT_ID LIKE '?','N/A', cast(ltrim(rtrim(SRC_CNTCT_ID)) as VARCHAR))SRC_CNTCT_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101, cast(ltrim(rtrim(DATA_SRC_ID)) as int))DATA_SRC_ID,
IIF(ACCT_ID IS NULL OR ACCT_ID LIKE 'NULL' OR ACCT_ID LIKE '?',101, cast(ltrim(rtrim(ACCT_ID)) as bigint))ACCT_ID,
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ID)) as bigint))ADDR_ID ,
IIF(PHONE_ID IS NULL OR PHONE_ID LIKE 'NULL' OR PHONE_ID LIKE '?',101, cast(ltrim(rtrim(PHONE_ID)) as bigint))PHONE_ID,
IIF(EMAIL_ID IS NULL OR EMAIL_ID LIKE 'NULL' OR EMAIL_ID LIKE '?','N/A', cast(ltrim(rtrim(EMAIL_ID)) as VARCHAR))EMAIL_ID,
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID LIKE 'NULL' OR ADDR_ZONE_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ZONE_ID)) as bigint))ADDR_ZONE_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?','N/A', cast(ltrim(rtrim(DELTD_YN)) as CHAR))DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?','01/01/1900',cast(ltrim(rtrim(Cre_Dt))as Date)) Cre_Dt,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?' OR UPD_TS LIKE '%[A-Za-z]%','N/A', cast(FORMAT(CONVERT(DATE,(ltrim(rtrim(UPD_TS)))),'dd/MMMM/yyyy') as NVARCHAR))UPD_TS
FROM [BCMPWMT].[CUST_CNTCT]) S
ON T.CNTCT_ID = S.CNTCT_ID
WHERE S.CNTCT_ID IS NULL AND
(
T. 	TENANT_ORG_ID	   <>	S.  	TENANT_ORG_ID	OR
T. 	SRC_CNTCT_ID	   <>	S.  	SRC_CNTCT_ID	OR
T. 	DATA_SRC_ID	   <>	S.  	DATA_SRC_ID	OR
T. 	ACCT_ID	   <>	S.  	ACCT_ID	OR
T. 	ADDR_ID	   <>	S.  	ADDR_ID	OR
T. 	PHONE_ID	   <>	S.  	PHONE_ID	OR
T. 	EMAIL_ID	   <>	S.  	EMAIL_ID	OR
T. 	ADDR_ZONE_ID	   <>	S.  	ADDR_ZONE_ID	OR
T. 	DELTD_YN	   <>	S.  	DELTD_YN	OR
T. 	CRE_DT	   <>	S.  	CRE_DT	OR
T. 	UPD_TS	   <>	S.  	UPD_TS)

SELECT COUNT(*) FROM DIM_CUST_CNTCT_SQL_IN1563
GROUP BY CNTCT_ID
HAVING COUNT(*) > 1

SELECT CNTCT_ID,TENANT_ORG_ID,SRC_CNTCT_ID,DATA_SRC_ID,ACCT_ID
FROM DIM_CUST_CNTCT_SQL_IN1563
WHERE CNTCT_ID = 1693032907

SELECT CNTCT_ID,TENANT_ORG_ID,SRC_CNTCT_ID,DATA_SRC_ID,ACCT_ID
FROM (SELECT
IIF(CNTCT_ID IS NULL OR CNTCT_ID LIKE 'NULL' OR CNTCT_ID LIKE '?',101, cast(ltrim(rtrim(Cntct_id)) as int))Cntct_id,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID LIKE 'NULL' OR TENANT_ORG_ID LIKE '?',101, cast(ltrim(rtrim(TENANT_ORG_ID)) as int))TENANT_ORG_ID,
IIF(SRC_CNTCT_ID IS NULL OR SRC_CNTCT_ID LIKE 'NULL' OR SRC_CNTCT_ID LIKE '?','N/A', cast(ltrim(rtrim(SRC_CNTCT_ID)) as VARCHAR))SRC_CNTCT_ID,
IIF(DATA_SRC_ID IS NULL OR DATA_SRC_ID LIKE 'NULL' OR DATA_SRC_ID LIKE '?',101, cast(ltrim(rtrim(DATA_SRC_ID)) as int))DATA_SRC_ID,
IIF(ACCT_ID IS NULL OR ACCT_ID LIKE 'NULL' OR ACCT_ID LIKE '?',101, cast(ltrim(rtrim(ACCT_ID)) as bigint))ACCT_ID,
IIF(ADDR_ID IS NULL OR ADDR_ID LIKE 'NULL' OR ADDR_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ID)) as bigint))ADDR_ID ,
IIF(PHONE_ID IS NULL OR PHONE_ID LIKE 'NULL' OR PHONE_ID LIKE '?',101, cast(ltrim(rtrim(PHONE_ID)) as bigint))PHONE_ID,
IIF(EMAIL_ID IS NULL OR EMAIL_ID LIKE 'NULL' OR EMAIL_ID LIKE '?','N/A', cast(ltrim(rtrim(EMAIL_ID)) as VARCHAR))EMAIL_ID,
IIF(ADDR_ZONE_ID IS NULL OR ADDR_ZONE_ID LIKE 'NULL' OR ADDR_ZONE_ID LIKE '?',101, cast(ltrim(rtrim(ADDR_ZONE_ID)) as bigint))ADDR_ZONE_ID,
IIF(DELTD_YN IS NULL OR DELTD_YN LIKE 'NULL' OR DELTD_YN LIKE '?','N/A', cast(ltrim(rtrim(DELTD_YN)) as CHAR))DELTD_YN,
IIF(CRE_DT IS NULL OR CRE_DT LIKE 'NULL' OR CRE_DT LIKE '?','01/01/1900',cast(ltrim(rtrim(Cre_Dt))as Date)) Cre_Dt,
IIF(UPD_TS IS NULL OR UPD_TS LIKE 'NULL' OR UPD_TS LIKE '?' OR UPD_TS LIKE '%[A-Za-z]%','N/A', cast(FORMAT(CONVERT(DATE,(ltrim(rtrim(UPD_TS)))),'dd/MMMM/yyyy') as NVARCHAR))UPD_TS
FROM [BCMPWMT].[CUST_CNTCT]) S
WHERE CNTCT_ID = 1693032907

-------------------------------------------------------------------------------------------------------------------------------------
----------------------------FACT-----------------------------

SELECT * FROM FACT_ORDER_LINE_CHRG_SQL_IN1563

SELECT COUNT(*) FROM FACT_ORDER_LINE_CHRG_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT
IIF(SALES_ORDER_NUM is null or SALES_ORDER_NUM =  'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM))AS BIGINT)) as SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM is null or SALES_ORDER_LINE_NUM =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) as SALES_ORDER_LINE_NUM,
IIF(a.TENANT_ORG_ID is null or a.TENANT_ORG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.TENANT_ORG_ID)))) as TENANT_ORG_ID,
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) as CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID is null or CHRG_CATEG_MAP_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(CHRG_CATEG_MAP_ID)))) as CHRG_CATEG_MAP_ID,
IIF(CHARGE_NM is null or CHARGE_NM =  'NULL','N/A',LTRIM(RTRIM(CHARGE_NM))) as CHARGE_NM,
IIF(CHARGE_AMT is null or CHARGE_AMT =  'NULL',0,CONVERT(DECIMAL(19,6),LTRIM(RTRIM(CHARGE_AMT)))) as CHARGE_AMT,
IIF(CHRG_CRE_DT is null or CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(CHRG_CRE_DT)))) as CHRG_CRE_DT,
IIF(CHRG_QTY is null or CHRG_QTY =  'NULL',0,CONVERT(INT,LTRIM(RTRIM(CHRG_QTY)))) as CHRG_QTY,
d.Day_key as CHRG_CRE_DT_KEY,
c.Charge_categ_key as Charge_categ_key 
from BCMPWMT.ORDER_LINE_CHRG a 
left join Dim_Day_SQL_IN1563 d on IIF(a.CHRG_CRE_DT is null or a.CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(a.CHRG_CRE_DT))))=d.Date_id
left join DIM_CHARGE_CATEG_SQL_IN1563 c on 
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) = c.CHARGE_CATEG_ID) S

SELECT CHRG_QTY,COUNT(*) FROM FACT_ORDER_LINE_CHRG_SQL_IN1563
GROUP BY CHRG_QTY

SELECT CHRG_QTY,COUNT(*) FROM 
(SELECT
IIF(SALES_ORDER_NUM is null or SALES_ORDER_NUM =  'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM))AS BIGINT)) as SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM is null or SALES_ORDER_LINE_NUM =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) as SALES_ORDER_LINE_NUM,
IIF(a.TENANT_ORG_ID is null or a.TENANT_ORG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.TENANT_ORG_ID)))) as TENANT_ORG_ID,
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) as CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID is null or CHRG_CATEG_MAP_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(CHRG_CATEG_MAP_ID)))) as CHRG_CATEG_MAP_ID,
IIF(CHARGE_NM is null or CHARGE_NM =  'NULL','N/A',LTRIM(RTRIM(CHARGE_NM))) as CHARGE_NM,
IIF(CHARGE_AMT is null or CHARGE_AMT =  'NULL',0,CONVERT(DECIMAL(19,6),LTRIM(RTRIM(CHARGE_AMT)))) as CHARGE_AMT,
IIF(CHRG_CRE_DT is null or CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(CHRG_CRE_DT)))) as CHRG_CRE_DT,
IIF(CHRG_QTY is null or CHRG_QTY =  'NULL',0,CONVERT(INT,LTRIM(RTRIM(CHRG_QTY)))) as CHRG_QTY,
d.Day_key as CHRG_CRE_DT_KEY,
c.Charge_categ_key as Charge_categ_key 
from BCMPWMT.ORDER_LINE_CHRG a 
left join Dim_Day_SQL_IN1563 d on IIF(a.CHRG_CRE_DT is null or a.CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(a.CHRG_CRE_DT))))=d.Date_id
left join DIM_CHARGE_CATEG_SQL_IN1563 c on 
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) = c.CHARGE_CATEG_ID) S
GROUP BY CHRG_QTY

SELECT COUNT(T.CHARGE_CATEG_KEY) CHARGE_CATEG_KEY,COUNT(T.CHRG_CRE_DT_KEY)CHRG_CRE_DT_KEY 
FROM FACT_ORDER_LINE_CHRG_SQL_IN1563 T LEFT JOIN 
DIM_CHARGE_CATEG_SQL_IN1563 S ON T.CHARGE_CATEG_KEY = S.CHARGE_CATEG_KEY
LEFT JOIN Dim_Day_SQL_IN1563 D ON D.Day_Key = T.CHRG_CRE_DT_KEY
WHERE S.CHARGE_CATEG_ID IS NULL AND D.Day_id IS NULL

SELECT * FROM DIM_CHARGE_CATEG_SQL_IN1563
SELECT * FROM FACT_ORDER_LINE_CHRG_SQL_IN1563
SELECT * FROM Dim_Day_SQL_IN1563


SELECT SUM(CHRG_QTY) CHRG_QTY, SUM(CHARGE_AMT) CHARGE_AMT
from
FACT_ORDER_LINE_CHRG_SQL_IN1563

SELECT SUM(CHRG_QTY) CHRG_QTY, SUM(CHARGE_AMT) CHARGE_AMT
from (SELECT
IIF(SALES_ORDER_NUM is null or SALES_ORDER_NUM =  'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM))AS BIGINT)) as SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM is null or SALES_ORDER_LINE_NUM =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) as SALES_ORDER_LINE_NUM,
IIF(a.TENANT_ORG_ID is null or a.TENANT_ORG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.TENANT_ORG_ID)))) as TENANT_ORG_ID,
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) as CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID is null or CHRG_CATEG_MAP_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(CHRG_CATEG_MAP_ID)))) as CHRG_CATEG_MAP_ID,
IIF(CHARGE_NM is null or CHARGE_NM =  'NULL','N/A',LTRIM(RTRIM(CHARGE_NM))) as CHARGE_NM,
IIF(CHARGE_AMT is null or CHARGE_AMT =  'NULL',0,CONVERT(DECIMAL(19,6),LTRIM(RTRIM(CHARGE_AMT)))) as CHARGE_AMT,
IIF(CHRG_CRE_DT is null or CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(CHRG_CRE_DT)))) as CHRG_CRE_DT,
IIF(CHRG_QTY is null or CHRG_QTY =  'NULL',0,CONVERT(INT,LTRIM(RTRIM(CHRG_QTY)))) as CHRG_QTY,
d.Day_key as CHRG_CRE_DT_KEY,
c.Charge_categ_key as Charge_categ_key 
from BCMPWMT.ORDER_LINE_CHRG a 
left join Dim_Day_SQL_IN1563 d on IIF(a.CHRG_CRE_DT is null or a.CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(a.CHRG_CRE_DT))))=d.Date_id
left join DIM_CHARGE_CATEG_SQL_IN1563 c on 
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) = c.CHARGE_CATEG_ID) S

SELECT CHARGE_NM, SUM(CHRG_QTY) CHRG_QTY, SUM(CHARGE_AMT) CHARGE_AMT
from
FACT_ORDER_LINE_CHRG_SQL_IN1563
group by CHARGE_NM
order by CHARGE_NM

SELECT CHARGE_NM, SUM(CHRG_QTY) CHRG_QTY, SUM(CHARGE_AMT) CHARGE_AMT
from
(SELECT
IIF(SALES_ORDER_NUM is null or SALES_ORDER_NUM =  'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM))AS BIGINT)) as SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM is null or SALES_ORDER_LINE_NUM =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) as SALES_ORDER_LINE_NUM,
IIF(a.TENANT_ORG_ID is null or a.TENANT_ORG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.TENANT_ORG_ID)))) as TENANT_ORG_ID,
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) as CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID is null or CHRG_CATEG_MAP_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(CHRG_CATEG_MAP_ID)))) as CHRG_CATEG_MAP_ID,
IIF(CHARGE_NM is null or CHARGE_NM =  'NULL','N/A',LTRIM(RTRIM(CHARGE_NM))) as CHARGE_NM,
IIF(CHARGE_AMT is null or CHARGE_AMT =  'NULL',0,CONVERT(DECIMAL(19,6),LTRIM(RTRIM(CHARGE_AMT)))) as CHARGE_AMT,
IIF(CHRG_CRE_DT is null or CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(CHRG_CRE_DT)))) as CHRG_CRE_DT,
IIF(CHRG_QTY is null or CHRG_QTY =  'NULL',0,CONVERT(INT,LTRIM(RTRIM(CHRG_QTY)))) as CHRG_QTY,
d.Day_key as CHRG_CRE_DT_KEY,
c.Charge_categ_key as Charge_categ_key 
from BCMPWMT.ORDER_LINE_CHRG a 
left join Dim_Day_SQL_IN1563 d on IIF(a.CHRG_CRE_DT is null or a.CHRG_CRE_DT =  'NULL','01-01-1900',CONVERT(DATETIME,LTRIM(RTRIM(a.CHRG_CRE_DT))))=d.Date_id
left join DIM_CHARGE_CATEG_SQL_IN1563 c on 
IIF(a.CHARGE_CATEG_ID is null or a.CHARGE_CATEG_ID =  'NULL',101,CONVERT(INT,LTRIM(RTRIM(a.CHARGE_CATEG_ID)))) = c.CHARGE_CATEG_ID) S
group by CHARGE_NM
order by CHARGE_NM

-------------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM Fact_sales_order_adj_SQL_IN1563

SELECT COUNT(*) FROM Fact_sales_order_adj_SQL_IN1563

SELECT COUNT(*) FROM
(SELECT
IIF(ADJ_ID IS NULL OR ADJ_ID = 'NULL','N/A',CAST(LTRIM(RTRIM(ADJ_ID)) AS VARCHAR)) ADJ_ID,
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM)) AS BIGINT)) SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_LINE_NUM)) AS INT)) SALES_ORDER_LINE_NUM,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) AS INT)) TENANT_ORG_ID ,
IIF(CHARGE_CATEG_ID IS NULL OR CHARGE_CATEG_ID = 'NULL',101,CAST(LTRIM(RTRIM(CHARGE_CATEG_ID)) AS INT)) CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID IS NULL OR CHRG_CATEG_MAP_ID = 'NULL' OR CHRG_CATEG_MAP_ID like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(CHRG_CATEG_MAP_ID)) AS INT)) CHRG_CATEG_MAP_ID,
IIF(CHRG_NM IS NULL OR CHRG_NM = 'NULL','N/A',CAST(LTRIM(RTRIM(CHRG_NM)) AS VARCHAR)) CHRG_NM,
IIF(RSN_CD IS NULL OR RSN_CD = 'NULL' OR RSN_CD like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RSN_CD)) AS INT)) RSN_CD ,
IIF(QTY IS NULL OR QTY = 'NULL' OR QTY like '%[a-zA-Z]%',0,CAST(LTRIM(RTRIM(QTY)) AS INT)) QTY,
IIF(ADJUSMENT_AMT is null OR ADJUSMENT_AMT =  'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(ADJUSMENT_AMT)))) as ADJUSMENT_AMT,
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS)))) ADJ_RPT_TS,
IIF(RTN_IND IS NULL OR RTN_IND = 'NULL' OR RTN_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RTN_IND)) AS INT)) RTN_IND,
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS)))) RTN_TS,
IIF(XCHNG_IND IS NULL OR XCHNG_IND = 'NULL' OR XCHNG_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(XCHNG_IND)) AS INT)) XCHNG_IND,
IIF(d.Day_Key IS NULL,-1,d.Day_Key)  AS  ADJ_RPT_TS_KEY,
IIF(d1.Day_Key IS NULL,-1,d1.Day_Key) AS RTN_TS_KEY,
IIF(d2.Day_Key IS NULL,-1,d2.Day_Key)  AS RFND_TS_KEY,
IIF(RFND_TS IS NULL OR RFND_TS LIKE 'NULL','01/01/1900 00:00:00',CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS)))) RFND_TS 
FROM [BCMPWMT].[SALES_ORDER_ADJ] A LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D
ON IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ADJ_RPT_TS)))) = D.DATE_ID AND
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS))))) = D.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D1 ON IIF(RTN_TS IS NULL OR RTN_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RTN_TS)))) = D1.DATE_ID AND
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS))))) = D1.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D2 ON IIF(RFND_TS IS NULL OR RFND_TS = 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RFND_TS)))) = D2.DATE_ID AND
IIF(RFND_TS IS NULL OR RFND_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS))))) = D2.HOUR_ID) SRC

SELECT CHARGE_CATEG_ID,COUNT(*) FROM Fact_sales_order_adj_SQL_IN1563 GROUP BY CHARGE_CATEG_ID

SELECT CHARGE_CATEG_ID,COUNT(*) FROM 
(SELECT
IIF(ADJ_ID IS NULL OR ADJ_ID = 'NULL','N/A',CAST(LTRIM(RTRIM(ADJ_ID)) AS VARCHAR)) ADJ_ID,
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM)) AS BIGINT)) SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_LINE_NUM)) AS INT)) SALES_ORDER_LINE_NUM,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) AS INT)) TENANT_ORG_ID ,
IIF(CHARGE_CATEG_ID IS NULL OR CHARGE_CATEG_ID = 'NULL',101,CAST(LTRIM(RTRIM(CHARGE_CATEG_ID)) AS INT)) CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID IS NULL OR CHRG_CATEG_MAP_ID = 'NULL' OR CHRG_CATEG_MAP_ID like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(CHRG_CATEG_MAP_ID)) AS INT)) CHRG_CATEG_MAP_ID,
IIF(CHRG_NM IS NULL OR CHRG_NM = 'NULL','N/A',CAST(LTRIM(RTRIM(CHRG_NM)) AS VARCHAR)) CHRG_NM,
IIF(RSN_CD IS NULL OR RSN_CD = 'NULL' OR RSN_CD like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RSN_CD)) AS INT)) RSN_CD ,
IIF(QTY IS NULL OR QTY = 'NULL' OR QTY like '%[a-zA-Z]%',0,CAST(LTRIM(RTRIM(QTY)) AS INT)) QTY,
IIF(ADJUSMENT_AMT is null OR ADJUSMENT_AMT =  'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(ADJUSMENT_AMT)))) as ADJUSMENT_AMT,
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS)))) ADJ_RPT_TS,
IIF(RTN_IND IS NULL OR RTN_IND = 'NULL' OR RTN_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RTN_IND)) AS INT)) RTN_IND,
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS)))) RTN_TS,
IIF(XCHNG_IND IS NULL OR XCHNG_IND = 'NULL' OR XCHNG_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(XCHNG_IND)) AS INT)) XCHNG_IND,
IIF(d.Day_Key IS NULL,-1,d.Day_Key)  AS  ADJ_RPT_TS_KEY,
IIF(d1.Day_Key IS NULL,-1,d1.Day_Key) AS RTN_TS_KEY,
IIF(d2.Day_Key IS NULL,-1,d2.Day_Key)  AS RFND_TS_KEY,
IIF(RFND_TS IS NULL OR RFND_TS LIKE 'NULL','01/01/1900 00:00:00',CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS)))) RFND_TS 
FROM [BCMPWMT].[SALES_ORDER_ADJ] A LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D
ON IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ADJ_RPT_TS)))) = D.DATE_ID AND
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS))))) = D.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D1 ON IIF(RTN_TS IS NULL OR RTN_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RTN_TS)))) = D1.DATE_ID AND
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS))))) = D1.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D2 ON IIF(RFND_TS IS NULL OR RFND_TS = 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RFND_TS)))) = D2.DATE_ID AND
IIF(RFND_TS IS NULL OR RFND_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS))))) = D2.HOUR_ID) SRC
GROUP BY CHARGE_CATEG_ID

SELECT COUNT(ADJ_RPT_TS_KEY) ADJ_RPT_TS_KEY,
COUNT(RTN_TS_KEY) RTN_TS_KEY,
COUNT(RFND_TS_KEY) RFND_TS_KEY,
COUNT(T.CHARGE_CATEG_KEY) CHARGE_CATEG_KEY,
COUNT(RSN_CD_KEY) RSN_CD_KEY
FROM Fact_sales_order_adj_SQL_IN1563 T LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D1 ON T.ADJ_RPT_TS_KEY = D1.Day_hour_key
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563  D2 ON T.RTN_TS_KEY = D2.Day_hour_key 
LEFT JOIN  DIM_DAY_HOUR_SQL_IN1563 D3 ON T.RFND_TS_KEY = D3.Day_hour_key
LEFT JOIN DIM_CHARGE_CATEG_SQL_IN1563 D4 ON T.CHARGE_CATEG_KEY = D4.CHARGE_CATEG_KEY
LEFT JOIN DIM_RSN_LKP_SQL_IN1563  D5 ON T.RSN_CD_KEY = D5.RSN_KEY
WHERE D1.DATE_ID IS NULL AND 
D2.DATE_ID IS NULL AND
D3.DATE_ID IS NULL AND 
D4.CHARGE_CATEG_ID IS NULL AND
D5.RSN_CD IS NULL

SELECT SUM(QTY)QTY,SUM(ADJUSMENT_AMT)ADJUSMENT_AMT
FROM Fact_sales_order_adj_SQL_IN1563

SELECT SUM(QTY),SUM(ADJUSMENT_AMT)
FROM (SELECT
IIF(ADJ_ID IS NULL OR ADJ_ID = 'NULL','N/A',CAST(LTRIM(RTRIM(ADJ_ID)) AS VARCHAR)) ADJ_ID,
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM)) AS BIGINT)) SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_LINE_NUM)) AS INT)) SALES_ORDER_LINE_NUM,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) AS INT)) TENANT_ORG_ID ,
IIF(CHARGE_CATEG_ID IS NULL OR CHARGE_CATEG_ID = 'NULL',101,CAST(LTRIM(RTRIM(CHARGE_CATEG_ID)) AS INT)) CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID IS NULL OR CHRG_CATEG_MAP_ID = 'NULL' OR CHRG_CATEG_MAP_ID like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(CHRG_CATEG_MAP_ID)) AS INT)) CHRG_CATEG_MAP_ID,
IIF(CHRG_NM IS NULL OR CHRG_NM = 'NULL','N/A',CAST(LTRIM(RTRIM(CHRG_NM)) AS VARCHAR)) CHRG_NM,
IIF(RSN_CD IS NULL OR RSN_CD = 'NULL' OR RSN_CD like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RSN_CD)) AS INT)) RSN_CD ,
IIF(QTY IS NULL OR QTY = 'NULL' OR QTY like '%[a-zA-Z]%',0,CAST(LTRIM(RTRIM(QTY)) AS INT)) QTY,
IIF(ADJUSMENT_AMT is null OR ADJUSMENT_AMT =  'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(ADJUSMENT_AMT)))) as ADJUSMENT_AMT,
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS)))) ADJ_RPT_TS,
IIF(RTN_IND IS NULL OR RTN_IND = 'NULL' OR RTN_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RTN_IND)) AS INT)) RTN_IND,
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS)))) RTN_TS,
IIF(XCHNG_IND IS NULL OR XCHNG_IND = 'NULL' OR XCHNG_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(XCHNG_IND)) AS INT)) XCHNG_IND,
IIF(d.Day_Key IS NULL,-1,d.Day_Key)  AS  ADJ_RPT_TS_KEY,
IIF(d1.Day_Key IS NULL,-1,d1.Day_Key) AS RTN_TS_KEY,
IIF(d2.Day_Key IS NULL,-1,d2.Day_Key)  AS RFND_TS_KEY,
IIF(RFND_TS IS NULL OR RFND_TS LIKE 'NULL','01/01/1900 00:00:00',CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS)))) RFND_TS 
FROM [BCMPWMT].[SALES_ORDER_ADJ] A LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D
ON IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ADJ_RPT_TS)))) = D.DATE_ID AND
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS))))) = D.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D1 ON IIF(RTN_TS IS NULL OR RTN_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RTN_TS)))) = D1.DATE_ID AND
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS))))) = D1.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D2 ON IIF(RFND_TS IS NULL OR RFND_TS = 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RFND_TS)))) = D2.DATE_ID AND
IIF(RFND_TS IS NULL OR RFND_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS))))) = D2.HOUR_ID) SRC

SELECT CHARGE_CATEG_ID,SUM(QTY) QTY ,SUM(ADJUSMENT_AMT) ADJUSMENT_AMT
FROM Fact_sales_order_adj_SQL_IN1563
GROUP BY  CHARGE_CATEG_ID
ORDER BY CHARGE_CATEG_ID

SELECT CHARGE_CATEG_ID,SUM(QTY),SUM(ADJUSMENT_AMT)
FROM (SELECT
IIF(ADJ_ID IS NULL OR ADJ_ID = 'NULL','N/A',CAST(LTRIM(RTRIM(ADJ_ID)) AS VARCHAR)) ADJ_ID,
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_NUM)) AS BIGINT)) SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM = 'NULL',101,CAST(LTRIM(RTRIM(SALES_ORDER_LINE_NUM)) AS INT)) SALES_ORDER_LINE_NUM,
IIF(TENANT_ORG_ID IS NULL OR TENANT_ORG_ID = 'NULL',101,CAST(LTRIM(RTRIM(TENANT_ORG_ID)) AS INT)) TENANT_ORG_ID ,
IIF(CHARGE_CATEG_ID IS NULL OR CHARGE_CATEG_ID = 'NULL',101,CAST(LTRIM(RTRIM(CHARGE_CATEG_ID)) AS INT)) CHARGE_CATEG_ID,
IIF(CHRG_CATEG_MAP_ID IS NULL OR CHRG_CATEG_MAP_ID = 'NULL' OR CHRG_CATEG_MAP_ID like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(CHRG_CATEG_MAP_ID)) AS INT)) CHRG_CATEG_MAP_ID,
IIF(CHRG_NM IS NULL OR CHRG_NM = 'NULL','N/A',CAST(LTRIM(RTRIM(CHRG_NM)) AS VARCHAR)) CHRG_NM,
IIF(RSN_CD IS NULL OR RSN_CD = 'NULL' OR RSN_CD like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RSN_CD)) AS INT)) RSN_CD ,
IIF(QTY IS NULL OR QTY = 'NULL' OR QTY like '%[a-zA-Z]%',0,CAST(LTRIM(RTRIM(QTY)) AS INT)) QTY,
IIF(ADJUSMENT_AMT is null OR ADJUSMENT_AMT =  'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(ADJUSMENT_AMT)))) as ADJUSMENT_AMT,
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS)))) ADJ_RPT_TS,
IIF(RTN_IND IS NULL OR RTN_IND = 'NULL' OR RTN_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(RTN_IND)) AS INT)) RTN_IND,
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS)))) RTN_TS,
IIF(XCHNG_IND IS NULL OR XCHNG_IND = 'NULL' OR XCHNG_IND like '%[a-zA-Z]%',101,CAST(LTRIM(RTRIM(XCHNG_IND)) AS INT)) XCHNG_IND,
IIF(d.Day_Key IS NULL,-1,d.Day_Key)  AS  ADJ_RPT_TS_KEY,
IIF(d1.Day_Key IS NULL,-1,d1.Day_Key) AS RTN_TS_KEY,
IIF(d2.Day_Key IS NULL,-1,d2.Day_Key)  AS RFND_TS_KEY,
IIF(RFND_TS IS NULL OR RFND_TS LIKE 'NULL','01/01/1900 00:00:00',CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS)))) RFND_TS 
FROM [BCMPWMT].[SALES_ORDER_ADJ] A LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D
ON IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ADJ_RPT_TS)))) = D.DATE_ID AND
IIF(ADJ_RPT_TS IS NULL OR ADJ_RPT_TS LIKE 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(ADJ_RPT_TS))))) = D.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D1 ON IIF(RTN_TS IS NULL OR RTN_TS LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RTN_TS)))) = D1.DATE_ID AND
IIF(RTN_TS IS NULL OR RTN_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RTN_TS))))) = D1.HOUR_ID LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 D2 ON IIF(RFND_TS IS NULL OR RFND_TS = 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(RFND_TS)))) = D2.DATE_ID AND
IIF(RFND_TS IS NULL OR RFND_TS = 'NULL',-1,DATEPART(HOUR,CONVERT(DATETIME,LTRIM(RTRIM(RFND_TS))))) = D2.HOUR_ID) SRC
GROUP BY  CHARGE_CATEG_ID
ORDER BY CHARGE_CATEG_ID



-------------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM Fact_sales_order_SQL_IN1563

SELECT COUNT(*) FROM Fact_sales_order_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(ORDER_REL_TS IS NULL OR ORDER_REL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_REL_TS)))) ORDER_REL_TS,
IIF(ORDER_REL_DT IS NULL OR ORDER_REL_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_REL_DT)))) ORDER_REL_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(TOT_AMT IS NULL OR TOT_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TOT_AMT)))) TOT_AMT,
IIF(TAX_AMT IS NULL OR TAX_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TAX_AMT)))) TAX_AMT,
IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) CURR_STS_ID,
IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) BILL_TO_ADDR_ID,
IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) BILL_TO_CUST_ID,
IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) CUST_CNTCT_ID,
IIF(GUEST_ORDER_IND IS NULL OR GUEST_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GUEST_ORDER_IND)))) GUEST_ORDER_IND,
IIF(CORP_ORDER_IND IS NULL OR CORP_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CORP_ORDER_IND)))) CORP_ORDER_IND,
IIF(DEVICE_TYPE IS NULL OR DEVICE_TYPE LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEVICE_TYPE)))) DEVICE_TYPE,
IIF(IP_ADDR IS NULL OR IP_ADDR LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(IP_ADDR)))) IP_ADDR,
IIF(FRAUD_CHECK_REQD_IND IS NULL OR FRAUD_CHECK_REQD_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(FRAUD_CHECK_REQD_IND)))) FRAUD_CHECK_REQD_IND,
IIF(ORIG_SALES_ORDER_NUM IS NULL OR ORIG_SALES_ORDER_NUM LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ORIG_SALES_ORDER_NUM)))) ORIG_SALES_ORDER_NUM,
IIF(HOLD_FLAG IS NULL OR HOLD_FLAG LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(HOLD_FLAG)))) HOLD_FLAG,
IIF(XCHNG_TYPE_ID IS NULL OR XCHNG_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(XCHNG_TYPE_ID)))) XCHNG_TYPE_ID,
IIF(ORDER_TYPE_ID IS NULL OR ORDER_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORDER_TYPE_ID)))) ORDER_TYPE_ID,
IIF(WM_STORE_ORG_ID IS NULL OR WM_STORE_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(WM_STORE_ORG_ID)))) WM_STORE_ORG_ID,
-1 AS ORDER_REL_TS_KEY,
-1 AS ORDER_REL_DT_KEY,
-1 AS ORDER_PLACED_TS_KEY,
-1 AS ORDER_PLACED_DT_KEY,
ISNULL(B.STS_ID,-1) CURR_STS_ID_KEY,
ISNULL(C.ADDR_ID, -1) BILL_TO_ADDR_ID_KEY,
ISNULL(D.ADDR_ID,-1) BILL_TO_CUST_ID_KEY,
ISNULL(E.CNTCT_ID,-1) CUST_CNTCT_ID_KEY
FROM [BCMPWMT].[SALES_ORDER] A
LEFT JOIN [IN1563].[DIM_STS_LKP_SQL_IN1563]	B ON IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) = CONVERT(INT,B.STS_ID)
LEFT JOIN [IN1563].[dim_cust_address_SQL_IN1563] C ON IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) = CONVERT(VARCHAR,C.ADDR_ID)
LEFT JOIN [IN1563].[dim_cust_addr1_SQL_IN1563] D ON IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) = CONVERT(VARCHAR,D.ADDR_ID)
LEFT JOIN [IN1563].[DIM_CUST_CNTCT_SQL_IN1563] E ON IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) = CONVERT(VARCHAR,E.CNTCT_ID)) S

SELECT TENANT_ORG_ID, COUNT(*) FROM Fact_sales_order_SQL_IN1563 GROUP BY TENANT_ORG_ID

SELECT TENANT_ORG_ID, COUNT(*) FROM 
(SELECT
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(ORDER_REL_TS IS NULL OR ORDER_REL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_REL_TS)))) ORDER_REL_TS,
IIF(ORDER_REL_DT IS NULL OR ORDER_REL_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_REL_DT)))) ORDER_REL_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(TOT_AMT IS NULL OR TOT_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TOT_AMT)))) TOT_AMT,
IIF(TAX_AMT IS NULL OR TAX_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TAX_AMT)))) TAX_AMT,
IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) CURR_STS_ID,
IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) BILL_TO_ADDR_ID,
IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) BILL_TO_CUST_ID,
IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) CUST_CNTCT_ID,
IIF(GUEST_ORDER_IND IS NULL OR GUEST_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GUEST_ORDER_IND)))) GUEST_ORDER_IND,
IIF(CORP_ORDER_IND IS NULL OR CORP_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CORP_ORDER_IND)))) CORP_ORDER_IND,
IIF(DEVICE_TYPE IS NULL OR DEVICE_TYPE LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEVICE_TYPE)))) DEVICE_TYPE,
IIF(IP_ADDR IS NULL OR IP_ADDR LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(IP_ADDR)))) IP_ADDR,
IIF(FRAUD_CHECK_REQD_IND IS NULL OR FRAUD_CHECK_REQD_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(FRAUD_CHECK_REQD_IND)))) FRAUD_CHECK_REQD_IND,
IIF(ORIG_SALES_ORDER_NUM IS NULL OR ORIG_SALES_ORDER_NUM LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ORIG_SALES_ORDER_NUM)))) ORIG_SALES_ORDER_NUM,
IIF(HOLD_FLAG IS NULL OR HOLD_FLAG LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(HOLD_FLAG)))) HOLD_FLAG,
IIF(XCHNG_TYPE_ID IS NULL OR XCHNG_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(XCHNG_TYPE_ID)))) XCHNG_TYPE_ID,
IIF(ORDER_TYPE_ID IS NULL OR ORDER_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORDER_TYPE_ID)))) ORDER_TYPE_ID,
IIF(WM_STORE_ORG_ID IS NULL OR WM_STORE_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(WM_STORE_ORG_ID)))) WM_STORE_ORG_ID,
-1 AS ORDER_REL_TS_KEY,
-1 AS ORDER_REL_DT_KEY,
-1 AS ORDER_PLACED_TS_KEY,
-1 AS ORDER_PLACED_DT_KEY,
ISNULL(B.STS_ID,-1) CURR_STS_ID_KEY,
ISNULL(C.ADDR_ID, -1) BILL_TO_ADDR_ID_KEY,
ISNULL(D.ADDR_ID,-1) BILL_TO_CUST_ID_KEY,
ISNULL(E.CNTCT_ID,-1) CUST_CNTCT_ID_KEY
FROM [BCMPWMT].[SALES_ORDER] A
LEFT JOIN [IN1563].[DIM_STS_LKP_SQL_IN1563]	B ON IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) = CONVERT(INT,B.STS_ID)
LEFT JOIN [IN1563].[dim_cust_address_SQL_IN1563] C ON IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) = CONVERT(VARCHAR,C.ADDR_ID)
LEFT JOIN [IN1563].[dim_cust_addr1_SQL_IN1563] D ON IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) = CONVERT(VARCHAR,D.ADDR_ID)
LEFT JOIN [IN1563].[DIM_CUST_CNTCT_SQL_IN1563] E ON IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) = CONVERT(VARCHAR,E.CNTCT_ID)) S
GROUP BY TENANT_ORG_ID

SELECT SUM(TOT_AMT) TOT_AMT,SUM(TAX_AMT) TAX_AMT
FROM Fact_sales_order_SQL_IN1563

SELECT SUM(TOT_AMT) TOT_AMT,SUM(TAX_AMT) TAX_AMT
FROM (SELECT
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(ORDER_REL_TS IS NULL OR ORDER_REL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_REL_TS)))) ORDER_REL_TS,
IIF(ORDER_REL_DT IS NULL OR ORDER_REL_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_REL_DT)))) ORDER_REL_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(TOT_AMT IS NULL OR TOT_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TOT_AMT)))) TOT_AMT,
IIF(TAX_AMT IS NULL OR TAX_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TAX_AMT)))) TAX_AMT,
IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) CURR_STS_ID,
IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) BILL_TO_ADDR_ID,
IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) BILL_TO_CUST_ID,
IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) CUST_CNTCT_ID,
IIF(GUEST_ORDER_IND IS NULL OR GUEST_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GUEST_ORDER_IND)))) GUEST_ORDER_IND,
IIF(CORP_ORDER_IND IS NULL OR CORP_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CORP_ORDER_IND)))) CORP_ORDER_IND,
IIF(DEVICE_TYPE IS NULL OR DEVICE_TYPE LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEVICE_TYPE)))) DEVICE_TYPE,
IIF(IP_ADDR IS NULL OR IP_ADDR LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(IP_ADDR)))) IP_ADDR,
IIF(FRAUD_CHECK_REQD_IND IS NULL OR FRAUD_CHECK_REQD_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(FRAUD_CHECK_REQD_IND)))) FRAUD_CHECK_REQD_IND,
IIF(ORIG_SALES_ORDER_NUM IS NULL OR ORIG_SALES_ORDER_NUM LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ORIG_SALES_ORDER_NUM)))) ORIG_SALES_ORDER_NUM,
IIF(HOLD_FLAG IS NULL OR HOLD_FLAG LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(HOLD_FLAG)))) HOLD_FLAG,
IIF(XCHNG_TYPE_ID IS NULL OR XCHNG_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(XCHNG_TYPE_ID)))) XCHNG_TYPE_ID,
IIF(ORDER_TYPE_ID IS NULL OR ORDER_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORDER_TYPE_ID)))) ORDER_TYPE_ID,
IIF(WM_STORE_ORG_ID IS NULL OR WM_STORE_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(WM_STORE_ORG_ID)))) WM_STORE_ORG_ID,
-1 AS ORDER_REL_TS_KEY,
-1 AS ORDER_REL_DT_KEY,
-1 AS ORDER_PLACED_TS_KEY,
-1 AS ORDER_PLACED_DT_KEY,
ISNULL(B.STS_ID,-1) CURR_STS_ID_KEY,
ISNULL(C.ADDR_ID, -1) BILL_TO_ADDR_ID_KEY,
ISNULL(D.ADDR_ID,-1) BILL_TO_CUST_ID_KEY,
ISNULL(E.CNTCT_ID,-1) CUST_CNTCT_ID_KEY
FROM [BCMPWMT].[SALES_ORDER] A
LEFT JOIN [IN1563].[DIM_STS_LKP_SQL_IN1563]	B ON IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) = CONVERT(INT,B.STS_ID)
LEFT JOIN [IN1563].[dim_cust_address_SQL_IN1563] C ON IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) = CONVERT(VARCHAR,C.ADDR_ID)
LEFT JOIN [IN1563].[dim_cust_addr1_SQL_IN1563] D ON IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) = CONVERT(VARCHAR,D.ADDR_ID)
LEFT JOIN [IN1563].[DIM_CUST_CNTCT_SQL_IN1563] E ON IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) = CONVERT(VARCHAR,E.CNTCT_ID)) S

SELECT TENANT_ORG_ID,SUM(TOT_AMT) TOT_AMT,SUM(TAX_AMT) TAX_AMT
FROM Fact_sales_order_SQL_IN1563
GROUP BY TENANT_ORG_ID

SELECT TENANT_ORG_ID,SUM(TOT_AMT) TOT_AMT,SUM(TAX_AMT) TAX_AMT
FROM (SELECT
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(ORDER_REL_TS IS NULL OR ORDER_REL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_REL_TS)))) ORDER_REL_TS,
IIF(ORDER_REL_DT IS NULL OR ORDER_REL_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_REL_DT)))) ORDER_REL_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(TOT_AMT IS NULL OR TOT_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TOT_AMT)))) TOT_AMT,
IIF(TAX_AMT IS NULL OR TAX_AMT LIKE 'NULL',0,CONVERT(float,LTRIM(RTRIM(TAX_AMT)))) TAX_AMT,
IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) CURR_STS_ID,
IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) BILL_TO_ADDR_ID,
IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) BILL_TO_CUST_ID,
IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) CUST_CNTCT_ID,
IIF(GUEST_ORDER_IND IS NULL OR GUEST_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GUEST_ORDER_IND)))) GUEST_ORDER_IND,
IIF(CORP_ORDER_IND IS NULL OR CORP_ORDER_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CORP_ORDER_IND)))) CORP_ORDER_IND,
IIF(DEVICE_TYPE IS NULL OR DEVICE_TYPE LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(DEVICE_TYPE)))) DEVICE_TYPE,
IIF(IP_ADDR IS NULL OR IP_ADDR LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(IP_ADDR)))) IP_ADDR,
IIF(FRAUD_CHECK_REQD_IND IS NULL OR FRAUD_CHECK_REQD_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(FRAUD_CHECK_REQD_IND)))) FRAUD_CHECK_REQD_IND,
IIF(ORIG_SALES_ORDER_NUM IS NULL OR ORIG_SALES_ORDER_NUM LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(ORIG_SALES_ORDER_NUM)))) ORIG_SALES_ORDER_NUM,
IIF(HOLD_FLAG IS NULL OR HOLD_FLAG LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(HOLD_FLAG)))) HOLD_FLAG,
IIF(XCHNG_TYPE_ID IS NULL OR XCHNG_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(XCHNG_TYPE_ID)))) XCHNG_TYPE_ID,
IIF(ORDER_TYPE_ID IS NULL OR ORDER_TYPE_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORDER_TYPE_ID)))) ORDER_TYPE_ID,
IIF(WM_STORE_ORG_ID IS NULL OR WM_STORE_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(WM_STORE_ORG_ID)))) WM_STORE_ORG_ID,
-1 AS ORDER_REL_TS_KEY,
-1 AS ORDER_REL_DT_KEY,
-1 AS ORDER_PLACED_TS_KEY,
-1 AS ORDER_PLACED_DT_KEY,
ISNULL(B.STS_ID,-1) CURR_STS_ID_KEY,
ISNULL(C.ADDR_ID, -1) BILL_TO_ADDR_ID_KEY,
ISNULL(D.ADDR_ID,-1) BILL_TO_CUST_ID_KEY,
ISNULL(E.CNTCT_ID,-1) CUST_CNTCT_ID_KEY
FROM [BCMPWMT].[SALES_ORDER] A
LEFT JOIN [IN1563].[DIM_STS_LKP_SQL_IN1563]	B ON IIF(CURR_STS_ID IS NULL OR CURR_STS_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(CURR_STS_ID)))) = CONVERT(INT,B.STS_ID)
LEFT JOIN [IN1563].[dim_cust_address_SQL_IN1563] C ON IIF(BILL_TO_ADDR_ID IS NULL OR BILL_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_ADDR_ID)))) = CONVERT(VARCHAR,C.ADDR_ID)
LEFT JOIN [IN1563].[dim_cust_addr1_SQL_IN1563] D ON IIF(BILL_TO_CUST_ID IS NULL OR BILL_TO_CUST_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(BILL_TO_CUST_ID)))) = CONVERT(VARCHAR,D.ADDR_ID)
LEFT JOIN [IN1563].[DIM_CUST_CNTCT_SQL_IN1563] E ON IIF(CUST_CNTCT_ID IS NULL OR CUST_CNTCT_ID LIKE 'NULL','N/A',CONVERT(VARCHAR,LTRIM(RTRIM(CUST_CNTCT_ID)))) = CONVERT(VARCHAR,E.CNTCT_ID)) S
GROUP BY TENANT_ORG_ID

SELECT 
	COUNT(ORDER_REL_TS_KEY) AS ORDER_REL_TS_KEY,
	COUNT(ORDER_REL_DT_KEY) AS ORDER_REL_DT_KEY,
	COUNT(ORDER_PLACED_TS_KEY) AS ORDER_PLACED_TS_KEY,
	COUNT(ORDER_PLACED_DT_KEY) AS ORDER_PLACED_DT_KEY,
	COUNT(CURR_STS_ID_KEY) AS CURR_STS_ID_KEY,
	COUNT(BILL_TO_ADDR_ID_KEY) AS BILL_TO_ADDR_ID_KEY ,
	COUNT(BILL_TO_CUST_ID_KEY) AS BILL_TO_CUST_ID_KEY,
	COUNT(CUST_CNTCT_ID_KEY) AS CUST_CNTCT_ID_KEY
FROM Fact_sales_order_SQL_IN1563 T LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 A ON T.ORDER_REL_TS_KEY = A.Day_hour_key LEFT JOIN
Dim_day_SQL_IN1563 B ON T.ORDER_REL_DT_KEY = B.Day_key LEFT JOIN
DIM_DAY_HOUR_SQL_IN1563 C ON T.ORDER_PLACED_TS_KEY = C.Day_hour_key LEFT JOIN
Dim_day_SQL_IN1563 D ON T.ORDER_PLACED_DT_KEY = D.Day_key LEFT JOIN
DIM_STS_LKP_SQL_IN1563 E ON T.CURR_STS_ID_KEY = E.STS_LKP_KEY LEFT JOIN
dim_cust_address_SQL_IN1563 F ON T.BILL_TO_ADDR_ID_KEY = F.CUST_ADDR_KEY LEFT JOIN
dim_cust_addr1_SQL_IN1563 G ON T.BILL_TO_CUST_ID_KEY = G.CUST_AADR1_KEY LEFT JOIN
DIM_CUST_CNTCT_SQL_IN1563 H  ON T.CUST_CNTCT_ID_KEY = H.CUST_CNTCT_KEY
WHERE A.DAY_HOUR_KEY IS NULL AND
B.Day_key IS NULL AND C.DAY_HOUR_KEY IS NULL AND
D.Day_key IS NULL AND E.STS_ID IS NULL AND F.ADDR_ID IS NULL AND G.ADDR_ID IS NULL AND H.CNTCT_ID IS NULL

-------------------------------------------------------------------------------------------------------------------------------------

SELECT * FROM FACT_sales_order_line_SQL_IN1563

SELECT COUNT(*) FROM FACT_sales_order_line_SQL_IN1563

SELECT COUNT(*) FROM 
(SELECT 
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) SALES_ORDER_LINE_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(SHIP_NODE_ORG_ID IS NULL OR SHIP_NODE_ORG_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_NODE_ORG_ID)))) SHIP_NODE_ORG_ID,
IIF(GIFT_IND IS NULL OR GIFT_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GIFT_IND)))) GIFT_IND,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(SVC_NM IS NULL OR SVC_NM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SVC_NM)))) SVC_NM,
IIF(UNIT_PRICE IS NULL OR UNIT_PRICE  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_PRICE)))) UNIT_PRICE,
IIF(UNIT_COST IS NULL OR UNIT_COST  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_COST)))) UNIT_COST,
IIF(QTY IS NULL OR QTY  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(QTY)))) QTY,
IIF(SHPD_QTY IS NULL OR SHPD_QTY LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHPD_QTY)))) SHPD_QTY,
IIF(SHIP_TO_ADDR_ID IS NULL OR SHIP_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_TO_ADDR_ID)))) SHIP_TO_ADDR_ID,
IIF(A.WM_ITEM_NUM IS NULL OR A.WM_ITEM_NUM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.WM_ITEM_NUM)))) WM_ITEM_NUM,
IIF(A.UPC IS NULL OR A.UPC LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.UPC)))) UPC,
IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID)))) CATLG_ITEM_ID,
IIF(PROD_OFFR_ID IS NULL OR PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_OFFR_ID)))) PROD_OFFR_ID,
IIF(RQ_CANCEL_TS IS NULL OR RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_CANCEL_TS)))) RQ_CANCEL_TS,
IIF(RQ_SHIP_TS IS NULL OR RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_SHIP_TS)))) RQ_SHIP_TS,
IIF(SLR_ORG_ID IS NULL OR SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SLR_ORG_ID)))) SLR_ORG_ID,
IIF(SHIP_TO_STORE_ORG_ID IS NULL OR SHIP_TO_STORE_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SHIP_TO_STORE_ORG_ID)))) SHIP_TO_STORE_ORG_ID,
IIF(ORDER_STS_ID IS NULL OR ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_STS_ID)))) ORDER_STS_ID,
IIF(PROD_CLASS_ID IS NULL OR PROD_CLASS_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_CLASS_ID)))) PROD_CLASS_ID,
IIF(MAX_DAYS_TO_SHIP IS NULL OR MAX_DAYS_TO_SHIP LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(MAX_DAYS_TO_SHIP)))) MAX_DAYS_TO_SHIP,
IIF(EARLIEST_DLVR_TS IS NULL OR EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(EARLIEST_DLVR_TS)))) EARLIEST_DLVR_TS,
IIF(ORIG_EXPC_DLVR_TS IS NULL OR ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORIG_EXPC_DLVR_TS)))) ORIG_EXPC_DLVR_TS,
IIF(CARRIER_EXPC_DLVR_TS IS NULL OR CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CARRIER_EXPC_DLVR_TS)))) CARRIER_EXPC_DLVR_TS,
IIF(PROMO_ID IS NULL OR PROMO_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROMO_ID)))) PROMO_ID,
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(FULFMT_TYPE_ID)))) FULFMT_TYPE_ID,
IIF(ORDER_LINE_TYPE_ID IS NULL OR ORDER_LINE_TYPE_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_LINE_TYPE_ID)))) ORDER_LINE_TYPE_ID,
IIF(LINE_TOT_AMT IS NULL OR LINE_TOT_AMT  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(LINE_TOT_AMT)))) LINE_TOT_AMT,
IIF(ORIG_SALES_ORDER_LINE_NUM IS NULL OR ORIG_SALES_ORDER_LINE_NUM  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORIG_SALES_ORDER_LINE_NUM)))) ORIG_SALES_ORDER_LINE_NUM,
IIF(PERISHABLE_IND IS NULL OR PERISHABLE_IND  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(PERISHABLE_IND)))) PERISHABLE_IND,
IIF(ITEM_CLASS_ID IS NULL OR ITEM_CLASS_ID  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ITEM_CLASS_ID)))) ITEM_CLASS_ID,
ISNULL(P.PROD_KEY,-1) CATLG_ITEM_KEY,
ISNULL(O.OFFR_KEY, -1) PROD_OFFR_KEY,
ISNULL(D.DAY_HOUR_KEY,-1) AS RQ_CANCEL_TS_KEY,
ISNULL(D1.DAY_HOUR_KEY,-1) AS RQ_SHIP_TS_KEY,
ISNULL(S.ORDER_STS_MASTER_ID,-1) AS ORDER_STS_KEY,
ISNULL(D2.DAY_HOUR_KEY, -1) AS EARLIEST_DLVR_TS_KEY,
ISNULL(D3.DAY_HOUR_KEY,-1) AS ORIG_EXPC_DLVR_TS_KEY,
ISNULL(D4.DAY_HOUR_KEY,-1) AS CARRIER_EXPC_DLVR_TS_KEY,
ISNULL(ORG.ORG_BUSINESS_UNIT_KEY,-1) AS SLR_ORG_KEY,
ISNULL(AD.CUST_AADR1_KEY,-1) AS SHIP_TO_STORE_KEY
FROM  [BCMPWMT].[SALES_ORDER_LINE] A
LEFT JOIN dim_prod_SQL_IN1563 P ON IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID))))  = P.CATLG_ITEM_ID
LEFT JOIN Dim_OFFR_SQL_IN1563 O ON IIF(A.PROD_OFFR_ID IS NULL OR A.PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.PROD_OFFR_ID)))) = O.OFFER_PK
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D ON IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))) = D.DATE_ID AND
D.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D1 ON  IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))) = D1.DATE_ID AND
D1.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))))
LEFT JOIN Dim_ORDER_STS_MASTER_LKP_SQL_IN1563 S ON IIF(A.ORDER_STS_ID IS NULL OR A.ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.ORDER_STS_ID)))) = S.ORDER_STS_MASTER_ID
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D2 ON CONVERT(DATE,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS))))) = D2.DATE_ID AND
D2.HOUR_ID = DATEPART(HOUR,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D3 ON CONVERT(DATE,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS))))) = D3.DATE_ID AND
D3.HOUR_ID = DATEPART(HOUR,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D4 ON CONVERT(DATE,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS))))) = D4.DATE_ID AND
D4.HOUR_ID = DATEPART(HOUR,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS)))))
LEFT JOIN DIM_ORG_BUSINESS_UNIT_SQL_IN1563 ORG ON IIF(A.SLR_ORG_ID IS NULL OR A.SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.SLR_ORG_ID)))) = ORG.ORG_ID
LEFT JOIN dim_cust_addr1_SQL_IN1563 AD ON IIF(A.SHIP_TO_STORE_ORG_ID IS NULL OR A.SHIP_TO_STORE_ORG_ID  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(A.SHIP_TO_STORE_ORG_ID)))) = AD.ADDR_ID
) SRC

SELECT TENANT_ORG_ID,COUNT(*) FROM FACT_sales_order_line_SQL_IN1563 GROUP BY TENANT_ORG_ID

SELECT TENANT_ORG_ID,COUNT(*) FROM 
(SELECT 
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) SALES_ORDER_LINE_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(SHIP_NODE_ORG_ID IS NULL OR SHIP_NODE_ORG_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_NODE_ORG_ID)))) SHIP_NODE_ORG_ID,
IIF(GIFT_IND IS NULL OR GIFT_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GIFT_IND)))) GIFT_IND,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(SVC_NM IS NULL OR SVC_NM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SVC_NM)))) SVC_NM,
IIF(UNIT_PRICE IS NULL OR UNIT_PRICE  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_PRICE)))) UNIT_PRICE,
IIF(UNIT_COST IS NULL OR UNIT_COST  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_COST)))) UNIT_COST,
IIF(QTY IS NULL OR QTY  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(QTY)))) QTY,
IIF(SHPD_QTY IS NULL OR SHPD_QTY LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHPD_QTY)))) SHPD_QTY,
IIF(SHIP_TO_ADDR_ID IS NULL OR SHIP_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_TO_ADDR_ID)))) SHIP_TO_ADDR_ID,
IIF(A.WM_ITEM_NUM IS NULL OR A.WM_ITEM_NUM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.WM_ITEM_NUM)))) WM_ITEM_NUM,
IIF(A.UPC IS NULL OR A.UPC LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.UPC)))) UPC,
IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID)))) CATLG_ITEM_ID,
IIF(PROD_OFFR_ID IS NULL OR PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_OFFR_ID)))) PROD_OFFR_ID,
IIF(RQ_CANCEL_TS IS NULL OR RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_CANCEL_TS)))) RQ_CANCEL_TS,
IIF(RQ_SHIP_TS IS NULL OR RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_SHIP_TS)))) RQ_SHIP_TS,
IIF(SLR_ORG_ID IS NULL OR SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SLR_ORG_ID)))) SLR_ORG_ID,
IIF(SHIP_TO_STORE_ORG_ID IS NULL OR SHIP_TO_STORE_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SHIP_TO_STORE_ORG_ID)))) SHIP_TO_STORE_ORG_ID,
IIF(ORDER_STS_ID IS NULL OR ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_STS_ID)))) ORDER_STS_ID,
IIF(PROD_CLASS_ID IS NULL OR PROD_CLASS_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_CLASS_ID)))) PROD_CLASS_ID,
IIF(MAX_DAYS_TO_SHIP IS NULL OR MAX_DAYS_TO_SHIP LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(MAX_DAYS_TO_SHIP)))) MAX_DAYS_TO_SHIP,
IIF(EARLIEST_DLVR_TS IS NULL OR EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(EARLIEST_DLVR_TS)))) EARLIEST_DLVR_TS,
IIF(ORIG_EXPC_DLVR_TS IS NULL OR ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORIG_EXPC_DLVR_TS)))) ORIG_EXPC_DLVR_TS,
IIF(CARRIER_EXPC_DLVR_TS IS NULL OR CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CARRIER_EXPC_DLVR_TS)))) CARRIER_EXPC_DLVR_TS,
IIF(PROMO_ID IS NULL OR PROMO_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROMO_ID)))) PROMO_ID,
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(FULFMT_TYPE_ID)))) FULFMT_TYPE_ID,
IIF(ORDER_LINE_TYPE_ID IS NULL OR ORDER_LINE_TYPE_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_LINE_TYPE_ID)))) ORDER_LINE_TYPE_ID,
IIF(LINE_TOT_AMT IS NULL OR LINE_TOT_AMT  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(LINE_TOT_AMT)))) LINE_TOT_AMT,
IIF(ORIG_SALES_ORDER_LINE_NUM IS NULL OR ORIG_SALES_ORDER_LINE_NUM  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORIG_SALES_ORDER_LINE_NUM)))) ORIG_SALES_ORDER_LINE_NUM,
IIF(PERISHABLE_IND IS NULL OR PERISHABLE_IND  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(PERISHABLE_IND)))) PERISHABLE_IND,
IIF(ITEM_CLASS_ID IS NULL OR ITEM_CLASS_ID  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ITEM_CLASS_ID)))) ITEM_CLASS_ID,
ISNULL(P.PROD_KEY,-1) CATLG_ITEM_KEY,
ISNULL(O.OFFR_KEY, -1) PROD_OFFR_KEY,
ISNULL(D.DAY_HOUR_KEY,-1) AS RQ_CANCEL_TS_KEY,
ISNULL(D1.DAY_HOUR_KEY,-1) AS RQ_SHIP_TS_KEY,
ISNULL(S.ORDER_STS_MASTER_ID,-1) AS ORDER_STS_KEY,
ISNULL(D2.DAY_HOUR_KEY, -1) AS EARLIEST_DLVR_TS_KEY,
ISNULL(D3.DAY_HOUR_KEY,-1) AS ORIG_EXPC_DLVR_TS_KEY,
ISNULL(D4.DAY_HOUR_KEY,-1) AS CARRIER_EXPC_DLVR_TS_KEY,
ISNULL(ORG.ORG_BUSINESS_UNIT_KEY,-1) AS SLR_ORG_KEY,
ISNULL(AD.CUST_AADR1_KEY,-1) AS SHIP_TO_STORE_KEY
FROM  [BCMPWMT].[SALES_ORDER_LINE] A
LEFT JOIN dim_prod_SQL_IN1563 P ON IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID))))  = P.CATLG_ITEM_ID
LEFT JOIN Dim_OFFR_SQL_IN1563 O ON IIF(A.PROD_OFFR_ID IS NULL OR A.PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.PROD_OFFR_ID)))) = O.OFFER_PK
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D ON IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))) = D.DATE_ID AND
D.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D1 ON  IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))) = D1.DATE_ID AND
D1.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))))
LEFT JOIN Dim_ORDER_STS_MASTER_LKP_SQL_IN1563 S ON IIF(A.ORDER_STS_ID IS NULL OR A.ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.ORDER_STS_ID)))) = S.ORDER_STS_MASTER_ID
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D2 ON CONVERT(DATE,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS))))) = D2.DATE_ID AND
D2.HOUR_ID = DATEPART(HOUR,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D3 ON CONVERT(DATE,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS))))) = D3.DATE_ID AND
D3.HOUR_ID = DATEPART(HOUR,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D4 ON CONVERT(DATE,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS))))) = D4.DATE_ID AND
D4.HOUR_ID = DATEPART(HOUR,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS)))))
LEFT JOIN DIM_ORG_BUSINESS_UNIT_SQL_IN1563 ORG ON IIF(A.SLR_ORG_ID IS NULL OR A.SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.SLR_ORG_ID)))) = ORG.ORG_ID
LEFT JOIN dim_cust_addr1_SQL_IN1563 AD ON IIF(A.SHIP_TO_STORE_ORG_ID IS NULL OR A.SHIP_TO_STORE_ORG_ID  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(A.SHIP_TO_STORE_ORG_ID)))) = AD.ADDR_ID
) SRC
GROUP BY TENANT_ORG_ID


SELECT SUM(UNIT_PRICE) UNIT_PRICE,SUM(UNIT_COST) UNIT_COST,SUM(QTY) QTY,SUM(LINE_TOT_AMT) LINE_TOT_AMT
FROM FACT_sales_order_line_SQL_IN1563

SELECT SUM(UNIT_PRICE) UNIT_PRICE,SUM(UNIT_COST) UNIT_COST,SUM(QTY) QTY,SUM(LINE_TOT_AMT) LINE_TOT_AMT
FROM (SELECT 
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) SALES_ORDER_LINE_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(SHIP_NODE_ORG_ID IS NULL OR SHIP_NODE_ORG_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_NODE_ORG_ID)))) SHIP_NODE_ORG_ID,
IIF(GIFT_IND IS NULL OR GIFT_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GIFT_IND)))) GIFT_IND,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(SVC_NM IS NULL OR SVC_NM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SVC_NM)))) SVC_NM,
IIF(UNIT_PRICE IS NULL OR UNIT_PRICE  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_PRICE)))) UNIT_PRICE,
IIF(UNIT_COST IS NULL OR UNIT_COST  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_COST)))) UNIT_COST,
IIF(QTY IS NULL OR QTY  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(QTY)))) QTY,
IIF(SHPD_QTY IS NULL OR SHPD_QTY LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHPD_QTY)))) SHPD_QTY,
IIF(SHIP_TO_ADDR_ID IS NULL OR SHIP_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_TO_ADDR_ID)))) SHIP_TO_ADDR_ID,
IIF(A.WM_ITEM_NUM IS NULL OR A.WM_ITEM_NUM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.WM_ITEM_NUM)))) WM_ITEM_NUM,
IIF(A.UPC IS NULL OR A.UPC LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.UPC)))) UPC,
IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID)))) CATLG_ITEM_ID,
IIF(PROD_OFFR_ID IS NULL OR PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_OFFR_ID)))) PROD_OFFR_ID,
IIF(RQ_CANCEL_TS IS NULL OR RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_CANCEL_TS)))) RQ_CANCEL_TS,
IIF(RQ_SHIP_TS IS NULL OR RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_SHIP_TS)))) RQ_SHIP_TS,
IIF(SLR_ORG_ID IS NULL OR SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SLR_ORG_ID)))) SLR_ORG_ID,
IIF(SHIP_TO_STORE_ORG_ID IS NULL OR SHIP_TO_STORE_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SHIP_TO_STORE_ORG_ID)))) SHIP_TO_STORE_ORG_ID,
IIF(ORDER_STS_ID IS NULL OR ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_STS_ID)))) ORDER_STS_ID,
IIF(PROD_CLASS_ID IS NULL OR PROD_CLASS_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_CLASS_ID)))) PROD_CLASS_ID,
IIF(MAX_DAYS_TO_SHIP IS NULL OR MAX_DAYS_TO_SHIP LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(MAX_DAYS_TO_SHIP)))) MAX_DAYS_TO_SHIP,
IIF(EARLIEST_DLVR_TS IS NULL OR EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(EARLIEST_DLVR_TS)))) EARLIEST_DLVR_TS,
IIF(ORIG_EXPC_DLVR_TS IS NULL OR ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORIG_EXPC_DLVR_TS)))) ORIG_EXPC_DLVR_TS,
IIF(CARRIER_EXPC_DLVR_TS IS NULL OR CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CARRIER_EXPC_DLVR_TS)))) CARRIER_EXPC_DLVR_TS,
IIF(PROMO_ID IS NULL OR PROMO_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROMO_ID)))) PROMO_ID,
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(FULFMT_TYPE_ID)))) FULFMT_TYPE_ID,
IIF(ORDER_LINE_TYPE_ID IS NULL OR ORDER_LINE_TYPE_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_LINE_TYPE_ID)))) ORDER_LINE_TYPE_ID,
IIF(LINE_TOT_AMT IS NULL OR LINE_TOT_AMT  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(LINE_TOT_AMT)))) LINE_TOT_AMT,
IIF(ORIG_SALES_ORDER_LINE_NUM IS NULL OR ORIG_SALES_ORDER_LINE_NUM  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORIG_SALES_ORDER_LINE_NUM)))) ORIG_SALES_ORDER_LINE_NUM,
IIF(PERISHABLE_IND IS NULL OR PERISHABLE_IND  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(PERISHABLE_IND)))) PERISHABLE_IND,
IIF(ITEM_CLASS_ID IS NULL OR ITEM_CLASS_ID  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ITEM_CLASS_ID)))) ITEM_CLASS_ID,
ISNULL(P.PROD_KEY,-1) CATLG_ITEM_KEY,
ISNULL(O.OFFR_KEY, -1) PROD_OFFR_KEY,
ISNULL(D.DAY_HOUR_KEY,-1) AS RQ_CANCEL_TS_KEY,
ISNULL(D1.DAY_HOUR_KEY,-1) AS RQ_SHIP_TS_KEY,
ISNULL(S.ORDER_STS_MASTER_ID,-1) AS ORDER_STS_KEY,
ISNULL(D2.DAY_HOUR_KEY, -1) AS EARLIEST_DLVR_TS_KEY,
ISNULL(D3.DAY_HOUR_KEY,-1) AS ORIG_EXPC_DLVR_TS_KEY,
ISNULL(D4.DAY_HOUR_KEY,-1) AS CARRIER_EXPC_DLVR_TS_KEY,
ISNULL(ORG.ORG_BUSINESS_UNIT_KEY,-1) AS SLR_ORG_KEY,
ISNULL(AD.CUST_AADR1_KEY,-1) AS SHIP_TO_STORE_KEY
FROM  [BCMPWMT].[SALES_ORDER_LINE] A
LEFT JOIN dim_prod_SQL_IN1563 P ON IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID))))  = P.CATLG_ITEM_ID
LEFT JOIN Dim_OFFR_SQL_IN1563 O ON IIF(A.PROD_OFFR_ID IS NULL OR A.PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.PROD_OFFR_ID)))) = O.OFFER_PK
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D ON IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))) = D.DATE_ID AND
D.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D1 ON  IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))) = D1.DATE_ID AND
D1.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))))
LEFT JOIN Dim_ORDER_STS_MASTER_LKP_SQL_IN1563 S ON IIF(A.ORDER_STS_ID IS NULL OR A.ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.ORDER_STS_ID)))) = S.ORDER_STS_MASTER_ID
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D2 ON CONVERT(DATE,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS))))) = D2.DATE_ID AND
D2.HOUR_ID = DATEPART(HOUR,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D3 ON CONVERT(DATE,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS))))) = D3.DATE_ID AND
D3.HOUR_ID = DATEPART(HOUR,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D4 ON CONVERT(DATE,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS))))) = D4.DATE_ID AND
D4.HOUR_ID = DATEPART(HOUR,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS)))))
LEFT JOIN DIM_ORG_BUSINESS_UNIT_SQL_IN1563 ORG ON IIF(A.SLR_ORG_ID IS NULL OR A.SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.SLR_ORG_ID)))) = ORG.ORG_ID
LEFT JOIN dim_cust_addr1_SQL_IN1563 AD ON IIF(A.SHIP_TO_STORE_ORG_ID IS NULL OR A.SHIP_TO_STORE_ORG_ID  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(A.SHIP_TO_STORE_ORG_ID)))) = AD.ADDR_ID
) SRC


SELECT TENANT_ORG_ID,SUM(UNIT_PRICE) UNIT_PRICE,SUM(UNIT_COST) UNIT_COST,SUM(QTY) QTY,SUM(LINE_TOT_AMT) LINE_TOT_AMT
FROM FACT_sales_order_line_SQL_IN1563
GROUP BY TENANT_ORG_ID


SELECT TENANT_ORG_ID,SUM(UNIT_PRICE) UNIT_PRICE,SUM(UNIT_COST) UNIT_COST,SUM(QTY) QTY,SUM(LINE_TOT_AMT) LINE_TOT_AMT
FROM (SELECT 
IIF(SALES_ORDER_NUM IS NULL OR SALES_ORDER_NUM LIKE 'NULL',101,CONVERT(BIGINT,LTRIM(RTRIM(SALES_ORDER_NUM)))) SALES_ORDER_NUM,
IIF(SALES_ORDER_LINE_NUM IS NULL OR SALES_ORDER_LINE_NUM LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(SALES_ORDER_LINE_NUM)))) SALES_ORDER_LINE_NUM,
IIF(A.TENANT_ORG_ID IS NULL OR A.TENANT_ORG_ID LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(A.TENANT_ORG_ID)))) TENANT_ORG_ID,
IIF(SHIP_NODE_ORG_ID IS NULL OR SHIP_NODE_ORG_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_NODE_ORG_ID)))) SHIP_NODE_ORG_ID,
IIF(GIFT_IND IS NULL OR GIFT_IND LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(GIFT_IND)))) GIFT_IND,
IIF(ORDER_PLACED_DT IS NULL OR ORDER_PLACED_DT LIKE 'NULL','01/01/1900',CONVERT(DATE,LTRIM(RTRIM(ORDER_PLACED_DT)))) ORDER_PLACED_DT,
IIF(ORDER_PLACED_TS IS NULL OR ORDER_PLACED_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORDER_PLACED_TS)))) ORDER_PLACED_TS,
IIF(SVC_NM IS NULL OR SVC_NM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SVC_NM)))) SVC_NM,
IIF(UNIT_PRICE IS NULL OR UNIT_PRICE  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_PRICE)))) UNIT_PRICE,
IIF(UNIT_COST IS NULL OR UNIT_COST  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(UNIT_COST)))) UNIT_COST,
IIF(QTY IS NULL OR QTY  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(QTY)))) QTY,
IIF(SHPD_QTY IS NULL OR SHPD_QTY LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHPD_QTY)))) SHPD_QTY,
IIF(SHIP_TO_ADDR_ID IS NULL OR SHIP_TO_ADDR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(SHIP_TO_ADDR_ID)))) SHIP_TO_ADDR_ID,
IIF(A.WM_ITEM_NUM IS NULL OR A.WM_ITEM_NUM LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.WM_ITEM_NUM)))) WM_ITEM_NUM,
IIF(A.UPC IS NULL OR A.UPC LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.UPC)))) UPC,
IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID)))) CATLG_ITEM_ID,
IIF(PROD_OFFR_ID IS NULL OR PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_OFFR_ID)))) PROD_OFFR_ID,
IIF(RQ_CANCEL_TS IS NULL OR RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_CANCEL_TS)))) RQ_CANCEL_TS,
IIF(RQ_SHIP_TS IS NULL OR RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(RQ_SHIP_TS)))) RQ_SHIP_TS,
IIF(SLR_ORG_ID IS NULL OR SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SLR_ORG_ID)))) SLR_ORG_ID,
IIF(SHIP_TO_STORE_ORG_ID IS NULL OR SHIP_TO_STORE_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(SHIP_TO_STORE_ORG_ID)))) SHIP_TO_STORE_ORG_ID,
IIF(ORDER_STS_ID IS NULL OR ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_STS_ID)))) ORDER_STS_ID,
IIF(PROD_CLASS_ID IS NULL OR PROD_CLASS_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROD_CLASS_ID)))) PROD_CLASS_ID,
IIF(MAX_DAYS_TO_SHIP IS NULL OR MAX_DAYS_TO_SHIP LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(MAX_DAYS_TO_SHIP)))) MAX_DAYS_TO_SHIP,
IIF(EARLIEST_DLVR_TS IS NULL OR EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(EARLIEST_DLVR_TS)))) EARLIEST_DLVR_TS,
IIF(ORIG_EXPC_DLVR_TS IS NULL OR ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(ORIG_EXPC_DLVR_TS)))) ORIG_EXPC_DLVR_TS,
IIF(CARRIER_EXPC_DLVR_TS IS NULL OR CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(CARRIER_EXPC_DLVR_TS)))) CARRIER_EXPC_DLVR_TS,
IIF(PROMO_ID IS NULL OR PROMO_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(PROMO_ID)))) PROMO_ID,
IIF(FULFMT_TYPE_ID IS NULL OR FULFMT_TYPE_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(FULFMT_TYPE_ID)))) FULFMT_TYPE_ID,
IIF(ORDER_LINE_TYPE_ID IS NULL OR ORDER_LINE_TYPE_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(ORDER_LINE_TYPE_ID)))) ORDER_LINE_TYPE_ID,
IIF(LINE_TOT_AMT IS NULL OR LINE_TOT_AMT  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(LINE_TOT_AMT)))) LINE_TOT_AMT,
IIF(ORIG_SALES_ORDER_LINE_NUM IS NULL OR ORIG_SALES_ORDER_LINE_NUM  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ORIG_SALES_ORDER_LINE_NUM)))) ORIG_SALES_ORDER_LINE_NUM,
IIF(PERISHABLE_IND IS NULL OR PERISHABLE_IND  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(PERISHABLE_IND)))) PERISHABLE_IND,
IIF(ITEM_CLASS_ID IS NULL OR ITEM_CLASS_ID  LIKE 'NULL',101,CONVERT(INT,LTRIM(RTRIM(ITEM_CLASS_ID)))) ITEM_CLASS_ID,
ISNULL(P.PROD_KEY,-1) CATLG_ITEM_KEY,
ISNULL(O.OFFR_KEY, -1) PROD_OFFR_KEY,
ISNULL(D.DAY_HOUR_KEY,-1) AS RQ_CANCEL_TS_KEY,
ISNULL(D1.DAY_HOUR_KEY,-1) AS RQ_SHIP_TS_KEY,
ISNULL(S.ORDER_STS_MASTER_ID,-1) AS ORDER_STS_KEY,
ISNULL(D2.DAY_HOUR_KEY, -1) AS EARLIEST_DLVR_TS_KEY,
ISNULL(D3.DAY_HOUR_KEY,-1) AS ORIG_EXPC_DLVR_TS_KEY,
ISNULL(D4.DAY_HOUR_KEY,-1) AS CARRIER_EXPC_DLVR_TS_KEY,
ISNULL(ORG.ORG_BUSINESS_UNIT_KEY,-1) AS SLR_ORG_KEY,
ISNULL(AD.CUST_AADR1_KEY,-1) AS SHIP_TO_STORE_KEY
FROM  [BCMPWMT].[SALES_ORDER_LINE] A
LEFT JOIN dim_prod_SQL_IN1563 P ON IIF(A.CATLG_ITEM_ID IS NULL OR A.CATLG_ITEM_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.CATLG_ITEM_ID))))  = P.CATLG_ITEM_ID
LEFT JOIN Dim_OFFR_SQL_IN1563 O ON IIF(A.PROD_OFFR_ID IS NULL OR A.PROD_OFFR_ID LIKE 'NULL','N/A',CONVERT(varchar,LTRIM(RTRIM(A.PROD_OFFR_ID)))) = O.OFFER_PK
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D ON IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))) = D.DATE_ID AND
D.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_CANCEL_TS IS NULL OR A.RQ_CANCEL_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_CANCEL_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D1 ON  IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))) = D1.DATE_ID AND
D1.HOUR_ID = DATEPART(HOUR,IIF(A.RQ_SHIP_TS IS NULL OR A.RQ_SHIP_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.RQ_SHIP_TS)))))
LEFT JOIN Dim_ORDER_STS_MASTER_LKP_SQL_IN1563 S ON IIF(A.ORDER_STS_ID IS NULL OR A.ORDER_STS_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.ORDER_STS_ID)))) = S.ORDER_STS_MASTER_ID
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D2 ON CONVERT(DATE,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS))))) = D2.DATE_ID AND
D2.HOUR_ID = DATEPART(HOUR,IIF(A.EARLIEST_DLVR_TS IS NULL OR A.EARLIEST_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.EARLIEST_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D3 ON CONVERT(DATE,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS))))) = D3.DATE_ID AND
D3.HOUR_ID = DATEPART(HOUR,IIF(A.ORIG_EXPC_DLVR_TS IS NULL OR A.ORIG_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.ORIG_EXPC_DLVR_TS)))))
LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D4 ON CONVERT(DATE,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS))))) = D4.DATE_ID AND
D4.HOUR_ID = DATEPART(HOUR,IIF(A.CARRIER_EXPC_DLVR_TS IS NULL OR A.CARRIER_EXPC_DLVR_TS LIKE 'NULL','01/01/1900',CONVERT(DATETIME,LTRIM(RTRIM(A.CARRIER_EXPC_DLVR_TS)))))
LEFT JOIN DIM_ORG_BUSINESS_UNIT_SQL_IN1563 ORG ON IIF(A.SLR_ORG_ID IS NULL OR A.SLR_ORG_ID  LIKE 'NULL',101,CONVERT(FLOAT,LTRIM(RTRIM(A.SLR_ORG_ID)))) = ORG.ORG_ID
LEFT JOIN dim_cust_addr1_SQL_IN1563 AD ON IIF(A.SHIP_TO_STORE_ORG_ID IS NULL OR A.SHIP_TO_STORE_ORG_ID  LIKE 'NULL',0,CONVERT(FLOAT,LTRIM(RTRIM(A.SHIP_TO_STORE_ORG_ID)))) = AD.ADDR_ID
) SRC
GROUP BY TENANT_ORG_ID


SELECT 
	COUNT(CATLG_ITEM_KEY) AS CATLG_ITEM_KEY,
	COUNT(PROD_OFFR_KEY) AS PROD_OFFR_KEY, 
	COUNT(RQ_CANCEL_TS_KEY) AS RQ_CANCEL_TS_KEY,
	COUNT(RQ_SHIP_TS_KEY) AS RQ_SHIP_TS_KEY,
	COUNT(ORDER_STS_KEY) AS ORDER_STS_KEY,
	COUNT(EARLIEST_DLVR_TS_KEY) AS EARLIEST_DLVR_TS_KEY,
	COUNT(ORIG_EXPC_DLVR_TS_KEY) AS ORIG_EXPC_DLVR_TS_KEY,
	COUNT(SLR_ORG_KEY) AS SLR_ORG_KEY,
	COUNT(SHIP_TO_STORE_KEY) AS SHIP_TO_STORE_KEY,
	COUNT(CARRIER_EXPC_DLVR_TS_KEY) AS CARRIER_EXPC_DLVR_TS_KEY
FROM
	FACT_sales_order_line_SQL_IN1563 T 
	LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 A ON T.RQ_CANCEL_TS_KEY = A.DAY_HOUR_KEY 
	LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 B ON T.RQ_SHIP_TS_KEY = B.DAY_HOUR_KEY
	LEFT JOIN  DIM_DAY_HOUR_SQL_IN1563 C ON T.EARLIEST_DLVR_TS_KEY = C.DAY_HOUR_KEY
	LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 D ON T.ORIG_EXPC_DLVR_TS_KEY = D.DAY_HOUR_KEY
	LEFT JOIN DIM_DAY_HOUR_SQL_IN1563 E ON T.CARRIER_EXPC_DLVR_TS_KEY = E.DAY_HOUR_KEY
	LEFT JOIN DIM_PROD_SQL_IN1563 P ON T.CATLG_ITEM_KEY = P.PROD_KEY
	LEFT JOIN DIM_OFFR_SQL_IN1563 O ON T.PROD_OFFR_KEY = O. OFFR_KEY
	LEFT JOIN Dim_ORDER_STS_MASTER_LKP_SQL_IN1563 S ON T.ORDER_STS_KEY = S.ORDER_STS_MASTER_ID 
	LEFT JOIN DIM_ORG_BUSINESS_UNIT_SQL_IN1563 ORG ON T.SLR_ORG_KEY = ORG.ORG_BUSINESS_UNIT_KEY 
	LEFT JOIN dim_cust_addr1_SQL_IN1563 AD ON T.SHIP_TO_STORE_KEY = AD.CUST_AADR1_KEY
WHERE
	A.DAY_HOUR_KEY IS NULL AND
	B.DAY_HOUR_KEY IS NULL AND
	C.DAY_HOUR_KEY IS NULL AND
	D.DAY_HOUR_KEY IS NULL AND
	E.DAY_HOUR_KEY IS NULL AND
	P.CATLG_ITEM_ID IS NULL AND
	O.OFFER_PK IS NULL AND
	S.ORDER_STS_MASTER_ID IS NULL AND
	ORG.ORG_ID IS NULL AND
	AD.CUST_AADR1_KEY IS NULL

----------------------------------------------------------------------------------------------------------------------------------------

select * from FACT_RTN_ORDER_LINE_SQL_IN1563

select count(*) from FACT_RTN_ORDER_LINE_SQL_IN1563

select count(*) from 
(select 
IIF((r.RTN_ORDER_NUM IS NULL OR r.RTN_ORDER_NUM='NULL' OR r.RTN_ORDER_NUM LIKE '%[A-Za-z]%'),'N/A',ltrim(rtrim(r.RTN_ORDER_NUM))) RTN_ORDER_NUM,
IIF((r.RTN_LINE_NUM IS NULL OR r.RTN_LINE_NUM='NULL'  OR r.RTN_LINE_NUM LIKE '%[A-Za-z]%'),'N/A',ltrim(rtrim(r.RTN_LINE_NUM))) RTN_LINE_NUM,
IIF((r.TENANT_ORG_ID IS NULL OR r.TENANT_ORG_ID='NULL' or r.TENANT_ORG_ID like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.TENANT_ORG_ID))as int)) TENANT_ORG_ID,
IIF((r.SALES_ORDER_NUM IS NULL OR r.SALES_ORDER_NUM='NULL' or r.SALES_ORDER_NUM like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.SALES_ORDER_NUM))as bigint))  SALES_ORDER_NUM,
IIF((r.SALES_ORDER_LINE_NUM IS NULL OR r.SALES_ORDER_LINE_NUM='NULL'  or r.SALES_ORDER_NUM like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.SALES_ORDER_LINE_NUM ))as int)) SALES_ORDER_LINE_NUM,
IIF((r.RCV_STORE_ORG_CD IS NULL OR r.RCV_STORE_ORG_CD='NULL' or RCV_STORE_ORG_CD='?'),'N/A',ltrim(rtrim(r.RCV_STORE_ORG_CD))) RCV_STORE_ORG_CD,
IIF((r.RTN_QTY IS NULL or r.RTN_QTY like '%[a-zA-Z]%'),0.00,cast(ltrim(rtrim(r.RTN_QTY))as float)) RTN_QTY,
IIF((r.VIRT_RTN_IND IS NULL OR r.VIRT_RTN_IND='NULL' OR r.VIRT_RTN_IND like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.VIRT_RTN_IND))as int)) VIRT_RTN_IND,
case 
when r.AFFIDAVIT_SIGNUP_TS like '%M%' and r.AFFIDAVIT_SIGNUP_TS != 'AFFIDAVIT_SIGNUP_TS' then cast(substring(r.AFFIDAVIT_SIGNUP_TS,1,len(r.AFFIDAVIT_SIGNUP_TS)-7) as datetime)
when r.AFFIDAVIT_SIGNUP_TS is null or r.AFFIDAVIT_SIGNUP_TS = 'AFFIDAVIT_SIGNUP_TS' or r.AFFIDAVIT_SIGNUP_TS='null' or r.AFFIDAVIT_SIGNUP_TS='?' then cast('1/1/1900' as datetime)
else cast(r.AFFIDAVIT_SIGNUP_TS as datetime)
end AFFIDAVIT_SIGNUP_TS,
IIF((r.ITEM_EXPC_BACK_FLAG IS NULL OR r.ITEM_EXPC_BACK_FLAG='NULL' OR r.ITEM_EXPC_BACK_FLAG like '%[a-zA-Z]%'),101,cast(ltrim(rtrim(r.ITEM_EXPC_BACK_FLAG))as int)) ITEM_EXPC_BACK_FLAG,
case 
when r.RTN_LINE_MODFD_TS like '%M%' and r.RTN_LINE_MODFD_TS != 'RTN_LINE_MODFD_TS' then cast(substring(r.RTN_LINE_MODFD_TS,1,len(r.RTN_LINE_MODFD_TS)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_MODFD_TS = 'RTN_LINE_MODFD_TS' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_MODFD_TS as datetime)
end RTN_LINE_MODFD_TS,
case 
when r.RTN_LINE_CRE_DT like '%M%' and r.RTN_LINE_CRE_DT != 'RTN_LINE_CRE_DT' then cast(substring(r.RTN_LINE_CRE_DT,1,len(r.RTN_LINE_CRE_DT)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_CRE_DT = 'RTN_LINE_CRE_DT' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_DT as datetime)
end RTN_LINE_CRE_DT,
IIF((r.RFND_FLAG IS NULL OR r.RFND_FLAG='NULL' or r.RFND_FLAG like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.RFND_FLAG)))) RFND_FLAG,
IIF((r.RTN_RSN_CD IS NULL OR r.RTN_RSN_CD='NULL'),'N/A',ltrim(rtrim(r.RTN_RSN_CD))) RTN_RSN_CD,
IIF((r.LINE_TOT_AMT IS NULL OR r.LINE_TOT_AMT='NULL' or r.LINE_TOT_AMT like '%[a-zA-Z]%'),0.00,CONVERT(float,LTRIM(RTRIM(r.LINE_TOT_AMT)))) LINE_TOT_AMT,
IIF((r.OTHR_CHRG_AMT IS NULL OR r.OTHR_CHRG_AMT='NULL' or r.OTHR_CHRG_AMT like '%[a-zA-Z]%' or r.OTHR_CHRG_AMT='?'),0.00,CONVERT(float,LTRIM(RTRIM(r.OTHR_CHRG_AMT)))) OTHR_CHRG_AMT,
IIF((r.RTN_CENTER_ORG_CD IS NULL OR r.RTN_CENTER_ORG_CD='NULL' or  r.RTN_CENTER_ORG_CD like '%[a-zA-Z]%' or r.RTN_CENTER_ORG_CD='?'),101,CONVERT(int,LTRIM(RTRIM(r.RTN_CENTER_ORG_CD)))) RTN_CENTER_ORG_CD,
case 
when r.SRC_CRE_TS like '%M%' then cast(substring(r.SRC_CRE_TS,1,len(r.SRC_CRE_TS)-6) as datetime)
when r.SRC_CRE_TS is null or r.SRC_CRE_TS like 'SRC_CRE_TS' then '1/1/1900'
else cast(r.SRC_CRE_TS as datetime)
end SRC_CRE_TS,
case 
when r.SRC_UPD_TS like '%M%' then cast(substring(r.SRC_UPD_TS,1,len(r.SRC_UPD_TS)-7) as datetime)
when r.SRC_UPD_TS is null or r.SRC_UPD_TS like 'SRC_UPD_TS' then '1/1/1900'
else cast(r.SRC_UPD_TS as datetime)
end SRC_UPD_TS,
case 
when r.RTN_LINE_CRE_DT like '%M%' and r.RTN_LINE_CRE_DT != 'RTN_LINE_CRE_DT' then cast(substring(r.RTN_LINE_CRE_DT,1,len(r.RTN_LINE_CRE_DT)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_CRE_DT = 'RTN_LINE_CRE_DT' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_DT as datetime)
end RTN_LINE_CRE_DT,
IIF((r.CATLG_ITEM_ID IS NULL OR r.CATLG_ITEM_ID='NULL' or r.CATLG_ITEM_ID like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.CATLG_ITEM_ID)))) CATLG_ITEM_ID,
IIF((r.UNIT_PRICE IS NULL OR r.UNIT_PRICE='NULL' or r.UNIT_PRICE like '%[a-zA-Z]%'),0.00,CONVERT(float,LTRIM(RTRIM(r.UNIT_PRICE)))) UNIT_PRICE,
IIF((r.RTN_RSN_BUCKET IS NULL OR r.RTN_RSN_BUCKET='NULL'),'N/A',ltrim(rtrim(r.RTN_RSN_BUCKET))) RTN_RSN_BUCKET,
IIF((r.RDC_ORG_ID IS NULL OR r.RDC_ORG_ID='NULL' or r.RDC_ORG_ID like '%[a-zA-Z]%' or RDC_ORG_ID='?'),101.00,CONVERT(float,LTRIM(RTRIM(r.RDC_ORG_ID)))) RDC_ORG_ID,
IIF((r.ORDER_STS_ID IS NULL OR r.ORDER_STS_ID='NULL'  or r.ORDER_STS_ID like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.ORDER_STS_ID)))) ORDER_STS_ID,
IIF((s.STS_LKP_key IS NULL),-1,s.STS_LKP_key) STS_LKP_KEY,
IIF((p.PROD_KEY IS NULL),-1,p.PROD_KEY) PROD_KEY,
IIF((rl.rsn_key IS NULL),-1,rl.rsn_key) RSN_KEY,
IIF((d1.hour_key IS NULL ),-1,d1.hour_key) AFFIDAVIT_SIGNUP_TS_KEY,
IIF((d2.hour_key IS NULL),-1,d2.hour_key) RTN_LINE_MODFD_TS_KEY,
IIF((d3.hour_key IS NULL ),-1, d3.hour_key) RTN_LINE_CRE_TS_KEY,
IIF((d4.hour_key IS NULL),-1,d4.hour_key) RTN_LINE_CRE_DT_KEY
from [BCMPWMT].[RTN_ORDER_LINE] r
left join DIM_STS_LKP_SQL_IN1563 s
on IIF((r.ORDER_STS_ID IS NULL OR r.ORDER_STS_ID='NULL'  or r.ORDER_STS_ID like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.ORDER_STS_ID))))=s.sts_id
LEFT JOIN dim_prod_SQL_IN1563 P
on IIF((r.CATLG_ITEM_ID IS NULL OR r.CATLG_ITEM_ID='NULL' or r.CATLG_ITEM_ID like '%[a-zA-Z]%'),101,CONVERT(int,LTRIM(RTRIM(r.CATLG_ITEM_ID))))=P.CATLG_ITEM_ID
LEFT JOIN dim_RSN_LKP_SQL_IN1563 rl
on rl.rsn_id=IIF((r.RTN_RSN_CD IS NULL or RTN_RSN_CD like '%[a-zA-Z?]%' or RDC_ORG_ID='null'),101,ltrim(rtrim(r.RTN_RSN_CD)))
left join 
 DIM_DAY_HOUR_SQL_IN1563 d1
on convert(date,case 
when r.AFFIDAVIT_SIGNUP_TS like '%M%' and r.AFFIDAVIT_SIGNUP_TS != 'AFFIDAVIT_SIGNUP_TS' then cast(substring(r.AFFIDAVIT_SIGNUP_TS,1,len(r.AFFIDAVIT_SIGNUP_TS)-7) as datetime)
when r.AFFIDAVIT_SIGNUP_TS is null or r.AFFIDAVIT_SIGNUP_TS = 'AFFIDAVIT_SIGNUP_TS' or r.AFFIDAVIT_SIGNUP_TS='null' or r.AFFIDAVIT_SIGNUP_TS='?' then cast('1/1/1900' as datetime)
else cast(r.AFFIDAVIT_SIGNUP_TS as datetime)
end)=d1.DATE_ID
AND
d1.HOUR_ID = DATEPART(HOUR,case 
when r.AFFIDAVIT_SIGNUP_TS like '%M%' and r.AFFIDAVIT_SIGNUP_TS != 'AFFIDAVIT_SIGNUP_TS' then cast(substring(r.AFFIDAVIT_SIGNUP_TS,1,len(r.AFFIDAVIT_SIGNUP_TS)-7) as datetime)
when r.AFFIDAVIT_SIGNUP_TS is null or r.AFFIDAVIT_SIGNUP_TS = 'AFFIDAVIT_SIGNUP_TS' or r.AFFIDAVIT_SIGNUP_TS='null' or r.AFFIDAVIT_SIGNUP_TS='?' then cast('1/1/1900' as datetime)
else cast(r.AFFIDAVIT_SIGNUP_TS as datetime)
end)
left join 
 DIM_DAY_HOUR_SQL_IN1563 d2
on convert(date,case 
when r.RTN_LINE_MODFD_TS like '%M%' and r.RTN_LINE_MODFD_TS != 'RTN_LINE_MODFD_TS' then cast(substring(r.RTN_LINE_MODFD_TS,1,len(r.RTN_LINE_MODFD_TS)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_MODFD_TS = 'RTN_LINE_MODFD_TS' or r.RTN_LINE_MODFD_TS='null' or r.RTN_LINE_MODFD_TS='?' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_MODFD_TS as datetime)
end)=d2.DATE_ID
AND
d2.HOUR_ID = DATEPART(HOUR,case 
when r.RTN_LINE_MODFD_TS like '%M%' and r.RTN_LINE_MODFD_TS != 'RTN_LINE_MODFD_TS' then cast(substring(r.RTN_LINE_MODFD_TS,1,len(r.RTN_LINE_MODFD_TS)-7) as datetime)
when r.RTN_LINE_MODFD_TS is null or r.RTN_LINE_MODFD_TS = 'RTN_LINE_MODFD_TS' or r.RTN_LINE_MODFD_TS='null' or r.RTN_LINE_MODFD_TS='?' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_MODFD_TS as datetime)end)
left join DIM_DAY_HOUR_SQL_IN1563 d3
on convert(date,case 
when r.RTN_LINE_CRE_TS like '%M%' and r.RTN_LINE_CRE_TS != 'RTN_LINE_CRE_TS' then cast(substring(r.RTN_LINE_CRE_TS,1,len(r.RTN_LINE_CRE_TS)-7) as datetime)
when r.RTN_LINE_CRE_TS is null or r.RTN_LINE_CRE_TS = 'RTN_LINE_CRE_TS' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_TS as datetime)end)=d3.DATE_ID
AND
d3.HOUR_ID = DATEPART(HOUR,case 
when r.RTN_LINE_CRE_TS like '%M%' and r.RTN_LINE_CRE_TS != 'RTN_LINE_CRE_TS' then cast(substring(r.RTN_LINE_CRE_TS,1,len(r.RTN_LINE_CRE_TS)-7) as datetime)
when r.RTN_LINE_CRE_TS is null or r.RTN_LINE_CRE_TS = 'RTN_LINE_CRE_TS' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_TS as datetime)end)
left join 
DIM_DAY_HOUR_SQL_IN1563 d4
on convert(date,case 
when r.RTN_LINE_CRE_DT like '%M%' and r.RTN_LINE_CRE_DT != 'RTN_LINE_CRE_DT' then cast(substring(r.RTN_LINE_CRE_DT,1,len(r.RTN_LINE_CRE_DT)-7) as datetime)
when r.RTN_LINE_CRE_DT is null or r.RTN_LINE_CRE_DT = 'RTN_LINE_CRE_DT' or r.RTN_LINE_CRE_DT='null' or r.RTN_LINE_CRE_DT='?' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_DT as datetime)
end)=d4.DATE_ID
AND
d4.HOUR_ID = DATEPART(HOUR,case 
when r.RTN_LINE_CRE_DT like '%M%' and r.RTN_LINE_CRE_DT != 'RTN_LINE_CRE_DT' then cast(substring(r.RTN_LINE_CRE_DT,1,len(r.RTN_LINE_CRE_DT)-7) as datetime)
when r.RTN_LINE_CRE_DT is null or r.RTN_LINE_CRE_DT = 'RTN_LINE_CRE_DT' or r.RTN_LINE_CRE_DT='null' or r.RTN_LINE_CRE_DT='?' then cast('1/1/1900' as datetime)
else cast(r.RTN_LINE_CRE_DT as datetime)
end)) S
